<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>CK&#39;s Notepad</title>
  
  
  <link href="http://blog.kevinyang.net/atom.xml" rel="self"/>
  
  <link href="http://blog.kevinyang.net/"/>
  <updated>2021-03-17T15:14:17.855Z</updated>
  <id>http://blog.kevinyang.net/</id>
  
  <author>
    <name>KevinYang</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[Azure DevOps] Pipeline å»ºç½®æ™‚è·¨ Repo æƒ…å¢ƒä¸‹è©²å¦‚ä½•è™•ç†å‘¢?</title>
    <link href="http://blog.kevinyang.net/2021/03/17/azure-devops-build-pipeline-resource/"/>
    <id>http://blog.kevinyang.net/2021/03/17/azure-devops-build-pipeline-resource/</id>
    <published>2021-03-17T14:51:35.000Z</published>
    <updated>2021-03-17T15:14:17.855Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å·¥ä½œä¸Šé‡åˆ°ä¸€å€‹æƒ…æ³å°±æ˜¯ä¸€å€‹ç³»çµ±çš„å‰å¾Œç«¯æ˜¯åˆ†åœ¨å…©å€‹ Repository çš„ï¼Œä½†å‰ç«¯çš„æª”æ¡ˆéœ€è¦è¢«åŒ…é€²å¾Œç«¯çš„ç¨‹å¼ä¸­åšå¾ŒçºŒçš„ç™¼ä½ˆï¼Œå°±åœ¨æ€è€ƒè©²å¦‚ä½•è™•ç†é€™å€‹å•é¡Œï¼Œçµ‚æ–¼æƒ³å‡ºä¸€å€‹é‚„ä¸éŒ¯ç°¡å–®çš„æ–¹å¼</p><span id="more"></span><p>åœ¨ Pipeline å»ºç½®æ™‚ï¼Œå¯ä»¥å°‡æ‰“åŒ…å‡ºä¾†çš„çµæœ Publish æˆ Pipeline Artifactï¼Œyaml çš„å¯«æ³•å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">PublishBuildArtifacts@1</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">artifactName:</span> <span class="string">&#x27;ngApp&#x27;</span></span><br><span class="line">    <span class="attr">PathtoPublish:</span> <span class="string">&#x27;$(System.DefaultWorkingDirectory)/dist/front-website&#x27;</span></span><br></pre></td></tr></table></figure><ul><li><code>artifactName</code> : æ‰“åŒ…å‡ºä¾†çš„æª”æ¡ˆåç¨±</li><li><code>PathtoPublish</code>ï¼šè¦æ‰“åŒ…çš„æª”æ¡ˆè³‡æ–™å¤¾ä½ç½®</li></ul><p>åˆ°å¾Œç«¯çš„ Repository çš„ Pipeline çš„ Task ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ <code>Download Pipeline Artifact</code> çš„ Task ä¾†ä¸‹è¼‰æŸä¸€å€‹å°ˆæ¡ˆä¸‹çš„æŸä¸€å€‹ Pipeline ç™¼ä½ˆçš„ Artifactï¼Œé€™ä¸€å€‹ä»»å‹™å¯ä»¥å°‡ç·¨è­¯å»ºç½®å¾Œçš„çµæœè·¨å°ˆæ¡ˆçš„ä½¿ç”¨ï¼ŒçœŸçš„å¾ˆæ–¹ä¾¿</p><p><img src="image-20210317230842327.png" alt="image-20210317230842327"></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">steps:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">DownloadPipelineArtifact@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Download Pipeline Artifact&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">buildType:</span> <span class="string">specific</span></span><br><span class="line">    <span class="attr">project:</span> <span class="string">&#x27;&lt;project-id&gt;&#x27;</span></span><br><span class="line">    <span class="attr">definition:</span> <span class="number">13</span></span><br><span class="line">    <span class="attr">specificBuildWithTriggering:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">allowPartiallySucceededBuilds:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">artifactName:</span> <span class="string">ngAPP</span></span><br><span class="line">    <span class="attr">targetPath:</span> <span class="string">&#x27;$(System.DefaultWorkingDirectory)/backend/wwwroot&#x27;</span></span><br></pre></td></tr></table></figure><ul><li><code>targetPath</code> ä¸‹è¼‰ç›®æ¨™è·¯å¾‘</li></ul><p>ç”±æ–¼å¯èƒ½æœƒæœ‰å…ˆå¾Œé †åºçš„å•é¡Œï¼Œé€™æ™‚å€™ä¹Ÿå¯ä»¥æ­é… Triggers ä¸­çš„ <code>Build completion </code> ä¾†åšåˆ° Pipeline é–“çš„é€£å‹•</p><p><img src="image-20210317231019398.png" alt="image-20210317231019398"></p><p>é€”ä¸­çš„è¨­å®šåŸ·è¡Œçš„é †åºæ˜¯ï¼Œç•¶ <code>FrontCode</code> Pipeline å®Œæˆå¾Œæœƒè§¸ç™¼åŸ·è¡Œ <code>PipelineTest</code> çš„ Pipeline ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨å·¥ä½œä¸Šé‡åˆ°ä¸€å€‹æƒ…æ³å°±æ˜¯ä¸€å€‹ç³»çµ±çš„å‰å¾Œç«¯æ˜¯åˆ†åœ¨å…©å€‹ Repository çš„ï¼Œä½†å‰ç«¯çš„æª”æ¡ˆéœ€è¦è¢«åŒ…é€²å¾Œç«¯çš„ç¨‹å¼ä¸­åšå¾ŒçºŒçš„ç™¼ä½ˆï¼Œå°±åœ¨æ€è€ƒè©²å¦‚ä½•è™•ç†é€™å€‹å•é¡Œï¼Œçµ‚æ–¼æƒ³å‡ºä¸€å€‹é‚„ä¸éŒ¯ç°¡å–®çš„æ–¹å¼&lt;/p&gt;</summary>
    
    
    
    <category term="Azure DevOps" scheme="http://blog.kevinyang.net/categories/Azure-DevOps/"/>
    
    
    <category term="Azure DevOps" scheme="http://blog.kevinyang.net/tags/Azure-DevOps/"/>
    
  </entry>
  
  <entry>
    <title>[Rust] Rust å­¸ç¿’ç­†è¨˜ - åŸºæœ¬æ¦‚å¿µç¯‡</title>
    <link href="http://blog.kevinyang.net/2021/02/23/rust-note-2/"/>
    <id>http://blog.kevinyang.net/2021/02/23/rust-note-2/</id>
    <published>2021-02-23T02:20:10.000Z</published>
    <updated>2021-03-17T15:14:17.855Z</updated>
    
    <content type="html"><![CDATA[<p>ç¹¼ä¸Šç¯‡çŒœæ•¸å­—çš„ç·´ç¿’ç¯„ä¾‹ä¸­ï¼Œå¤§è‡´ä¸Šå¯ä»¥æ„Ÿå—åˆ° Rust é€™èªè¨€çš„å€‹æ€§ï¼Œä½†é‚„æ˜¯å¾—çŸ¥é“èªè¨€çš„å‹åˆ¥ã€èªæ³•åŠæµç¨‹æ§åˆ¶çš„æ–¹æ³•ï¼Œæ‰€ä»¥é€™é‚Šç­†è¨˜æœƒé‡å° <a href="https://doc.rust-lang.org/book/ch03-00-common-programming-concepts.html">Command Programming Concepts ç« ç¯€</a> çš„å…§å®¹æ“·å–æˆ‘è¦ºå¾—éœ€è¦è¨˜ä¸‹ä¾†çš„é‡é»</p><span id="more"></span><h1 id="Variables-and-Mutability"><a class="header-anchor" href="#Variables-and-Mutability"> </a>Variables and Mutability</h1><ul><li><p>è®Šæ•¸å®£å‘Šå¾Œï¼Œé è¨­çš†ç‚ºä¸å¯æ”¹è®Šçš„ç‹€æ…‹ (Immutable)ï¼Œå¦‚æœéœ€è¦ä¸€å€‹å¯ä»¥è¢«æ”¹è®Šçš„è®Šæ•¸ï¼Œå¿…é ˆåŠ ä¸Š <code>mut</code> çš„é—œéµå­—</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>; <span class="comment">// immutable</span></span><br><span class="line">a = <span class="number">2</span>; <span class="comment">// é€™è¡Œæœƒå‡ºéŒ¯</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> b = <span class="string">&quot;some text&quot;</span>;</span><br><span class="line">b = <span class="string">&quot;can be changed&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>è®Šæ•¸çš„å‹åˆ¥å¿…é ˆè¦ä¸€è‡´ï¼Œç›´åˆ°é‡æ–°è¢«å®£å‘Š <a href="https://doc.rust-lang.org/book/ch03-01-variables-and-mutability.html#shadowing">(Shadowing)</a></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> a = a.len(); </span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut</span> b = <span class="string">&quot;some text&quot;</span>;</span><br><span class="line">b = b.len(); <span class="comment">// å‹åˆ¥ä¸ä¸€è‡´ï¼Œæœƒç™¼ç”ŸéŒ¯èª¤</span></span><br></pre></td></tr></table></figure></li><li><p>variables èˆ‡ constants çš„å·®ç•°æœ‰ä»¥ä¸‹å¹¾é»</p><ul><li>constants ä¸èƒ½ä½¿ç”¨ <code>mut</code></li><li>constants ä½¿ç”¨ <code>const</code> å®£å‘Šè€Œä¸”å¿…é ˆæŒ‡å®šå‹åˆ¥ï¼Œç¯„ä¾‹: <code>const MAX_POINTS: u32 = 100_000;</code></li><li>constants åªèƒ½è¢«å®£å‘Šä¸€æ¬¡</li></ul></li></ul><h1 id="Data-Types"><a class="header-anchor" href="#Data-Types"> </a>Data Types</h1><h2 id="Scalar-Type"><a class="header-anchor" href="#Scalar-Type"> </a>Scalar Type</h2><p>Rust çš„æ¨™æº–å‹åˆ¥ (scalar type) æœ‰å››ç¨®: <code>integers</code>ã€<code>floating-point numbers</code>ã€ <code>Booleans</code>ã€<code>characters</code>ã€‚</p><h3 id="Integer"><a class="header-anchor" href="#Integer"> </a>Integer</h3><ul><li><p>åˆ†ç‚º signed (<code>i</code>) å’Œ unsigned (<code>u</code>)</p></li><li><p>æœ‰ 8-bitã€16-bitã€32-bitã€64-bitã€128-bitã€arch é•·åº¦</p></li><li><p>8 ~ 128 bit çš„ç¯„åœç®—æ³•èªªæ˜å¦‚ä¸‹</p><blockquote><p>Each signed variant can store numbers from -(2n - 1) to 2n - 1 - 1 inclusive, where <em>n</em> is the number of bits that variant uses. So an <code>i8</code> can store numbers from -(27) to 27 - 1, which equals -128 to 127. Unsigned variants can store numbers from 0 to 2n - 1, so a <code>u8</code> can store numbers from 0 to 28 - 1, which equals 0 to 255.</p><p>Additionally, the <code>isize</code> and <code>usize</code> types depend on the kind of computer your program is running on: 64 bits if youâ€™re on a 64-bit architecture and 32 bits if youâ€™re on a 32-bit architecture.</p></blockquote></li><li><p>å¯ä»¥ä½¿ <code>_</code> ä¾†å¢åŠ æ•¸å­—çš„é–±è®€æ€§ï¼Œä¾‹å¦‚: <code>100_000</code> ç­‰åŒæ–¼ <code>100000</code></p></li></ul><h3 id="floating-point"><a class="header-anchor" href="#floating-point"> </a>floating-point</h3><ul><li><code>f32</code> å’Œ <code>f64</code> å…©ç¨® floating-point type</li><li>æ ¹æ“š <code>IEEE-754</code>  æ¨™æº– (<a href="https://zh.wikipedia.org/wiki/IEEE_754">wiki</a>)</li></ul><h3 id="Boolean"><a class="header-anchor" href="#Boolean"> </a>Boolean</h3><ul><li><p>å¦‚ä¸€èˆ¬ä½¿ç”¨ <code>true</code> å’Œ <code>false</code> å…©ç¨®çµæœï¼Œå¤§å°ç‚º <code>1 byte</code></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> t = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> f: <span class="built_in">bool</span> = <span class="literal">false</span>; <span class="comment">// with explicit type annotation</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="Character"><a class="header-anchor" href="#Character"> </a>Character</h3><ul><li><p>åŸºæœ¬æ–‡å­—å‹ä½¿ç”¨é›™å¼•è™ŸåŒ…èµ·ä¾†ï¼Œè€Œ <code>character</code> ä½¿ç”¨å–®å¼•è™Ÿï¼Œè·Ÿ C# ä¸€æ¨£</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> c = <span class="string">&#x27;z&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> z = <span class="string">&#x27;â„¤&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> heart_eyed_cat = &#x27;ğŸ˜»&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="Compound-Types"><a class="header-anchor" href="#Compound-Types"> </a>Compound Types</h2><h3 id="Tuple"><a class="header-anchor" href="#Tuple"> </a>Tuple</h3><ul><li><p>å®£å‘Šæ–¹å¼</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> tup1 = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">let</span> tup2: (<span class="built_in">i32</span>, <span class="built_in">f64</span>, <span class="built_in">u8</span>) = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>è§£æ§‹ tuple</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> tup = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> (x, y, z) = tup;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of y is: &#123;&#125;&quot;</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç›´æ¥ä½¿ç”¨ index è®€å– tuple</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x: (<span class="built_in">i32</span>, <span class="built_in">f64</span>, <span class="built_in">u8</span>) = (<span class="number">500</span>, <span class="number">6.4</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> five_hundred = x.<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> six_point_four = x.<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> one = x.<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><h3 id="Array"><a class="header-anchor" href="#Array"> </a>Array</h3><ul><li><p>å®£å‘Šæ–¹å¼</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> b = [<span class="number">1</span>; <span class="number">5</span>]; <span class="comment">// [1,1,1,1,1]</span></span><br></pre></td></tr></table></figure></li><li><p>with å‹åˆ¥åŠé•·åº¦å®£å‘Š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a: [<span class="built_in">i32</span>; <span class="number">5</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br></pre></td></tr></table></figure></li><li><p>å¾ 0 é–‹å§‹ï¼Œè¶…éé™£åˆ—é•·åº¦æœƒé€ æˆéŒ¯èª¤</p></li></ul><h1 id="Functions"><a class="header-anchor" href="#Functions"> </a>Functions</h1><ul><li><p>å®£å‘Šæ–¹å¼: <code>fn</code></p></li><li><p>å‘½åæ–¹å¼: <code>snake case</code>ï¼Œç¯„ä¾‹: <code>fn another_function()&#123; &#125;</code></p></li><li><p>Function parameters çš„è¨­å®šæ–¹å¼</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    another_function(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">another_function</span></span>(x: <span class="built_in">i32</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of x is: &#123;&#125;&quot;</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Expression in Function</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> x = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> y = &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="number">3</span>;</span><br><span class="line">        x + <span class="number">1</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of y is: &#123;&#125;&quot;</span>, y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ <code>&#123; &#125;</code> ä¾†å»ºç«‹ä¸€å€‹æ–°çš„ scope</li><li>line 6: æ²’æœ‰åˆ†è™Ÿçµå°¾ï¼Œè¦–ç‚º <code>expression</code> æœƒè¢« return</li></ul></li><li><p>Function éœ€å›å‚³ <code>values</code> æˆ–æ˜¯ <code>expressions</code>ï¼Œæ²’æœ‰ <code>void</code> çš„æ¦‚å¿µ</p></li></ul><h1 id="Comments"><a class="header-anchor" href="#Comments"> </a>Comments</h1><ul><li><p>è¨»è§£ç¬¦è™Ÿç‚º : <code>//</code></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="comment">// Iâ€™m feeling lucky today</span></span><br><span class="line">    <span class="keyword">let</span> lucky_number = <span class="number">7</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="Control-Flow"><a class="header-anchor" href="#Control-Flow"> </a>Control Flow</h1><p>æµç¨‹æ§åˆ¶æœ‰ <code>if</code> å’Œ <code>loops</code> å…©ç¨®æ–¹æ³•</p><h2 id="if"><a class="header-anchor" href="#if"> </a>if</h2><ul><li><p>èªæ³•ï¼Œ<code>if</code> å¾Œé¢çš„æ¢ä»¶ä¸éœ€è¦ä½¿ç”¨ <code>( )</code> åŒ…èµ·ä¾†</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> number &lt; <span class="number">5</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;condition was true&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;condition was false&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ‰ <code>else if</code> é€™ç¨®æ±è¥¿</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> number % <span class="number">4</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 4&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> number % <span class="number">3</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 3&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> number % <span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is divisible by 2&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;number is not divisible by 4, 3, or 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¯ä»¥æ­é… <code>let</code> ä½¿ç”¨ï¼Œä½†å›å‚³çš„å‹åˆ¥å¿…é ˆä¸€è‡´</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> condition = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> number = <span class="keyword">if</span> condition &#123; <span class="number">5</span> &#125; <span class="keyword">else</span> &#123; <span class="number">6</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The value of number is: &#123;&#125;&quot;</span>, number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="loops"><a class="header-anchor" href="#loops"> </a>loops</h2><p>æœ‰ä¸‰ç¨® loops çš„æ–¹å¼: <code>loop</code>ã€<code>while</code>ã€<code>for</code></p><ul><li><p>loop</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">loop</span> &#123;</span><br><span class="line">        counter += <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> counter == <span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">break</span> counter * <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;The result is &#123;&#125;&quot;</span>, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>while</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> number = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> number != <span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;!&quot;</span>, number);</span><br><span class="line"></span><br><span class="line">        number -= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;LIFTOFF!!!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>for</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> a = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> a.iter() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;the value is: &#123;&#125;&quot;</span>, element);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="å°çµ"><a class="header-anchor" href="#å°çµ"> </a>å°çµ</h1><p>Rust æ²’æœ‰åƒ C# æ“æœ‰å¾ˆå¤šä¸åŒå‹åˆ¥æˆ–æ˜¯ç¨‹å¼èªæ³•ï¼Œä½†é€™äº›éƒ½ç®—æ˜¯åŸºæœ¬éœ€è¦æŒæ¡çš„ï¼Œå¦‚æœæœ‰åœ°æ–¹ç†è§£éŒ¯èª¤ä¹Ÿè«‹è®“æˆ‘çŸ¥é“ï¼Œæ„Ÿè¬</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¹¼ä¸Šç¯‡çŒœæ•¸å­—çš„ç·´ç¿’ç¯„ä¾‹ä¸­ï¼Œå¤§è‡´ä¸Šå¯ä»¥æ„Ÿå—åˆ° Rust é€™èªè¨€çš„å€‹æ€§ï¼Œä½†é‚„æ˜¯å¾—çŸ¥é“èªè¨€çš„å‹åˆ¥ã€èªæ³•åŠæµç¨‹æ§åˆ¶çš„æ–¹æ³•ï¼Œæ‰€ä»¥é€™é‚Šç­†è¨˜æœƒé‡å° &lt;a href=&quot;https://doc.rust-lang.org/book/ch03-00-common-programming-concepts.html&quot;&gt;Command Programming Concepts ç« ç¯€&lt;/a&gt; çš„å…§å®¹æ“·å–æˆ‘è¦ºå¾—éœ€è¦è¨˜ä¸‹ä¾†çš„é‡é»&lt;/p&gt;</summary>
    
    
    
    <category term="Rust" scheme="http://blog.kevinyang.net/categories/Rust/"/>
    
    
    <category term="Rust" scheme="http://blog.kevinyang.net/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>[Rust] Rust å­¸ç¿’ç­†è¨˜ - è·Ÿè‘—æ–‡ä»¶å¯«çŒœæ•¸å­—</title>
    <link href="http://blog.kevinyang.net/2021/02/19/rust-note-1/"/>
    <id>http://blog.kevinyang.net/2021/02/19/rust-note-1/</id>
    <published>2021-02-19T03:51:01.000Z</published>
    <updated>2021-03-17T15:14:17.851Z</updated>
    
    <content type="html"><![CDATA[<p>Rust é€™èªè¨€é—œæ³¨ä»–æœ‰ä¸€æ®µæ™‚é–“ï¼Œä½†éƒ½æ²’æœ‰çœŸæ­£çš„å‹•æ‰‹å¯«çœ‹çœ‹ï¼Œè¶å¹´å¾Œé‚„æ²’é‚£éº¼å¤šäº‹æƒ…æ™‚ï¼Œä¾†å­¸ç¿’ä¸€ä¸‹ï¼Œæˆ–è¨±æ—¥å¾Œå¯ä»¥ç”¨ä»–ä¾†å¯« web assembly</p><span id="more"></span><h1 id="ç’°å¢ƒå®‰è£"><a class="header-anchor" href="#ç’°å¢ƒå®‰è£"> </a>ç’°å¢ƒå®‰è£</h1><p>Rust çš„åŸ·è¡Œç’°å¢ƒåŸºæœ¬ä¸Šå°±ä¾<a href="https://www.rust-lang.org/zh-TW/learn/get-started">å®˜ç¶²</a>çš„å®‰è£æ­¥é©Ÿåšå°±å¯ä»¥äº†ï¼Œå¦‚æœæ˜¯ Windows çš„ç’°å¢ƒï¼Œç•¶åœ¨åŸ·è¡Œ <code>cargo build</code> æ™‚ï¼Œæœ‰å¯èƒ½æœƒå‡ºç¾ <code>link.exe</code> æ‰¾ä¸åˆ°çš„éŒ¯èª¤è¨Šæ¯ï¼Œé€šå¸¸é€™å€‹å•é¡Œè·Ÿé›»è…¦ç’°å¢ƒæ²’è£ <a href="https://visualstudio.microsoft.com/zh-hant/visual-cpp-build-tools/">C++ Build Tools</a> æœ‰é—œ</p><p>é–‹ç™¼å·¥å…·çš„éƒ¨åˆ†ï¼Œé¸æ“‡æ€§é‚„è »å¤šçš„ï¼Œä»¥æˆ‘ç›®å‰çš„ç’°å¢ƒï¼Œæ˜¯ç›´æ¥é¸æ“‡ VSCode + Rust æ“´å……å¥—ä»¶é€²è¡Œå­¸ç¿’ç’°å¢ƒ</p><h1 id="å»ºç«‹æ–°å°ˆæ¡ˆ"><a class="header-anchor" href="#å»ºç«‹æ–°å°ˆæ¡ˆ"> </a>å»ºç«‹æ–°å°ˆæ¡ˆ</h1><p>å®‰è£å®Œ Rust å¾Œï¼Œæœƒæœ‰ <code>cargo</code> çš„å‘½ä»¤å¯ä»¥ä½¿ç”¨ï¼Œè·Ÿ Angular CLI çš„ <code>ng</code> é¡ä¼¼ï¼Œå¯ä»¥ç”¨ä»–ä¾†æ‰“åŒ…ã€é–‹ç™¼ã€ç­‰å·¥ä½œ</p><p><img src="image-20210219120226176.png" alt="image-20210219120226176"></p><p>å»ºç«‹å°ˆæ¡ˆçš„æŒ‡ä»¤æ˜¯ <code>cargo new &lt;project_name&gt;</code>ï¼Œå»ºç«‹å®Œæˆå¾Œå°ˆæ¡ˆè³‡æ–™å¤¾ä¸‹æœƒæœ‰é€™äº›æª”æ¡ˆ</p><p><img src="image-20210219120327131.png" alt="image-20210219120327131"></p><ul><li><code>Cargo.toml</code> : ç”¨ä¾†è¨˜è¼‰å°ˆæ¡ˆè³‡è¨Šï¼Œç›¸ä¾å¥—ä»¶ç­‰è³‡è¨Šï¼Œé¡ä¼¼ <code>package.json</code></li><li><code>Cargo.lock</code>: ç”¨ä¾†ç´€éŒ„å¥—ä»¶å®‰è£ç­‰è³‡è¨Šï¼Œé¡ä¼¼ <code>package-lock.json</code></li><li><code>target</code> è³‡æ–™å¤¾ï¼šå»ºç½®å¾Œ(<code>cargo build</code>) çš„è¼¸å‡ºè³‡æ–™å¤¾</li><li><code>src</code> è³‡æ–™å¤¾ï¼šç¨‹å¼æ”¾ç½®ä½ç½®</li><li><code>src/main.rs</code> : ä¸»è¦é€²å…¥é»</li></ul><p>æƒ³åŸ·è¡Œç¨‹å¼æ™‚ï¼Œä½¿ç”¨ <code>cargo run</code> çš„æŒ‡ä»¤å°±å¯ä»¥äº†</p><h1 id="çŒœæ•¸å­—-å®˜æ–¹ç¯„ä¾‹"><a class="header-anchor" href="#çŒœæ•¸å­—-å®˜æ–¹ç¯„ä¾‹"> </a>çŒœæ•¸å­—(å®˜æ–¹ç¯„ä¾‹)</h1><ul><li><a href="https://doc.rust-lang.org/book/ch02-00-guessing-game-tutorial.html">æ–‡ä»¶ä½ç½®</a></li></ul><p>ç•¶æ‰“é–‹ <code>main.rs</code> æª”æ¡ˆï¼Œè£¡é¢åªæœ‰ä¸€å€‹ function ï¼Œé€™å€‹æ˜¯ç¨‹å¼çš„åˆå§‹åŸ·è¡Œçš„æ–¹æ³•</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦å¾ console ä¸Šæ¥æ”¶åˆ°ä½¿ç”¨è€…è¼¸å…¥å¾—è³‡æ–™æ™‚ï¼Œå°±è¦ä½¿ç”¨åˆ°å…§å»ºçš„ <code>io</code> æ–¹æ³•</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io; <span class="comment">// å¼•ç”¨ package, library, namespace (å°±é‚£å€‹æ„æ€)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Guess the number!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> guess = <span class="built_in">String</span>::new();</span><br><span class="line"></span><br><span class="line">    io::stdin()</span><br><span class="line">        .read_line(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">        .expect(<span class="string">&quot;Failed to read line&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>line 8: å»ºç«‹ä¸€å€‹å¯ä»¥è¢«è®Šæ›´çš„æ–‡å­—å‹æ…‹çš„è®Šæ•¸ï¼Œ</p><ul><li>ä½¿ç”¨ <code>mut</code> é—œéµå­—è¨­å®šè®Šæ•¸ç‚ºå¯è®Šæ›´çš„</li></ul></li><li><p>line 10 ~ 11: æ¥æ”¶ä½¿ç”¨è€…è¼¸å…¥å¾—è³‡æ–™ï¼Œä¸¦å­˜æ”¾åˆ° <code>guess</code> è®Šæ•¸ä¸­</p><ul><li>ä½¿ç”¨ <code>&amp;</code> å»ºç«‹ä¸€å€‹ reference</li></ul></li><li><p>line 12: éœ€è™•ç†ç•¶ <code>read_line</code> å¤±æ•—æ™‚éœ€è¦å›å‚³ä»€éº¼çµæœï¼Œé€™æ˜¯ Rust è™•ç† Exception çš„æ–¹å¼ï¼Œå¯ä»¥æ€è€ƒæˆé€™æ¨£</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> guess;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">   guess = Console.Readline();   </span><br><span class="line">&#125; catch &#123;</span><br><span class="line">   guess = <span class="string">&quot;Failed to read line&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>å¿…é ˆè™•ç† Error çš„éƒ¨åˆ†ï¼Œä¸ç„¶ compiler æœƒè·Ÿä½ æŠ±æ€¨</p><p><img src="image-20210219135909589.png" alt="image-20210219135909589"></p></li></ul></li><li><p>line 14: ä½¿ç”¨ <code>&#123;&#125;</code> ä¾†ç©ºå‡ºè®Šæ•¸è¦é¡¯ç¤ºçš„ä½ç½®ï¼Œç•¶æœ‰å¤šå€‹æ™‚ï¼Œæœƒä¾åºé¡¯ç¤º</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;x: &#123;&#125;, y: &#123;&#125;&quot;</span>, x, y);</span><br></pre></td></tr></table></figure></li></ul><h2 id="å¼•ç”¨å¥—ä»¶"><a class="header-anchor" href="#å¼•ç”¨å¥—ä»¶"> </a>å¼•ç”¨å¥—ä»¶</h2><p>ä½¿ç”¨å…¶ä»–ç›¸ä¾å¥—ä»¶çš„æ–¹å¼å¾ˆç°¡å–®ï¼Œå°±åœ¨ <code>Cargo.toml</code> ä¸­å°‡å¥—ä»¶åç¨±èˆ‡ç‰ˆæœ¬è¨­å®šä¸Šå»å³å¯ï¼Œé¡ä¼¼ npm çš„æ¦‚å¿µï¼Œrust ä¹Ÿæœ‰è‡ªå·±çš„ package ç®¡ç†æ©Ÿåˆ¶ï¼Œå¯ä»¥ä¸Š <a href="https://crates.io/">crates.io</a> æœå°‹å¥—ä»¶ï¼Œ&lt;åœ¨é€™ç·´ç¿’ç¯„ä¾‹ä¸­ï¼Œä½¿ç”¨äº† <code>rand</code> é€™ä¸€å€‹ package</p><p><img src="image-20210219140316275.png" alt="image-20210219140316275"></p><p>æœå°‹å¾Œå†å³é‚Šæœ‰ install çš„æ–¹å¼ï¼Œåªè¦è¤‡è£½è²¼åˆ° <code>Cargo.toml</code> çš„ <code>dependencies</code> ä¸‹å³å¯</p><h2 id="ä½¿ç”¨å¥—ä»¶"><a class="header-anchor" href="#ä½¿ç”¨å¥—ä»¶"> </a>ä½¿ç”¨å¥—ä»¶</h2><p>åœ¨ <code>main.rs</code>  è£¡è¦å»ºç«‹ä¸€å€‹ä»‹æ–¼ 1~ 100 çš„äº‚æ•¸ï¼Œå¯«æ³•å¦‚ä¸‹</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> rand::Rng;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">let</span> secret_number = rand::thread_rng().gen_range(<span class="number">1</span>..<span class="number">100</span>);</span><br><span class="line">    ...</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><ul><li><a href="https://docs.rs/rand/0.8.3/rand/trait.Rng.html">gen_range API</a></li></ul><p>â€»å‚™è¨»ä¸€ï¼ŒRust  ä¸å–œæ­¡æ²’æœ‰ä½¿ç”¨çš„æ±è¥¿ç•™åœ¨ç¨‹å¼ç¢¼å…§ï¼Œå¦‚æœæœ‰é‚£ç¨®æ²’ä½¿ç”¨çš„è®Šæ•¸ç™¼ç”Ÿæ™‚ï¼Œç·¨è­¯æ™‚æœƒå‡ºç¾ä¸‹é¢çš„è­¦ç¤ºè¨Šæ¯</p><p><img src="image-20210219141201642.png" alt="image-20210219141201642"></p><h2 id="æ¯”è¼ƒæ•¸å­—"><a class="header-anchor" href="#æ¯”è¼ƒæ•¸å­—"> </a>æ¯”è¼ƒæ•¸å­—</h2><p>Rust æœ‰å…§å»ºæ¯”è¼ƒæ•¸å­—çš„æ–¹æ³• <code>std::cmp::Ordering;</code></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp::Ordering;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fn</span> <span class="title">main</span></span>() &#123;</span><br><span class="line">   ...</span><br><span class="line">    <span class="keyword">let</span> secret_number = rand::thread_rng().gen_range(<span class="number">1</span>..<span class="number">100</span>);</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut</span> guess = <span class="built_in">String</span>::new();</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">match</span> guess.cmp(&amp;secret_number) &#123;</span><br><span class="line">        Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">        Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">        Ordering::Equal =&gt; <span class="built_in">println!</span>(<span class="string">&quot;You win!&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>match</code> : Pattern Matching çš„é—œéµå­— (å¾ˆå¸¸å‡ºç¾çš„ä¸€ç¨®å¯«æ³•)</p></li><li><p><code>secret_number</code> ç‚ºæ•¸å­—å‹ï¼Œ<code>guess</code> ç‚ºæ–‡å­—å‹ï¼Œline 10 çš„æ¯”è¼ƒæœƒè·³å‡ºéŒ¯èª¤è¨Šæ¯</p><p><img src="image-20210219141553593.png" alt="image-20210219141553593"></p></li></ul><p>åŸºæ–¼ä¸Šé¢çš„åŸå› ï¼Œæˆ‘å€‘éœ€è¦å°‡ guess è½‰æ›æˆæ•¸å­—å‹</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guess: <span class="built_in">u32</span> = guess.trim().parse().expect(<span class="string">&quot;Please type a number!&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li><p><code>trim()</code> æœƒå°‡ <code>\n</code> æˆ–æ˜¯ç©ºç™½çµ¦æ¸…é™¤æ‰</p></li><li><p><code>parse()</code> å°‡æ–‡å­—è½‰æ›æˆæ•¸å­—ï¼Œç”±æ–¼å®£å‘Šè®Šæ•¸æ™‚ï¼Œæœ‰æŒ‡å®šå‹åˆ¥, <code>: u32</code> ï¼Œæ‰€ä»¥æœƒè½‰æ›æˆ <code>u32</code> å‹åˆ¥</p></li><li><p><code>expect(....)</code>ï¼Œç•¶ç™¼ç”Ÿ exception æ™‚ï¼Œæœƒé¡¯ç¤ºè£¡é¢çš„æ–‡å­—</p><p><img src="image-20210219142058900.png" alt="image-20210219142058900"></p></li></ul><h2 id="æŒçºŒé€²è¡ŒéŠæˆ²ç›´åˆ°çŒœå°"><a class="header-anchor" href="#æŒçºŒé€²è¡ŒéŠæˆ²ç›´åˆ°çŒœå°"> </a>æŒçºŒé€²è¡ŒéŠæˆ²ç›´åˆ°çŒœå°</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">       <span class="built_in">println!</span>(<span class="string">&quot;Please input your guess.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">let</span> <span class="keyword">mut</span> guess = <span class="built_in">String</span>::new();</span><br><span class="line"></span><br><span class="line">       io::stdin()</span><br><span class="line">           .read_line(&amp;<span class="keyword">mut</span> guess)</span><br><span class="line">           .expect(<span class="string">&quot;Failed to read line&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="built_in">println!</span>(<span class="string">&quot;You guessed: &#123;&#125;&quot;</span>, guess);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">let</span> guess: <span class="built_in">u32</span> = guess.trim().parse().expect(<span class="string">&quot;Please type a number!&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">match</span> guess.cmp(&amp;secret_number) &#123;</span><br><span class="line">           Ordering::Less =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too small!&quot;</span>),</span><br><span class="line">           Ordering::Greater =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Too big!&quot;</span>),</span><br><span class="line">           Ordering::Equal =&gt; &#123;</span><br><span class="line">               <span class="built_in">println!</span>(<span class="string">&quot;You win!&quot;</span>);</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><ul><li>line 1ï¼šæ–°å¢ loop è¿´åœˆ</li><li>line 17: çŒœå°æ™‚è·³å‡ºè¿´åœˆ</li></ul><p>ä¸Šé¢çš„å¯«æ³•é‡å° <code>line 12</code> è¼¸å…¥ä¸æ˜¯å¯è½‰æ›æˆæ•¸å­—çš„æƒ…æ³ä¸‹ï¼Œé‚„æ˜¯æœƒè¢«è¿«çµæŸç¨‹å¼ï¼Œæ‰€ä»¥è¦ä¿®æ­£ä¸€ä¸‹å¯«æ³•</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> guess: <span class="built_in">u32</span> = <span class="keyword">match</span> guess.trim().parse() &#123;</span><br><span class="line">            <span class="literal">Ok</span>(num) =&gt; num,</span><br><span class="line">            <span class="literal">Err</span>(_) =&gt; <span class="keyword">continue</span>,</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><p>å†æ¬¡é€é pattern match çš„æ–¹å¼ï¼Œèª¿æ•´é‡åˆ° <code>Err</code> æ™‚è¦åšçš„è¡Œç‚ºï¼Œé€™æ¨£å°±ä¸æœƒå› ç‚ºè½‰æ›å¤±æ•—é€ æˆç¨‹å¼è¢«å¼·åˆ¶ä¸­æ–·äº†ã€‚</p><h1 id="å°çµ"><a class="header-anchor" href="#å°çµ"> </a>å°çµ</h1><p>åˆ°é€™é‚Šæ˜¯å®˜ç¶²æä¾›çš„ä¸€å€‹ç®—æ˜¯å®Œæ•´çš„ç°¡å–®ç¯„ä¾‹ï¼Œä¹Ÿå¯ä»¥å¾ä¸­è§€å¯Ÿåˆ° Rust é€™èªè¨€çš„ç‰¹æ€§ï¼Œè‡ªå·±åœ¨ç¬¬ä¸€æ¬¡å¯«æ™‚ä¸¦æ²’æœ‰é‡åˆ°å¤ªå¡çš„åœ°æ–¹ï¼Œå¾ˆå¤šè§€å¿µéƒ½å¯ä»¥å¾å…¶ä»–èªè¨€å»¶ç”¨ï¼Œå¯ä»¥ç®—æ˜¯ä¸€å€‹åš´è¬¹ä½†åˆä¸æœƒè®“ä½ å¯«å¾—å¾ˆå›‰å”†ã€‚ç¬¬ä¸€å°è±¡æ˜¯å¥½çš„</p><p>æ¥ä¸‹ä¾†å°±æœƒå¾€æ›´æ·±å±¤å»ç­è§£é€™èªè¨€çš„å…¶ä»–éƒ¨åˆ†ï¼Œä¾‹å¦‚å‹åˆ¥ã€æµç¨‹æ§åˆ¶ã€è·Ÿç¨‹å¼çµæ§‹ç­‰ï¼Œä¸‹ç¯‡è¦‹ã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Rust é€™èªè¨€é—œæ³¨ä»–æœ‰ä¸€æ®µæ™‚é–“ï¼Œä½†éƒ½æ²’æœ‰çœŸæ­£çš„å‹•æ‰‹å¯«çœ‹çœ‹ï¼Œè¶å¹´å¾Œé‚„æ²’é‚£éº¼å¤šäº‹æƒ…æ™‚ï¼Œä¾†å­¸ç¿’ä¸€ä¸‹ï¼Œæˆ–è¨±æ—¥å¾Œå¯ä»¥ç”¨ä»–ä¾†å¯« web assembly&lt;/p&gt;</summary>
    
    
    
    <category term="Rust" scheme="http://blog.kevinyang.net/categories/Rust/"/>
    
    
    <category term="Rust" scheme="http://blog.kevinyang.net/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] Angular åœ¨ VSCode Extension (Webview) å…§åšé é¢åˆ‡æ›</title>
    <link href="http://blog.kevinyang.net/2021/02/05/angular-vscode-extension-page-navigate/"/>
    <id>http://blog.kevinyang.net/2021/02/05/angular-vscode-extension-page-navigate/</id>
    <published>2021-02-05T16:22:09.000Z</published>
    <updated>2021-03-17T15:14:17.851Z</updated>
    
    <content type="html"><![CDATA[<p>ç¹¼ä¸Šä¸€ç¯‡ç’°å¢ƒåŸºç¤è¨­å®šå®Œæˆå¾Œï¼Œé€™ç¯‡å…ˆä¾†ç­†è¨˜ä¸€ä¸‹è¦å¦‚ä½•åšé é¢åˆ‡æ›ï¼Œæœ‰å“ªäº›åœ°æ–¹éœ€è¦ç•™æ„çš„</p><span id="more"></span><p>é¦–å…ˆè¦çŸ¥é“åœ¨ VSCode Extension Webview çš„ç’°å¢ƒä¸¦ä¸æ˜¯ä¸€å€‹ web server è€Œæ˜¯æª”æ¡ˆï¼Œæ‰€ä»¥æˆ‘å€‘å°±ä¸èƒ½ä½¿ç”¨é è¨­çš„è·¯ç”±è¨­å®šæ¨¡å¼ï¼Œè€Œå¿…é ˆæ”¹ç‚º hash æ¨¡å¼ (<code>HashLocationStrategy</code>)ï¼Œè¨­å®šæ–¹å¼å¦‚ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> RouterModule.forRoot(routes, &#123;</span><br><span class="line">      useHash: <span class="literal">true</span>,</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><p>åœ¨åˆ° <code>index.html</code> çš„åœ°æ–¹ï¼Œèª¿æ•´ base è·¯å¾‘çš„éƒ¨åˆ†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ°é€™é‚ŠåŸºæœ¬ä¸Š Angular çš„è·¯ç”±å°±å¯ä»¥æ­£å¸¸é‹ä½œäº†</p><p>æˆ–è¨±æœƒå•èªªï¼Œé‚£ LazyLoading çš„éƒ¨åˆ†å‘¢? å¾ˆæŠ±æ­‰ï¼Œåœ¨ VSCode Extension Webview å…§æ˜¯ä¸èƒ½ä½¿ç”¨çš„ï¼Œæ‰€ä»¥ <code>loadChildren</code> çš„å¯«æ³•è¦æ”¹æˆé€™æ¨£</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">path</span>: <span class="string">&#x27;product&#x27;</span>, <span class="attr">loadChildren</span>: <span class="function">() =&gt;</span> ProductModule &#125;,</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¹¼ä¸Šä¸€ç¯‡ç’°å¢ƒåŸºç¤è¨­å®šå®Œæˆå¾Œï¼Œé€™ç¯‡å…ˆä¾†ç­†è¨˜ä¸€ä¸‹è¦å¦‚ä½•åšé é¢åˆ‡æ›ï¼Œæœ‰å“ªäº›åœ°æ–¹éœ€è¦ç•™æ„çš„&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] æŠŠ Angular ç¶²ç«™æ”¾åˆ° VSCode Extension å…§</title>
    <link href="http://blog.kevinyang.net/2021/02/05/ng-vscode-extension-webview/"/>
    <id>http://blog.kevinyang.net/2021/02/05/ng-vscode-extension-webview/</id>
    <published>2021-02-05T13:33:51.000Z</published>
    <updated>2021-03-17T15:14:17.851Z</updated>
    
    <content type="html"><![CDATA[<p>å‰å¹¾å¤©æˆ‘åˆ†äº«äº†ä¸€å€‹ YouTube  çš„å½±ç‰‡ï¼Œè©²å½±ç‰‡å¤§è‡´ä¸Šçš„å…§å®¹æ˜¯å¦‚ä½•ä½¿ç”¨ VSCode Extension ä½¿ç”¨ Webview APIï¼Œæ—¢ç„¶å¯ä»¥ç”¨ webview çš„æ–¹å¼ä¾†å‘ˆç¾ç¶²é ï¼Œé‚£é¡¯ç¤ºä¸€å€‹ Angular App ä¹Ÿæ˜¯å¾ˆæ­£å¸¸çš„äº‹æƒ…ï¼Œä½†ç’°å¢ƒè¨­å®šä¸Šè¦æ€éº¼èª¿æ•´å‘¢? é€™ç¯‡ç­†è¨˜å°±ä¾†æ•´ç†ä¸€ä¸‹</p><span id="more"></span><h1 id="ç’°å¢ƒè¨­å®š"><a class="header-anchor" href="#ç’°å¢ƒè¨­å®š"> </a>ç’°å¢ƒè¨­å®š</h1><ol><li><p>é¦–å…ˆå…ˆå»ºç«‹ä¸€å€‹ Angular çš„å°ˆæ¡ˆ (é€™æ‡‰è©²ä¸ç”¨è¬›è¦ç”¨ä»€éº¼æŒ‡ä»¤äº†å§)</p></li><li><p>æ‰“é–‹ <code>package.json</code>ï¼Œæ–°å¢ä»¥ä¸‹å…§å®¹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&quot;publisher&quot;: &quot;publisher-name&quot;,</span><br><span class="line">&quot;engines&quot;: &#123;</span><br><span class="line">    &quot;vscode&quot;: &quot;^1.53.0&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&quot;categories&quot;: [</span><br><span class="line">    <span class="string">&quot;Other&quot;</span></span><br><span class="line">],</span><br><span class="line">&quot;activationEvents&quot;: [</span><br><span class="line">    <span class="string">&quot;onCommand:angular-webview.start&quot;</span></span><br><span class="line">],</span><br><span class="line">&quot;main&quot;: &quot;./dist/ext-src/extension.js&quot;,</span><br><span class="line">&quot;contributes&quot;: &#123;</span><br><span class="line">    &quot;commands&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;command&quot;</span>: <span class="string">&quot;angular-webview.start&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;Open Webview&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;category&quot;</span>: <span class="string">&quot;CK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br><span class="line">&quot;repository&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;git&quot;,</span><br><span class="line">    &quot;url&quot;: &quot;#&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>categories</code> ã€<code>activationEvents</code>ã€<code>contributes</code> çš„å€å¡Šå…§å®¹è«‹é…åˆ VS Code Extension é–‹ç™¼è¦ç¯„åšèª¿æ•´</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">    ...</span><br><span class="line">   &quot;@types/vscode&quot;: &quot;^1.53.0&quot;,</span><br><span class="line">   &quot;vscode-test&quot;: &quot;^1.5.0&quot;,</span><br><span class="line">   &quot;vsce&quot;: &quot;^1.83.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹å®Œå¾Œè¨˜å¾—è¦åŸ·è¡Œ <code>npm install</code></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">...</span><br><span class="line">   <span class="comment">// ä¿®æ”¹</span></span><br><span class="line">   &quot;build&quot;: &quot;ng build --prod --output-hashing none &amp;&amp; tsc -p tsconfig.extension.json&quot;,</span><br><span class="line">   <span class="comment">// æ–°å¢æŒ‡ä»¤</span></span><br><span class="line">   &quot;package&quot;: &quot;vsce package&quot;,</span><br><span class="line">   &quot;vscode:prepublish&quot;: &quot;npm run build &amp;&amp; tsc -p tsconfig.extension.json&quot;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢ <code>.vscodeignore</code> æª”æ¡ˆ (å¯æ ¹æ“šç‹€æ³èª¿æ•´)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">!dist</span><br><span class="line">.vscode</span><br><span class="line">e2e</span><br><span class="line">ext-src</span><br><span class="line">node_modules</span><br><span class="line">src</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢ <code>.vscode</code> è³‡æ–™å¤¾ä¸¦æ–°å¢ <code>launch.json</code> æª”æ¡ˆ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line"><span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Run Extension&quot;</span>,</span><br><span class="line"><span class="attr">&quot;type&quot;</span>: <span class="string">&quot;extensionHost&quot;</span>,</span><br><span class="line"><span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line"><span class="attr">&quot;args&quot;</span>: [</span><br><span class="line"><span class="string">&quot;--extensionDevelopmentPath=$&#123;workspaceFolder&#125;&quot;</span></span><br><span class="line">],</span><br><span class="line"><span class="attr">&quot;outFiles&quot;</span>: [</span><br><span class="line"><span class="string">&quot;$&#123;workspaceFolder&#125;/out/**/*.js&quot;</span></span><br><span class="line">],</span><br><span class="line">&#125;,</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢ <code>ext-src</code> è³‡æ–™å¤¾ï¼Œä¸¦åœ¨è©²è³‡æ–™å¤¾ä¸‹æ–°å¢ <code>extension.ts</code> æª”æ¡ˆ</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> vscode <span class="keyword">from</span> <span class="string">&#x27;vscode&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Manages webview panels</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebPanel</span> </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Track the currently panel. Only allow a single panel to exist at a time.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> currentPanel: WebPanel | <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> viewType = <span class="string">&#x27;angular&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> panel: vscode.WebviewPanel;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> extensionPath: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> builtAppFolder: <span class="built_in">string</span>;</span><br><span class="line">  <span class="keyword">private</span> disposables: vscode.Disposable[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> createOrShow(</span><br><span class="line">    extensionPath: <span class="built_in">string</span>,</span><br><span class="line">    context: vscode.ExtensionContext</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">const</span> column = vscode.window.activeTextEditor</span><br><span class="line">      ? vscode.window.activeTextEditor.viewColumn</span><br><span class="line">      : <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we already have a panel, show it.</span></span><br><span class="line">    <span class="comment">// Otherwise, create angular panel.</span></span><br><span class="line">    <span class="keyword">if</span> (WebPanel.currentPanel) &#123;</span><br><span class="line">      WebPanel.currentPanel.panel.reveal(column);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      WebPanel.currentPanel = <span class="keyword">new</span> WebPanel(</span><br><span class="line">        extensionPath,</span><br><span class="line">        column || vscode.ViewColumn.One,</span><br><span class="line">        context</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> WebPanel.currentPanel;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="title">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    extensionPath: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">    column: vscode.ViewColumn,</span></span><br><span class="line"><span class="params">    context: vscode.ExtensionContext</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.extensionPath = extensionPath;</span><br><span class="line">    <span class="built_in">this</span>.builtAppFolder = <span class="string">&#x27;dist/cklab&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Create and show a new webview panel</span></span><br><span class="line">    <span class="built_in">this</span>.panel = vscode.window.createWebviewPanel(</span><br><span class="line">      WebPanel.viewType,</span><br><span class="line">      <span class="string">&#x27;My Angular Webview&#x27;</span>,</span><br><span class="line">      column,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Enable javascript in the webview</span></span><br><span class="line">        enableScripts: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// And restrict the webview to only loading content from our extension&#x27;s `media` directory.</span></span><br><span class="line">        localResourceRoots: [</span><br><span class="line">          vscode.Uri.file(path.join(<span class="built_in">this</span>.extensionPath, <span class="built_in">this</span>.builtAppFolder)),</span><br><span class="line">        ],</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set the webview&#x27;s initial html content</span></span><br><span class="line">    <span class="built_in">this</span>.panel.webview.html = <span class="built_in">this</span>._getHtmlForWebview(context);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Listen for when the panel is disposed</span></span><br><span class="line">    <span class="comment">// This happens when the user closes the panel or when the panel is closed programatically</span></span><br><span class="line">    <span class="built_in">this</span>.panel.onDidDispose(<span class="function">() =&gt;</span> <span class="built_in">this</span>.dispose(), <span class="literal">null</span>, <span class="built_in">this</span>.disposables);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle messages from the webview</span></span><br><span class="line">    <span class="built_in">this</span>.panel.webview.onDidReceiveMessage(</span><br><span class="line">      (message: <span class="built_in">any</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">switch</span> (message.command) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&#x27;alert&#x27;</span>:</span><br><span class="line">            vscode.window.showErrorMessage(message.text);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="literal">null</span>,</span><br><span class="line">      <span class="built_in">this</span>.disposables</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="title">dispose</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    WebPanel.currentPanel = <span class="literal">undefined</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Clean up our resources</span></span><br><span class="line">    <span class="built_in">this</span>.panel.dispose();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">this</span>.disposables.length) &#123;</span><br><span class="line">      <span class="keyword">const</span> x = <span class="built_in">this</span>.disposables.pop();</span><br><span class="line">      <span class="keyword">if</span> (x) &#123;</span><br><span class="line">        x.dispose();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Returns html of the start page (index.html)</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="title">_getHtmlForWebview</span>(<span class="params">context: vscode.ExtensionContext</span>)</span> &#123;</span><br><span class="line">    <span class="comment">// path to dist folder</span></span><br><span class="line">    <span class="keyword">const</span> appDistPath = path.join(<span class="built_in">this</span>.extensionPath, <span class="built_in">this</span>.builtAppFolder);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get path to index.html file from dist folder</span></span><br><span class="line">    <span class="keyword">const</span> indexPath = path.join(appDistPath, <span class="string">&#x27;index.html&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read index file from file system</span></span><br><span class="line">    <span class="keyword">let</span> indexHtml = fs.readFileSync(indexPath, &#123; <span class="attr">encoding</span>: <span class="string">&#x27;utf8&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. Get all link prefixed by href or src</span></span><br><span class="line">    <span class="keyword">const</span> matchLinks = <span class="regexp">/(href|src)=&quot;([^&quot;]*)&quot;/g</span>;</span><br><span class="line">    <span class="comment">// 2. Transform the result of the regex into a vscode&#x27;s URI format</span></span><br><span class="line">    <span class="keyword">const</span> toUri = <span class="function">(<span class="params">_: <span class="built_in">string</span>, prefix: <span class="string">&#x27;href&#x27;</span> | <span class="string">&#x27;src&#x27;</span>, link: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// For &lt;base href=&quot;#&quot; /&gt;</span></span><br><span class="line">      <span class="keyword">if</span> (link === <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;prefix&#125;</span>=&quot;<span class="subst">$&#123;link&#125;</span>&quot;`</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// For scripts &amp; links</span></span><br><span class="line">      <span class="keyword">const</span> _path = path.join(appDistPath, link);</span><br><span class="line">      <span class="keyword">const</span> uri = vscode.Uri.file(_path);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;prefix&#125;</span>=&quot;<span class="subst">$&#123;<span class="built_in">this</span>.panel.webview[<span class="string">&#x27;asWebviewUri&#x27;</span>](uri)&#125;</span>&quot;`</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// update the base URI tag</span></span><br><span class="line">    indexHtml = indexHtml.replace(matchLinks, toUri);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> indexHtml;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">activate</span>(<span class="params">context: vscode.ExtensionContext</span>) </span>&#123;</span><br><span class="line">  context.subscriptions.push(</span><br><span class="line">    vscode.commands.registerCommand(<span class="string">&#x27;angular-webview.start&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      WebPanel.createOrShow(context.extensionPath, context);</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// this method is called when your extension is deactivated</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">deactivate</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>line 49: è«‹æ ¹æ“šè‡ªå·± Angular å°ˆæ¡ˆè¼¸å‡ºè³‡æ–™å¤¾è·¯å¾‘åšèª¿æ•´</li><li>line 138: è·Ÿè‘— <code>package.json</code> çš„æŒ‡ä»¤è¨»å†Šä¸€èµ·èª¿æ•´å‘½ä»¤åç¨±</li></ul></li><li><p>æ–°å¢ <code>tsconfig.extension.json</code> æª”æ¡ˆ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;commonjs&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;target&quot;</span>: <span class="string">&quot;es6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;outDir&quot;</span>: <span class="string">&quot;dist&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;lib&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;es6&quot;</span>,</span><br><span class="line">      <span class="string">&quot;dom&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;rootDir&quot;</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;strict&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;include&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;ext-src&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;node_modules/*&quot;</span>, </span><br><span class="line">    <span class="string">&quot;.vscode/*&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>åˆ°é€™é‚Šæ‡‰ç®—æ˜¯å®Œæˆæœ€åŸºæœ¬çš„ VS Code Extension ç’°å¢ƒçš„è¨­å®šï¼Œå¦‚ä½•çœ‹æ˜¯å¦æœ‰è¨­å®šæˆåŠŸï¼Œå¯ä»¥åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿ</p><ol><li><p>é–‹ Terminal åŸ·è¡Œ <code>npm run build</code></p></li><li><p>æŒ‰ F5 é€²å…¥ Debug æ¨¡å¼ï¼Œé€™æ™‚å€™æœƒé–‹å•Ÿä¸€å€‹æ–°çš„ VS Code è¦–çª—</p></li><li><p>åŸ·è¡Œæ‰€è¨­å®šçš„å•Ÿå‹•æŒ‡ä»¤ï¼Œä»¥é€™å€‹ç¯„ä¾‹ä¾†èªªå°±æ˜¯ <code>CK: Open Webview</code></p><p><img src="image-20210205215343080.png" alt="image-20210205215343080"></p></li><li><p>æˆåŠŸå¾Œçš„é¡¯ç¤ºç•«é¢</p><p><img src="image-20210205215408533.png" alt="image-20210205215408533"></p></li></ol><p>è‡³æ–¼åœ¨ VS Code Webview çš„ç’°å¢ƒä¸‹ï¼ŒAngular é–‹ç™¼ä¸Šæœ‰ä»€éº¼éœ€è¦æ³¨æ„çš„äº‹é …ï¼Œé€™éƒ¨åˆ†å°±ç•™åˆ°ä¸‹ä¸€ç¯‡ç­†è¨˜äº†</p><h1 id="æ‰“åŒ…å¥—ä»¶"><a class="header-anchor" href="#æ‰“åŒ…å¥—ä»¶"> </a>æ‰“åŒ…å¥—ä»¶</h1><p>å¦‚æœéƒ½å¯«å®Œè¦ç™¼å¸ƒæˆå¯ä»¥å®‰è£çš„æ“´å……å¥—ä»¶æ™‚ï¼Œå¯ä»¥åŸ·è¡Œ <code>npm run package</code> å°±æœƒç”¢ç”Ÿä¸€å€‹ <code>VSIX</code> çš„å®‰è£æª”æ¡ˆ</p><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://www.youtube.com/watch?v=a5DX5pQ9p5M">How to Code a VSCode Extension</a></li><li><a href="https://code.visualstudio.com/api/get-started/your-first-extension">VSCode Extension Get Started</a></li><li><a href="https://code.visualstudio.com/api/extension-guides/webview">VSCode Webview API</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;å‰å¹¾å¤©æˆ‘åˆ†äº«äº†ä¸€å€‹ YouTube  çš„å½±ç‰‡ï¼Œè©²å½±ç‰‡å¤§è‡´ä¸Šçš„å…§å®¹æ˜¯å¦‚ä½•ä½¿ç”¨ VSCode Extension ä½¿ç”¨ Webview APIï¼Œæ—¢ç„¶å¯ä»¥ç”¨ webview çš„æ–¹å¼ä¾†å‘ˆç¾ç¶²é ï¼Œé‚£é¡¯ç¤ºä¸€å€‹ Angular App ä¹Ÿæ˜¯å¾ˆæ­£å¸¸çš„äº‹æƒ…ï¼Œä½†ç’°å¢ƒè¨­å®šä¸Šè¦æ€éº¼èª¿æ•´å‘¢? é€™ç¯‡ç­†è¨˜å°±ä¾†æ•´ç†ä¸€ä¸‹&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[Flutter] è¨­å®š Firebase Messaging åŠŸèƒ½</title>
    <link href="http://blog.kevinyang.net/2021/01/13/flutter-firebase-message-setup/"/>
    <id>http://blog.kevinyang.net/2021/01/13/flutter-firebase-message-setup/</id>
    <published>2021-01-13T04:18:55.000Z</published>
    <updated>2021-03-17T15:14:17.851Z</updated>
    
    <content type="html"><![CDATA[<p>ç¶²è·¯ä¸Šé¢é—œæ–¼è¨­å®š Flutter çš„æ–‡ç« çœŸçš„å¾ˆäº‚ï¼Œä¹Ÿä¸çŸ¥é“å“ªä¸€å€‹ç‰ˆæœ¬èƒ½ç”¨ï¼Œä¹¾è„†è‡ªå·±æ•´ç†ä¸€ç¯‡ç›®å‰å¯ä»¥ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œé‚„å¥½è¶Šæ™šä½¿ç”¨ï¼Œè¨­å®šæ­¥é©Ÿå°±è¶Šç°¡å–®</p><span id="more"></span><h1 id="è¨­å®š-Firebase-å°ˆæ¡ˆ"><a class="header-anchor" href="#è¨­å®š-Firebase-å°ˆæ¡ˆ"> </a>è¨­å®š Firebase å°ˆæ¡ˆ</h1><p>éœ€è¦å¾ Firebase å°ˆæ¡ˆä¸­ä¸‹è¼‰ google-services.json çš„æª”æ¡ˆï¼Œä»¥ä¾›å¾ŒçºŒå¥—ä»¶ä½¿ç”¨ï¼Œå–å¾—æ­¥é©Ÿå¦‚ä¸‹</p><ol><li>é€²å…¥ Firebase å°ˆæ¡ˆ</li><li>é¸æ“‡å°ˆæ¡ˆè¨­å®š<img src="image-20210113123819276.png" alt="image-20210113123819276"></li><li>æ–°å¢æ‡‰ç”¨ç¨‹å¼ (Android)å¾Œï¼Œå³å¯å–å¾— <code>google-services.json</code> çš„æª”æ¡ˆ</li><li>å°‡è©²æª”æ¡ˆè¤‡è£½åˆ° Flutter å°ˆæ¡ˆä¸‹çš„ <code>android/app</code> è³‡æ–™å¤¾ä¸‹<img src="image-20210113124016995.png" alt="image-20210113124016995"></li></ol><h1 id="Flutter-Firebase-Message-å¥—ä»¶"><a class="header-anchor" href="#Flutter-Firebase-Message-å¥—ä»¶"> </a>Flutter Firebase Message å¥—ä»¶</h1><h2 id="å¥—ä»¶å®‰è£"><a class="header-anchor" href="#å¥—ä»¶å®‰è£"> </a>å¥—ä»¶å®‰è£</h2><p>æ–¼ <code>pubspec.yaml</code> æª”å…§æ–°å¢ä¸‹åˆ—å¥—ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">firebase_core:</span> <span class="string">^0.7.0</span></span><br><span class="line"><span class="attr">firebase_messaging:</span> <span class="number">8.0</span><span class="number">.0</span><span class="string">-dev.13</span></span><br></pre></td></tr></table></figure><h2 id="ç’°å¢ƒè¨­å®š"><a class="header-anchor" href="#ç’°å¢ƒè¨­å®š"> </a>ç’°å¢ƒè¨­å®š</h2><p>ç‚ºäº†è¦è®“ Flutter åœ¨å»ºç½®æ™‚ï¼Œèƒ½è¼‰å…¥å‰›å‰›ä¸‹è¼‰çš„ <code>google-services.json</code> æª”æ¡ˆï¼Œé‚„éœ€èª¿æ•´ä»¥ä¸‹æª”æ¡ˆ</p><ol><li><p><code>android/build.gradle</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">  dependencies &#123;</span><br><span class="line">    &#x2F;&#x2F; ... other dependencies</span><br><span class="line">    &#x2F;&#x2F; æ–°å¢é€™ä¸€è¡Œ</span><br><span class="line">    classpath &#39;com.google.gms:google-services:4.3.3&#39;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><code>/android/app/build.gradle</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &#39;com.android.application&#39;</span><br><span class="line">&#x2F;&#x2F; æ–°å¢é€™ä¸€è¡Œ</span><br><span class="line">apply plugin: &#39;com.google.gms.google-services&#39;</span><br></pre></td></tr></table></figure></li></ol><p>â€»å¦‚æœ Flutter å°ˆæ¡ˆçš„ Flutter ç‰ˆæœ¬æ˜¯ 1.12 ä»¥ä¸Šï¼Œå‰‡ä¸éœ€è¦é¡å¤–æ–°å¢ä»»ä½•æª”æ¡ˆï¼Œå¦‚æœæ˜¯ä½æ–¼è©²ç‰ˆæœ¬ï¼Œè«‹ä¾æ­¤<a href="https://firebase.flutter.dev/docs/messaging/overview#flutter-android-embedding-v1">æ–‡ä»¶</a>èªªæ˜æ–°å¢æª”æ¡ˆ</p><h2 id="ç¨‹å¼ç¢¼è¨­å®š"><a class="header-anchor" href="#ç¨‹å¼ç¢¼è¨­å®š"> </a>ç¨‹å¼ç¢¼è¨­å®š</h2><p>Flutter å…§çš„ç¨‹å¼ç¢¼è¦å¢åŠ çš„é …ç›®å¦‚ä¸‹</p><ol><li><p>main.dart</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() <span class="keyword">async</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">await</span> Firebase.initializeApp();</span><br><span class="line">  <span class="comment">// Set the background messaging handler early on, as a named top-level function</span></span><br><span class="line">  FirebaseMessaging.onBackgroundMessage(_firebaseMessagingBackgroundHandler);</span><br><span class="line">  <span class="comment">/// <span class="markdown">Create an Android Notification Channel.</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">é€™è£¡æœ‰å¤šä½¿ç”¨å¥—ä»¶: flutter<span class="emphasis">_local_</span>notifications: ^3.0.3</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">We use this channel in the <span class="code">`AndroidManifest.xml`</span> file to override the</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">default FCM channel to enable heads up notifications.</span></span></span><br><span class="line">  <span class="keyword">await</span> flutterLocalNotificationsPlugin</span><br><span class="line">      .resolvePlatformSpecificImplementation&lt;</span><br><span class="line">          AndroidFlutterLocalNotificationsPlugin&gt;()</span><br><span class="line">      ?.createNotificationChannel(channel);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">Update the iOS foreground notification presentation options to allow</span></span></span><br><span class="line">  <span class="comment">/// <span class="markdown">heads up notifications.</span></span></span><br><span class="line">  <span class="keyword">await</span> FirebaseMessaging.instance.setForegroundNotificationPresentationOptions(</span><br><span class="line">    alert: <span class="keyword">true</span>,</span><br><span class="line">    badge: <span class="keyword">true</span>,</span><br><span class="line">    sound: <span class="keyword">true</span>,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Future&lt;<span class="keyword">void</span>&gt; _firebaseMessagingBackgroundHandler(RemoteMessage message) <span class="keyword">async</span> &#123;</span><br><span class="line">  <span class="comment">// If you&#x27;re going to use other Firebase services in the background, such as Firestore,</span></span><br><span class="line">  <span class="comment">// make sure you call `initializeApp` before using other Firebase services.</span></span><br><span class="line">  <span class="keyword">await</span> Firebase.initializeApp();</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;Handling a background message <span class="subst">$&#123;message.messageId&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åœ¨å•Ÿå‹•çš„ç¬¬ä¸€å€‹ widget æª”æ¡ˆå…§</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line"><span class="keyword">void</span> initState() &#123;</span><br><span class="line">  <span class="keyword">super</span>.initState();</span><br><span class="line">  <span class="comment">// ç•¶ app è™•æ–¼é–‹å•Ÿç‹€æ…‹æ™‚ï¼Œç›£è½æ¨æ’¥è¨Šæ¯ç”¨</span></span><br><span class="line">  FirebaseMessaging.onMessage.listen((RemoteMessage message) <span class="keyword">async</span> &#123;</span><br><span class="line">    RemoteNotification notification = message.notification;</span><br><span class="line">    AndroidNotification android = message.notification?.android;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">if</span> (notification != <span class="keyword">null</span> &amp;&amp; android != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> flutterLocalNotificationsPlugin.<span class="keyword">show</span>(</span><br><span class="line">          notification.hashCode,</span><br><span class="line">          notification.title,</span><br><span class="line">          notification.body,</span><br><span class="line">          NotificationDetails(</span><br><span class="line">            android: AndroidNotificationDetails(</span><br><span class="line">              channel.id,</span><br><span class="line">              channel.name,</span><br><span class="line">              channel.description,</span><br><span class="line">              icon: <span class="string">&#x27;launch_background&#x27;</span>,</span><br><span class="line">            ),</span><br><span class="line">          ));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">   </span><br><span class="line">  FirebaseMessaging.onMessageOpenedApp.listen((RemoteMessage message) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;A new onMessageOpenedApp event was published!&#x27;</span>);</span><br><span class="line">    <span class="comment">// é€™é‚Šå¯ä»¥å¯«åœ¨ app é—œé–‰ç‹€æ…‹ï¼Œé»é€šçŸ¥è¨Šæ¯æ™‚ï¼Œæ‰“é–‹ app å¾Œè¦åšçš„äº‹æƒ…</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>ç•¶ç„¶é‚„æœ‰å…¶ä»–å¯ä»¥è¨­å®šçš„éƒ¨åˆ†ï¼Œæ›´å¤šç´°ç¯€å¯ä»¥åƒé–±<a href="https://firebase.flutter.dev/docs/messaging/usage/">é€™è£¡çš„æ–‡ä»¶</a></p><h1 id="å»¶ä¼¸é–±è®€"><a class="header-anchor" href="#å»¶ä¼¸é–±è®€"> </a>å»¶ä¼¸é–±è®€</h1><ul><li><p><a href="https://firebase.flutter.dev/docs/messaging/usage/">Firebase Cloud Messaging</a></p></li><li><p><a href="https://github.com/FirebaseExtended/flutterfire/tree/master/packages/firebase_messaging/firebase_messaging">Firebase_messaging_plugin</a></p></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç¶²è·¯ä¸Šé¢é—œæ–¼è¨­å®š Flutter çš„æ–‡ç« çœŸçš„å¾ˆäº‚ï¼Œä¹Ÿä¸çŸ¥é“å“ªä¸€å€‹ç‰ˆæœ¬èƒ½ç”¨ï¼Œä¹¾è„†è‡ªå·±æ•´ç†ä¸€ç¯‡ç›®å‰å¯ä»¥ä½¿ç”¨çš„ç‰ˆæœ¬ï¼Œé‚„å¥½è¶Šæ™šä½¿ç”¨ï¼Œè¨­å®šæ­¥é©Ÿå°±è¶Šç°¡å–®&lt;/p&gt;</summary>
    
    
    
    <category term="Flutter" scheme="http://blog.kevinyang.net/categories/Flutter/"/>
    
    
    <category term="Flutter" scheme="http://blog.kevinyang.net/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>[Dart] List çš„æ“ä½œ reduce èˆ‡ fold</title>
    <link href="http://blog.kevinyang.net/2020/12/27/dart-reduce-fold/"/>
    <id>http://blog.kevinyang.net/2020/12/27/dart-reduce-fold/</id>
    <published>2020-12-27T15:26:33.000Z</published>
    <updated>2021-03-17T15:14:17.851Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯ä¸€å€‹èªè¨€å°æ–¼æ¸…å–®çš„æ“ä½œï¼Œä¸€ç›´éƒ½æ˜¯å¿…é ˆè¦æŒæ¡çš„èƒ½åŠ›ä¹‹ä¸€ï¼Œåœ¨ dart è£¡é¢çš„ List çš„æ“ä½œæ–¹æ³•å¸¸è¦‹åˆæœ‰å¹¾ç¨®ï¼Œè€Œå…¶ä¸­çš„ reduce èˆ‡ fold é€™å…©å€‹æ“ä½œæ–¹å¼ï¼Œå°æˆ‘ä¾†èªªæ˜¯æœ‰é»ç‰¹æ®Šçš„ï¼Œåœ¨æ­¤ç­†è¨˜ä¸€ä¸‹</p><span id="more"></span><h1 id="List-çš„æ“ä½œ"><a class="header-anchor" href="#List-çš„æ“ä½œ"> </a>List   çš„æ“ä½œ</h1><h2 id="reduce"><a class="header-anchor" href="#reduce"> </a>reduce</h2><p>Dart è£¡çš„ <code>reduce</code> è¡Œç‚ºè·Ÿ <code>JavaScript</code> çš„æœ‰é»å·®ç•°ï¼Œå…ˆçœ‹ç¨‹å¼ç¢¼å†ä¾†èªªæ˜</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">int</span>&gt; list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> result = list.reduce((value, element) &#123;</span><br><span class="line">    <span class="keyword">return</span> value + element;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result);</span><br></pre></td></tr></table></figure><ol><li><p><code>reduce</code> çš„éç¨‹ä¸­ï¼Œè³‡æ–™æ“ä½œçš„å‹åˆ¥æ˜¯ä¸èƒ½åšæ›´æ›çš„ï¼Œè¡¨ç¤º value èˆ‡ element çš„å‹åˆ¥æœƒæ˜¯ä¸€è‡´</p></li><li><p>å¦‚æœæƒ³è¦æ“ä½œå¾—è³‡æ–™èˆ‡æƒ³è¦å–çš„çš„çµæœå‹æ…‹ä¸ä¸€æ¨£æ™‚ï¼Œè¦å…ˆåšè½‰å‹å¾Œ(æ­é… map) å†æ“ä½œ</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="keyword">var</span> carts = [</span><br><span class="line">    Cart(productName: <span class="string">&quot;è˜‹æœ&quot;</span>, price: <span class="number">50</span>, amount: <span class="number">1</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;è”¬èœ&#x27;</span>, price: <span class="number">20</span>, amount: <span class="number">2</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;é›è‚‰&#x27;</span>, price: <span class="number">60</span>, amount: <span class="number">3</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;é›è›‹&#x27;</span>, price: <span class="number">10</span>, amount: <span class="number">10</span>),</span><br><span class="line"> ];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> totalPrice = carts.map((element)=&gt; element.amount * element.price)</span><br><span class="line">   .reduce((value,element)=&gt; value+element);</span><br><span class="line">    </span><br><span class="line">  <span class="built_in">print</span>(totalPrice);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> productName;</span><br><span class="line">  <span class="built_in">num</span> price;</span><br><span class="line">  <span class="built_in">num</span> amount;</span><br><span class="line">  Cart(&#123;<span class="keyword">this</span>.productName, <span class="keyword">this</span>.price, <span class="keyword">this</span>.amount&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>method  ä»‹é¢</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">E reduce(</span><br><span class="line">  E combine(E value, E element)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul></li></ol><h2 id="fold"><a class="header-anchor" href="#fold"> </a>fold</h2><p>ä¸Šé¢çš„ç¬¬äºŒå€‹ç¯„ä¾‹å¯«æ³•ï¼Œå¦‚æœå¯«ç¿’æ…£ JavaScript çš„äººæœƒè¦ºå¾—å¾ˆå›‰å”†ï¼Œä½†å…¶å¯¦ JavaScript çš„ reduce ç­‰æ–¼ Dart çš„ foldï¼Œä¸€æ¨£å…ˆä¾†çœ‹ç¨‹å¼ç¢¼</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main()&#123;</span><br><span class="line">  <span class="keyword">var</span> carts = [</span><br><span class="line">    Cart(productName: <span class="string">&quot;Apple&quot;</span>, price: <span class="number">50</span>, amount: <span class="number">1</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;è”¬èœ&#x27;</span>, price: <span class="number">20</span>, amount: <span class="number">2</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;é›è‚‰&#x27;</span>, price: <span class="number">60</span>, amount: <span class="number">3</span>),</span><br><span class="line">    Cart(productName: <span class="string">&#x27;é›è›‹&#x27;</span>, price: <span class="number">10</span>, amount: <span class="number">10</span>),</span><br><span class="line"> ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> totalPrice = carts.fold(<span class="number">0</span>, (prev, element) =&gt; prev + element.price * element.amount);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">print</span>(totalPrice);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> productName;</span><br><span class="line">  <span class="built_in">num</span> price;</span><br><span class="line">  <span class="built_in">num</span> amount;</span><br><span class="line">  Cart(&#123;<span class="keyword">this</span>.productName, <span class="keyword">this</span>.price, <span class="keyword">this</span>.amount&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>fold  çš„åˆå§‹å€¼æ˜¯æ”¾åœ¨ç¬¬ä¸€å€‹ä½ç½®</p></li><li><p>å¾Œé¢çš„ä½¿ç”¨æ–¹å¼å°±å’Œ JavaScript  çš„ reduce ä¸€æ¨£äº†</p></li><li><p>method ä»‹é¢</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dynamic</span> fold(</span><br><span class="line">  initialValue,</span><br><span class="line">  <span class="built_in">dynamic</span> combine(previousValue, E element)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ul><h1 id="å°çµ"><a class="header-anchor" href="#å°çµ"> </a>å°çµ</h1><p>é€™å…©å€‹ç”¨æ³•éƒ½æœ‰ä»–è©¦ç”¨çš„æƒ…å¢ƒï¼Œæ ¹æ“šæƒ…å¢ƒæŒ‘é©åˆçš„æ–¹æ³•ä½¿ç”¨ï¼Œå¯ä»¥è®“ç¨‹å¼ç¢¼ä¹¾æ·¨è¨±å¤š</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;æ¯ä¸€å€‹èªè¨€å°æ–¼æ¸…å–®çš„æ“ä½œï¼Œä¸€ç›´éƒ½æ˜¯å¿…é ˆè¦æŒæ¡çš„èƒ½åŠ›ä¹‹ä¸€ï¼Œåœ¨ dart è£¡é¢çš„ List çš„æ“ä½œæ–¹æ³•å¸¸è¦‹åˆæœ‰å¹¾ç¨®ï¼Œè€Œå…¶ä¸­çš„ reduce èˆ‡ fold é€™å…©å€‹æ“ä½œæ–¹å¼ï¼Œå°æˆ‘ä¾†èªªæ˜¯æœ‰é»ç‰¹æ®Šçš„ï¼Œåœ¨æ­¤ç­†è¨˜ä¸€ä¸‹&lt;/p&gt;</summary>
    
    
    
    <category term="Flutter" scheme="http://blog.kevinyang.net/categories/Flutter/"/>
    
    
    <category term="Flutter" scheme="http://blog.kevinyang.net/tags/Flutter/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•åšå‡ºè‡ªå‹•ç‰ˆè™Ÿçš„æ•ˆæœ</title>
    <link href="http://blog.kevinyang.net/2020/11/02/how-to-auto-version/"/>
    <id>http://blog.kevinyang.net/2020/11/02/how-to-auto-version/</id>
    <published>2020-11-02T07:29:50.000Z</published>
    <updated>2021-03-17T15:14:17.847Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å†å¼„ä¸€å€‹ç‰ˆè™Ÿé¡¯ç¤ºçš„åŠŸèƒ½ï¼Œä½†æˆ‘çœŸçš„å¥½æ‡¶å¾—æ‰‹å‹•å»æ”¹ç‰ˆè™Ÿï¼Œæœ‰ä»€éº¼è‡ªå‹•æ–¹ä¾¿çš„ä½œæ³•å‘¢? ä»¥ä¸‹æ˜¯æˆ‘æ‰¾åˆ°æ¯”è¼ƒæ–¹ä¾¿çš„æ–¹å¼</p><span id="more"></span><h1 id="NET-Core"><a class="header-anchor" href="#NET-Core"> </a>.NET Core</h1><p>åœ¨ä»¥å¾€çš„ <code>.NET å°ˆæ¡ˆ</code> æœ‰ä¸€å€‹è¨˜éŒ„ç‰ˆæœ¬çš„æª”æ¡ˆï¼Œå«åš <code>Assemblyinfo.cs</code>ï¼Œè£¡é¢æœƒè¨˜éŒ„è‘—å°ˆæ¡ˆçš„ç›¸é—œè³‡è¨ŠåŒ…å«ä½œè€…ã€å…¬å¸ã€ç”¢å“åç¨±ã€åŠç‰ˆæœ¬è³‡è¨Šç­‰ï¼Œç›®å‰å¯ä»¥é€é IDE ç·¨è¼¯å°ˆæ¡ˆå±¬æ€§ -&gt; ç·¨è¼¯å¥—ä»¶è³‡è¨Š</p><p><img src="image-20201102154101905.png" alt="image-20201102154101905"></p><p>å¦‚æœè¦è‡ªå‹•ç·¨ç‰ˆæœ¬è™Ÿç¢¼ï¼Œé€™è£¡æœ‰ä¸€å€‹é€éç·¨è¼¯ <code>csproj</code> ä¾†å‹•æ…‹æ”¹è®Šç‰ˆæœ¬</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PropertyGroup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Build</span>&gt;</span>$([System.DateTime]::op_Subtraction($([System.DateTime]::get_Now().get_Date()),$([System.DateTime]::new(2000,1,1))).get_TotalDays())<span class="tag">&lt;/<span class="name">Build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Revision</span>&gt;</span>$([MSBuild]::Divide($([System.DateTime]::get_Now().get_TimeOfDay().get_TotalSeconds()), 2).ToString(&#x27;F0&#x27;))<span class="tag">&lt;/<span class="name">Revision</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Version</span>&gt;</span>1.$(Build).$(Revision)<span class="tag">&lt;/<span class="name">Version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">PropertyGroup</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;build&gt; </code> ã€<code>&lt;Revision&gt;</code> è‡ªå®šç¾©è®Šæ•¸ä¾› <code>&lt;Version&gt;</code> ä½¿ç”¨ï¼Œé€™é‚Šçš„è¦å‰‡å¯ä»¥ä¾å€‹äººå–œå¥½ä¿®æ”¹</li><li><code>&lt;Version&gt;</code> è¨­å®šç”¢å“ç‰ˆæœ¬</li></ul><p><img src="image-20201102161627599.png" alt="image-20201102161627599"></p><p>å°æ‡‰ç”¢ç”Ÿçš„ <code>Assemblyinfo.cs</code> å…§å®¹ç‚º</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">// &lt;auto-generated&gt;</span></span><br><span class="line"><span class="comment">//     é€™æ®µç¨‹å¼ç¢¼æ˜¯ç”±å·¥å…·ç”¢ç”Ÿçš„ã€‚</span></span><br><span class="line"><span class="comment">//     åŸ·è¡Œéšæ®µç‰ˆæœ¬:4.0.30319.42000</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//     å°é€™å€‹æª”æ¡ˆæ‰€åšçš„è®Šæ›´å¯èƒ½æœƒé€ æˆéŒ¯èª¤çš„è¡Œç‚ºï¼Œè€Œä¸”å¦‚æœé‡æ–°ç”¢ç”Ÿç¨‹å¼ç¢¼ï¼Œ</span></span><br><span class="line"><span class="comment">//     è®Šæ›´å°‡æœƒéºå¤±ã€‚</span></span><br><span class="line"><span class="comment">// &lt;/auto-generated&gt;</span></span><br><span class="line"><span class="comment">//------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Reflection;</span><br><span class="line"></span><br><span class="line">[<span class="meta">assembly: Microsoft.Extensions.Configuration.UserSecrets.UserSecretsIdAttribute(<span class="meta-string">&quot;4a3c5c00-20b2-4c11-90d1-d01d65382565&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyCompanyAttribute(<span class="meta-string">&quot;WebApplication4&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyConfigurationAttribute(<span class="meta-string">&quot;Debug&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyFileVersionAttribute(<span class="meta-string">&quot;1.7611.29271.0&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyInformationalVersionAttribute(<span class="meta-string">&quot;1.7611.29271&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyProductAttribute(<span class="meta-string">&quot;WebApplication4&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyTitleAttribute(<span class="meta-string">&quot;WebApplication4&quot;</span>)</span>]</span><br><span class="line">[<span class="meta">assembly: System.Reflection.AssemblyVersionAttribute(<span class="meta-string">&quot;1.7611.29271.0&quot;</span>)</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”± MSBuild WriteCodeFragment é¡åˆ¥ç”¢ç”Ÿã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Angular"><a class="header-anchor" href="#Angular"> </a>Angular</h1><p>æœ‰æ™‚å€™æˆ‘å€‘ä¹Ÿæƒ³è¦åœ¨å‰ç«¯ç¶²ç«™çµ¦äºˆè¨­å®šç‰ˆæœ¬ï¼Œé™¤äº†æ‰‹å‹•ä¿®æ”¹å¤–ï¼Œå…¶å¯¦ä¹Ÿå¯ä»¥é€é <code>npm version</code> ä¾†å®Œæˆï¼Œé›–ç„¶æœ‰é»å¥‡æ€ªï¼Œä½†é‚„æ˜¯å¯ä»¥é‹ä½œå•¦</p><h2 id="npm-version"><a class="header-anchor" href="#npm-version"> </a>npm version</h2><p>é€™åŠŸèƒ½åŸæœ¬æ˜¯ç”¨ä¾†æ›´æ–° npm package ç‰ˆæœ¬ä½¿ç”¨ï¼ŒæŒ‡ä»¤å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm version [&lt;newversion&gt; | major | minor | patch | premajor | preminor | prepatch | prerelease [--preid&#x3D;&lt;prerelease-id&gt;] | from-git]</span><br></pre></td></tr></table></figure><p>é€™æŒ‡ä»¤æœƒåŒæ­¥æ›´æ–° <code>package.json</code> çš„ <code>version</code> æ¬„ä½å€¼ï¼Œé€™é‚Šå°±å¿«é€Ÿåˆ—å‡ºæˆ‘æ‰€ä½¿ç”¨çš„ script</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;prebuild&quot;: &quot;npm --no-git-tag-version version patch&quot;,</span><br><span class="line">&quot;postversion&quot;: &quot;git add package.json package-lock.json &amp;&amp; git commit -mv%npm_package_version%&quot;,</span><br></pre></td></tr></table></figure><ul><li><code>prebuild</code> é€™è¡Œç‚ºæœƒç™¼ç”Ÿåœ¨åŸ·è¡Œ <code>npm build</code> ä¹‹å‰<ul><li><code>--no-git-tag-version</code> è¨­å®š <code>npm version</code> ä¸è¦è‡ªå‹• commit ä¸”ä¸è¦åŠ ä¸Š tag</li><li><code>npm version patch</code> : åªæ›´æ–° patch ç‰ˆè™Ÿ</li></ul></li><li><code>postversion</code> é€™å‹•ä½œæœƒç™¼ç”Ÿåœ¨ <code>npm version</code> ä¹‹å¾Œ<ul><li>åŠ å…¥ä¸¦ commit ç•°å‹•æª”æ¡ˆ</li></ul></li></ul><p>ç•¶ <code>package.json</code> å…§çš„ <code>version</code> è™•ç†å®Œå¾Œï¼Œå°±å¯ä»¥åœ¨ <code>environment.ts</code> çš„åœ°æ–¹å¼•ç”¨ <code>package.json</code> äº†</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> environment = &#123;</span><br><span class="line">  version: <span class="built_in">require</span>(<span class="string">&#x27;../../package.json&#x27;</span>).version,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”±æ–¼é€™é‚Šæœ‰ä½¿ç”¨åˆ° <code>node</code> çš„ <code>required</code> ï¼Œåœ¨ <code>tsconfig.app.json</code> åŠ <code>tsconfig.spec.json</code> çš„ <code>compilerOptions.types</code> å…§è¦åŠ ä¸Š <code>node</code>ï¼Œä¸¦å®‰è£ <code>@types/node</code> çš„å‹åˆ¥å®šç¾©æª”ï¼Œå‰©ä¸‹å°±è·ŸåŸä¾†ä½¿ç”¨ environment çš„æ–¹å¼ä¸€æ¨£äº†</p><h1 id="å°çµ"><a class="header-anchor" href="#å°çµ"> </a>å°çµ</h1><p>ç›®å‰æ˜¯æˆ‘è™•ç†è‡ªå‹•ç‰ˆè™Ÿçš„æ–¹å¼ï¼Œå¦‚æœæœ‰å…¶ä»–æ›´å¥½çš„ä½œæ³•ï¼Œä¹Ÿæ­¡è¿åˆ†äº«çµ¦æˆ‘</p><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://edi.wang/post/2018/9/27/get-app-version-net-core">Get App Version in .NET Core</a></li><li><a href="https://docs.npmjs.com/cli/v6/commands/npm-version">npm version</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;æœ€è¿‘å†å¼„ä¸€å€‹ç‰ˆè™Ÿé¡¯ç¤ºçš„åŠŸèƒ½ï¼Œä½†æˆ‘çœŸçš„å¥½æ‡¶å¾—æ‰‹å‹•å»æ”¹ç‰ˆè™Ÿï¼Œæœ‰ä»€éº¼è‡ªå‹•æ–¹ä¾¿çš„ä½œæ³•å‘¢? ä»¥ä¸‹æ˜¯æˆ‘æ‰¾åˆ°æ¯”è¼ƒæ–¹ä¾¿çš„æ–¹å¼&lt;/p&gt;</summary>
    
    
    
    <category term="å…¶ä»–" scheme="http://blog.kevinyang.net/categories/%E5%85%B6%E4%BB%96/"/>
    
    
    <category term="å…¶ä»–" scheme="http://blog.kevinyang.net/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title>[EF Core] æ–°å¢ä¸€å€‹è¨ˆç®—æ¬„ä½ (Computed Column)</title>
    <link href="http://blog.kevinyang.net/2020/09/17/efcore-add-computed-column/"/>
    <id>http://blog.kevinyang.net/2020/09/17/efcore-add-computed-column/</id>
    <published>2020-09-17T04:23:28.000Z</published>
    <updated>2021-03-17T15:14:17.847Z</updated>
    
    <content type="html"><![CDATA[<p>ç•¶ä½¿ç”¨ EF Code First è¨­è¨ˆè³‡æ–™è¡¨æ™‚ï¼Œå¦‚æœæœ‰ä¸€å€‹æ¬„ä½æ˜¯è¦è¨­å®šè¨ˆç®—å…¬å¼æ™‚ï¼Œç¨‹å¼ç¢¼è©²å¦‚ä½•å¯«å‘¢?</p><span id="more"></span><p>ä»¥ä¸‹å¹¾å€‹æ­¥é©Ÿ</p><ol><li><p>åœ¨æ¬„ä½ä¸Šæ¨™è¨˜æ¬„ä½å±¬æ–¼ <code>computed</code> æ€§è³ª</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DatabaseGenerated(DatabaseGeneratedOption.Computed)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> CalculatedField &#123;</span><br><span class="line">    <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢ <code>migration</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add-migration xxxx-xxxx</span><br></pre></td></tr></table></figure></li><li><p>æ‰“é–‹å‰›å»ºç«‹çš„ <code>migration</code> æª”æ¡ˆä¸¦æ‰¾åˆ°å‰›å‰›æ‰€æŒ‡å®šçš„æ¬„ä½</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">migrationBuilder.CreateTable(</span><br><span class="line">                name: <span class="string">&quot;Demo&quot;</span>,</span><br><span class="line">                columns: table =&gt; <span class="keyword">new</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// åˆªé™¤åŸæœ¬ç”¢ç”Ÿçš„æ¬„ä½</span></span><br><span class="line">                   CalculatedField = table.Column&lt;<span class="built_in">int</span>&gt;(nullable: <span class="literal">false</span>, defaultValue: <span class="number">0</span>),</span><br><span class="line">                &#125;,</span><br><span class="line">);</span><br><span class="line">migrationBuilder.Sql(<span class="string">&quot;ALTER TABLE dbo.Demo ADD CalculatedField AS ([ä½ çš„è¨ˆç®—è¦å‰‡])&quot;</span>);      </span><br></pre></td></tr></table></figure></li><li><p>æ‰“å®Œæ”¶å·¥</p></li></ol><p>ä»¥ä¸Šæ˜¯æˆ‘ç›®å‰çš„ä½œæ³•ï¼Œèƒ½æ­£å¸¸é‹ä½œã€‚å¦‚æœæœ‰æ›´å¥½çš„å¯«æ³•ï¼Œä¹Ÿæ­¡è¿åœ¨ä¸‹é¢ç•™è¨€åˆ†äº«è¨è«–</p><h1 id="é¡å¤–è£œå……"><a class="header-anchor" href="#é¡å¤–è£œå……"> </a>é¡å¤–è£œå……</h1><p>å¦‚æœæƒ³è¦é€é EF Migration ä¾†æ–°å¢ Stored Procedure çš„è©±ï¼Œå¯ä»¥é€™æ¨£å­å¯«</p><ol><li><p>å°‡ storeã„ procedure çš„ SQL æª”æ¡ˆæ”¾åœ¨æŸè³‡æ–™å¤¾ä¸‹ï¼Œä¸¦å°‡ SQL æª”æ¡ˆè¨­å®šç‚º <code>å…§åµŒè³‡æº (EmbeddedResource)</code></p></li><li><p>æ–°å¢ä¸€å€‹ç©ºçš„ migration å¾ŒåŠ å…¥ä»¥ä¸‹çš„ç¨‹å¼ç¢¼</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Up</span>(<span class="params">MigrationBuilder migrationBuilder</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">var</span> assembly = Assembly.GetExecutingAssembly();</span><br><span class="line">            <span class="keyword">var</span> resourceNames =</span><br><span class="line">                        assembly.GetManifestResourceNames().                        </span><br><span class="line">                        Where(str=&gt; str.Contains(<span class="string">&quot;[sp file name].sql&quot;</span>));</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="built_in">string</span> resourceName <span class="keyword">in</span> resourceNames)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">using</span> (Stream stream = assembly.GetManifestResourceStream(resourceName))</span><br><span class="line">                <span class="keyword">using</span> (StreamReader reader = <span class="keyword">new</span> StreamReader(stream))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> sql = reader.ReadToEnd();</span><br><span class="line">                    migrationBuilder.Sql(sql);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Down</span>(<span class="params">MigrationBuilder migrationBuilder</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            migrationBuilder.Sql(<span class="string">&quot;DROP PROCEDURE [SP Name]&quot;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>ç•¶é€²è¡Œ database æ›´æ–°æ™‚ï¼Œå°±æœƒå°‡è©² SP æ–°å¢åˆ°è³‡æ–™åº«ä¸­</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç•¶ä½¿ç”¨ EF Code First è¨­è¨ˆè³‡æ–™è¡¨æ™‚ï¼Œå¦‚æœæœ‰ä¸€å€‹æ¬„ä½æ˜¯è¦è¨­å®šè¨ˆç®—å…¬å¼æ™‚ï¼Œç¨‹å¼ç¢¼è©²å¦‚ä½•å¯«å‘¢?&lt;/p&gt;</summary>
    
    
    
    <category term="Entity Framework" scheme="http://blog.kevinyang.net/categories/Entity-Framework/"/>
    
    
    <category term="Entity Framework" scheme="http://blog.kevinyang.net/tags/Entity-Framework/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] å¦‚ä½•å¯«å…·æœ‰éåŒæ­¥é©—è­‰çš„ Angular è‡ªè¨‚è¡¨å–®ç‰©ä»¶</title>
    <link href="http://blog.kevinyang.net/2020/08/29/angular-custom-form-control-with-async-valiator/"/>
    <id>http://blog.kevinyang.net/2020/08/29/angular-custom-form-control-with-async-valiator/</id>
    <published>2020-08-29T12:14:05.000Z</published>
    <updated>2021-03-17T15:14:17.847Z</updated>
    
    <content type="html"><![CDATA[<p>å‰å¹¾å¤©æœ‰äººåœ¨è«–å£‡å•äº†ä¸€å€‹è‡ªè¨‚è¡¨å–®éåŒæ­¥é©—è­‰çš„å•é¡Œï¼Œé€™å•é¡Œæ˜¯ç•¶ä¸€å€‹è‡ªè¨‚è¡¨å–®ç‰©ä»¶å…§æœ‰éåŒæ­¥é©—è­‰æ™‚ï¼Œå¤–éƒ¨ä½¿ç”¨è€…ç„¡æ³•æ­£ç¢ºåœ°å–å¾—è©²è¡¨å–®ç‰©ä»¶çš„é©—è­‰ç‹€æ…‹ï¼Œé€™å•é¡Œæˆ‘ä¸€é–‹å§‹æƒ³èªªæ‡‰è©²ä¸é›£ï¼Œä½†ä¹ŸèŠ±äº†æˆ‘å¿«ä¸€å¤©çš„æ™‚é–“æ‰é‡æ¸…è¦æ€éº¼å¯«ä¸€å€‹å…·æœ‰éåŒæ­¥é©—è­‰çš„è‡ªè¨‚è¡¨å–®ç‰©ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹</p><span id="more"></span><h1 id="åŒæ­¥é©—è­‰"><a class="header-anchor" href="#åŒæ­¥é©—è­‰"> </a>åŒæ­¥é©—è­‰</h1><p>æˆ‘å€‘éƒ½çŸ¥é“ Angular <code>FormControl</code> çš„é©—è­‰æœ‰åˆ†åŒæ­¥èˆ‡åˆ†åŒæ­¥å…©ç¨®æ–¹å¼ï¼Œä¸‹é¢æ˜¯åŒæ­¥é©—è­‰çš„å¯«æ³•</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">&quot;app-user&quot;</span>,</span><br><span class="line">  templateUrl: <span class="string">&quot;./user.component.html&quot;</span>,</span><br><span class="line">  styleUrls: [<span class="string">&quot;./user.component.css&quot;</span>],</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: NG_VALUE_ACCESSOR,</span><br><span class="line">      useExisting: UserComponent,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      provide: NG_VALIDATORS,</span><br><span class="line">      useExisting: UserComponent,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserComponent</span> <span class="title">implements</span> <span class="title">OnInit</span>, <span class="title">ControlValueAccessor</span>, <span class="title">Validator</span> </span>&#123;</span><br><span class="line">  firstName = <span class="keyword">new</span> FormControl(<span class="string">&quot;&quot;</span>, [Validators.required]);</span><br><span class="line">  onChange: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;&#125;;</span><br><span class="line">  onTouched: <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">ngOnInit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.firstName.valueChanges.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.onChange) &#123;</span><br><span class="line">          <span class="built_in">this</span>.onChange(value);</span><br><span class="line">          <span class="built_in">this</span>.onTouched();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="title">writeValue</span>(<span class="params">obj: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.firstName.patchValue(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">registerOnChange</span>(<span class="params">fn: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onChange = fn;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">registerOnTouched</span>(<span class="params">fn: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onTouched = fn;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">validate</span>(<span class="params"></span>)</span> &#123;    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.firstName.errors;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åˆ†åŒæ­¥é©—è­‰"><a class="header-anchor" href="#åˆ†åŒæ­¥é©—è­‰"> </a>åˆ†åŒæ­¥é©—è­‰</h1><p>éåŒæ­¥é©—è­‰åœ¨ <code>FormControl</code> çš„é©—è­‰ç‹€æ…‹æ˜¯ <code>PENDING</code>  &lt;â€“&gt; <code>VALID/INVALID</code> é–“åˆ‡æ›ï¼Œç”±æ–¼éåŒæ­¥èˆ‡åŒæ­¥è¦å¯¦ä½œçš„æ–¹æ³•éƒ½æ˜¯åŒä¸€å€‹ï¼Œæ‰€ä»¥ç•¶éåŒæ­¥èˆ‡åŒæ­¥é©—è­‰åŒæ™‚å­˜åœ¨æ™‚ï¼Œè¦ä»¥éåŒæ­¥ç‚ºæº–ï¼Œä¸ç„¶æ•´å€‹é©—è­‰éƒ½åªæœƒå–å¾—åŒæ­¥é©—è­‰çš„</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">   ...</span><br><span class="line">    providers: [</span><br><span class="line">    ...</span><br><span class="line">    &#123;</span><br><span class="line">      provide: NG_ASYNC_VALIDATORS,</span><br><span class="line">      useExisting: UserComponent,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserComponent</span> <span class="title">implements</span> <span class="title">OnInit</span>, <span class="title">ControlValueAccessor</span>, <span class="title">Validator</span> </span>&#123;</span><br><span class="line">  firstName = <span class="keyword">new</span> FormControl(<span class="string">&quot;&quot;</span>, [Validators.required], [<span class="built_in">this</span>.asyncValidator]);</span><br><span class="line">  onChange: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;&#125;;</span><br><span class="line">  onTouched: <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">asyncValidator</span>(<span class="params">c: AbstractControl</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">of</span>(c.value === <span class="string">&quot;123&quot;</span>).pipe(</span><br><span class="line">      delay(<span class="number">500</span>),</span><br><span class="line">      map(<span class="function"><span class="params">b</span> =&gt;</span> (b ? <span class="literal">null</span> : &#123; <span class="attr">nomatch</span>: <span class="literal">true</span> &#125;))</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">  <span class="function"><span class="title">validate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.firstName.errors;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€æ—¦è¨»å†Šæˆ <code>NG_ASYNC_VALIDATORS</code> æ™‚ï¼Œå¤–éƒ¨ä½¿ç”¨é€™ä¸€å€‹è‡ªè¨‚ <code>FormControl</code> çš„ status å°±æœƒè™•åœ¨ <code>PENDING</code> ï¼Œè€Œå…¶åŸå› æ˜¯å› ç‚º <code>validate</code>  çš„æ–¹æ³•æ²’æœ‰å›å‚³ä¸€å€‹å®Œæˆçš„è¨Šè™Ÿï¼ŒåŸºæ–¼é€™ä¸€å€‹ç†ç”±ï¼Œæˆ‘å€‘éœ€è¦èª¿æ•´ <code>validate</code> çš„å¯¦ä½œæ–¹å¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">validate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.firstName.statusChanges.pipe(      </span><br><span class="line">      filter(<span class="function"><span class="params">status</span> =&gt;</span> status !== <span class="string">&quot;PENDING&quot;</span>),</span><br><span class="line">      map(<span class="function"><span class="params">status</span> =&gt;</span> <span class="built_in">this</span>.firstName.errors),      </span><br><span class="line">      first()</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´ç¨‹å¼ç¢¼å¦‚ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">&quot;@angular/core&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  ControlValueAccessor,</span><br><span class="line">  Validator,</span><br><span class="line">  NG_VALUE_ACCESSOR,</span><br><span class="line">  NG_VALIDATORS,</span><br><span class="line">  NG_ASYNC_VALIDATORS,</span><br><span class="line">  Validators,</span><br><span class="line">  AbstractControl</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;@angular/forms&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormControl &#125; <span class="keyword">from</span> <span class="string">&quot;@angular/forms&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">of</span> &#125; <span class="keyword">from</span> <span class="string">&quot;rxjs&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; filter, tap, map, delay, first &#125; <span class="keyword">from</span> <span class="string">&quot;rxjs/operators&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">&quot;app-user&quot;</span>,</span><br><span class="line">  templateUrl: <span class="string">&quot;./user.component.html&quot;</span>,</span><br><span class="line">  styleUrls: [<span class="string">&quot;./user.component.css&quot;</span>],</span><br><span class="line">  providers: [</span><br><span class="line">    &#123;</span><br><span class="line">      provide: NG_VALUE_ACCESSOR,</span><br><span class="line">      useExisting: UserComponent,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      provide: NG_ASYNC_VALIDATORS,</span><br><span class="line">      useExisting: UserComponent,</span><br><span class="line">      multi: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">UserComponent</span> <span class="title">implements</span> <span class="title">OnInit</span>, <span class="title">ControlValueAccessor</span>, <span class="title">Validator</span> </span>&#123;</span><br><span class="line">  firstName = <span class="keyword">new</span> FormControl(<span class="string">&quot;&quot;</span>, [Validators.required], [<span class="built_in">this</span>.asyncValidator]);</span><br><span class="line">  onChange: <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;&#125;;</span><br><span class="line">  onTouched: <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">asyncValidator</span>(<span class="params">c: AbstractControl</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">of</span>(c.value === <span class="string">&quot;123&quot;</span>).pipe(</span><br><span class="line">      delay(<span class="number">500</span>),</span><br><span class="line">      map(<span class="function"><span class="params">b</span> =&gt;</span> (b ? <span class="literal">null</span> : &#123; <span class="attr">nomatch</span>: <span class="literal">true</span> &#125;))</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">ngOnInit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.firstName.valueChanges.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.onChange) &#123;</span><br><span class="line">          <span class="built_in">this</span>.onChange(value);</span><br><span class="line">          <span class="built_in">this</span>.onTouched();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">writeValue</span>(<span class="params">obj: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.firstName.patchValue(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">registerOnChange</span>(<span class="params">fn: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onChange = fn;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">registerOnTouched</span>(<span class="params">fn: <span class="built_in">any</span></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.onTouched = fn;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">validate</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.firstName.statusChanges.pipe(</span><br><span class="line">      filter(<span class="function"><span class="params">status</span> =&gt;</span> status !== <span class="string">&quot;PENDING&quot;</span>),</span><br><span class="line">      map(<span class="function"><span class="params">status</span> =&gt;</span> <span class="built_in">this</span>.firstName.errors),      </span><br><span class="line">      first()</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><p><a href="https://stackblitz.com/edit/angular-ivy-qdvfuj?file=src%2Fapp%2Fuser%2Fuser.component.ts">stackbliz</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;å‰å¹¾å¤©æœ‰äººåœ¨è«–å£‡å•äº†ä¸€å€‹è‡ªè¨‚è¡¨å–®éåŒæ­¥é©—è­‰çš„å•é¡Œï¼Œé€™å•é¡Œæ˜¯ç•¶ä¸€å€‹è‡ªè¨‚è¡¨å–®ç‰©ä»¶å…§æœ‰éåŒæ­¥é©—è­‰æ™‚ï¼Œå¤–éƒ¨ä½¿ç”¨è€…ç„¡æ³•æ­£ç¢ºåœ°å–å¾—è©²è¡¨å–®ç‰©ä»¶çš„é©—è­‰ç‹€æ…‹ï¼Œé€™å•é¡Œæˆ‘ä¸€é–‹å§‹æƒ³èªªæ‡‰è©²ä¸é›£ï¼Œä½†ä¹ŸèŠ±äº†æˆ‘å¿«ä¸€å¤©çš„æ™‚é–“æ‰é‡æ¸…è¦æ€éº¼å¯«ä¸€å€‹å…·æœ‰éåŒæ­¥é©—è­‰çš„è‡ªè¨‚è¡¨å–®ç‰©ä»¶ï¼Œæ–¹æ³•å¦‚ä¸‹&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[å®¹å™¨] å¦‚ä½•å¯« Dockerfile</title>
    <link href="http://blog.kevinyang.net/2020/08/03/docker-101-note-3/"/>
    <id>http://blog.kevinyang.net/2020/08/03/docker-101-note-3/</id>
    <published>2020-08-03T05:36:31.000Z</published>
    <updated>2021-03-17T15:14:17.847Z</updated>
    
    <content type="html"><![CDATA[<p>å‰é¢å…©ç¯‡ç­†è¨˜éƒ½åœ¨æ•´ç†å¦‚ä½•æ“ä½œ docker containerï¼Œè¦æ€éº¼è£½ä½œæœ€é‡è¦çš„ Image å‘¢? æˆ‘æœƒåœ¨é€™ç¯‡æ•´ç†å‡ºä¾†</p><span id="more"></span><p>è¦å»ºç«‹å‡ºä¸€å€‹å¯ä»¥ç”¨ä¾†åŸ·è¡Œçš„ Imageï¼Œå°±å¿…é ˆé€é <code>Dockerfile</code> ä¾†è¨­å®šï¼Œ<code>Dockerfile</code> æ˜¯ä¸€å€‹é¡ä¼¼æ–‡å­—æª”çš„è¨­å®šæª”ï¼Œdocker æœƒä¾ <code>Dockerfile</code> å…§çš„è¨­å®šå»ºç«‹å‡ºä¸€å€‹å¯ä»¥éƒ¨å±¬åˆ° Registry çš„ Imageï¼Œå…¶è¨­å®šå…§å®¹å…¶å¯¦ä¸è¤‡é›œï¼Œä»¥ä¸‹ç‚ºç°¡å–®èªæ³•ä»‹ç´¹</p><h1 id="Dockerfile-çµæ§‹èˆ‡ä½¿ç”¨èªæ³•"><a class="header-anchor" href="#Dockerfile-çµæ§‹èˆ‡ä½¿ç”¨èªæ³•"> </a>Dockerfile çµæ§‹èˆ‡ä½¿ç”¨èªæ³•</h1><p>å¦‚ä¹‹å‰æ‰€èªªï¼ŒImage æ‰€èƒ½åŸ·è¡Œçš„ OS å¿…é ˆè·Ÿåº•å±¤ docker server è·‘çš„ OS ä¸€æ¨£æˆ–æ˜¯ä½¿ç”¨åŒç¨® Kernelï¼Œæ‰€ä»¥ç•¶ docker server æ˜¯è·‘åœ¨ Linux base ä¸Šï¼Œé‚£ Dockerfile èƒ½è·‘çš„ç’°å¢ƒä¹Ÿåªèƒ½æ˜¯ Linux baseã€‚ä¸‹é¢æ˜¯ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">18.04</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> make /app</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> python /app/app.py</span></span><br></pre></td></tr></table></figure><ul><li><code>FROM</code> Image å°‡åŸ·è¡Œçš„ç’°å¢ƒï¼Œé€™é‚Šå¯ä»¥ä½¿ç”¨åˆ¥äººå»ºç«‹å¥½çš„ Base Imageï¼Œé€šå¸¸æ˜¯ä½œæ¥­ç³»çµ±ï¼Œä¾‹å¦‚ ubuntu, centos æˆ–æ˜¯ <code>core/aspnet</code> çš„åŸ·è¡Œç’°å¢ƒ</li><li><code>COPY</code> è¤‡è£½æœ¬æ©Ÿæª”æ¡ˆåˆ° Image è£¡ï¼Œæœ¬æ©Ÿæ ¹ç›®éŒ„çš„èªå®šç‚º <code>Dockerfile</code> æ‰€è™•çš„ç›®éŒ„</li><li><code>RUN</code> åŸ·è¡Œ Linux æŒ‡ä»¤</li><li><code>CMD</code> ç•¶åŸ·è¡Œ <code>docker run</code> æ™‚æœƒåŸ·è¡Œçš„æŒ‡ä»¤ï¼Œå¦‚æœæœ‰å€‹ <code>CMD</code> åªæœ‰æœ€å¾Œä¸€è¡Œæœƒç”Ÿæ•ˆ</li></ul><p>å¦‚æœèƒ½çœ‹æ‡‚è·Ÿç†è§£ä¸Šé¢çš„ <code>Dockerfile</code>ï¼Œé‚£åŸºæœ¬ä¸Šå°±åªæ˜¯ <code>Dockerfile</code> èªæ³•åŠç’°å¢ƒè¨­å®šçš„ç†Ÿæ‚‰åº¦äº†ï¼Œä¸‹é¢å†åˆ—å‡ºå¹¾å€‹å¸¸ç”¨çš„æŒ‡ä»¤</p><ul><li><p><code>WORKDIR</code> è¨­å®šç•¶å‰çš„å·¥ä½œç›®éŒ„</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br></pre></td></tr></table></figure></li><li><p><code>LABEL</code> Image çš„ Metadata è³‡è¨Š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LABEL</span><span class="bash"> description=<span class="string">&quot;é€™æ˜¯LABELçš„ç¯„ä¾‹&quot;</span> version=<span class="string">&quot;1.0&quot;</span> owner=<span class="string">&quot;CK&#x27;s Notepad&quot;</span></span></span><br></pre></td></tr></table></figure></li><li><p><code>ENV</code> è¨­å®šç’°å¢ƒè®Šæ•¸</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> &lt;KEY&gt; &lt;Value&gt;</span><br></pre></td></tr></table></figure></li><li><p><code>ENTRYPOINT</code> ä½œç”¨è·Ÿ <code>CMD</code> ä¸€æ¨£ï¼Œå·®ç•°åœ¨ä»–ä¸æœƒè¢« <code>docker run &lt;image&gt; &lt;command&gt;</code> çµ¦è¦†è“‹æ‰</p></li><li><p><code>EXPOSE</code> å®£å‘Š Container é‹è¡Œæ™‚å°å¤–æœ‰å“ªäº› Port å¯ä»¥ä½¿ç”¨ (å®£å‘Šè€Œå·²)</p></li></ul><h1 id="å¯¦éš›-Dockerfile-ç¯„ä¾‹"><a class="header-anchor" href="#å¯¦éš›-Dockerfile-ç¯„ä¾‹"> </a>å¯¦éš› Dockerfile ç¯„ä¾‹</h1><h2 id="asp-net-core"><a class="header-anchor" href="#asp-net-core"> </a><a href="http://asp.net">asp.net</a> core</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> mcr.microsoft.com/dotnet/core/sdk:<span class="number">3.0</span> AS build</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># copy csproj and restore as distinct layers</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> *.sln .</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> aspnetapp/*.csproj ./aspnetapp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> dotnet restore</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># copy everything else and build app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> aspnetapp/. ./aspnetapp/</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app/aspnetapp</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> dotnet publish -c Release -o out</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> mcr.microsoft.com/dotnet/core/aspnet:<span class="number">3.0</span> AS runtime</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --from=build /app/aspnetapp/out ./</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">&quot;dotnet&quot;</span>, <span class="string">&quot;aspnetapp.dll&quot;</span>]</span></span><br></pre></td></tr></table></figure><h2 id="Angular"><a class="header-anchor" href="#Angular"> </a>Angular</h2><ul><li><p>å–®ç´”å¯ä»¥åŸ·è¡Œçš„</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx:alpine</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> /dist/app-to-run-inside-docker /usr/share/nginx/html</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨ docker ç’°å¢ƒå…§å»ºç½®éƒ¨å±¬ (multiple-stage)</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># stage 1</span></span><br><span class="line"><span class="keyword">FROM</span> node:alpine AS my-app-build</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> npm install &amp;&amp; npm run build</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># stage 2</span></span><br><span class="line"><span class="keyword">FROM</span> nginx:alpine</span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --from=my-app-build /app/dist/app-to-run-inside-docker /usr/share/nginx/html</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="å»ºç½®-Dockerfile"><a class="header-anchor" href="#å»ºç½®-Dockerfile"> </a>å»ºç½® Dockerfile</h1><p>è¦å»ºç½® Image é€éæŒ‡ä»¤å°±å¯ä»¥å®Œæˆäº†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build [OPTIONS] PATH | URL | -</span><br><span class="line">// ç¯„ä¾‹</span><br><span class="line">docker build -t angular-app .</span><br></pre></td></tr></table></figure><ul><li><code>-t</code> : ä¸Š Tag</li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;å‰é¢å…©ç¯‡ç­†è¨˜éƒ½åœ¨æ•´ç†å¦‚ä½•æ“ä½œ docker containerï¼Œè¦æ€éº¼è£½ä½œæœ€é‡è¦çš„ Image å‘¢? æˆ‘æœƒåœ¨é€™ç¯‡æ•´ç†å‡ºä¾†&lt;/p&gt;</summary>
    
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/categories/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/categories/Container/"/>
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/tags/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>[å®¹å™¨] å®¹å™¨æŠ€è¡“ä¹‹ Docker ç¯‡ - æŒ‡ä»¤æ“ä½œ</title>
    <link href="http://blog.kevinyang.net/2020/07/31/docker-101-note-2/"/>
    <id>http://blog.kevinyang.net/2020/07/31/docker-101-note-2/</id>
    <published>2020-07-31T09:10:13.000Z</published>
    <updated>2021-03-17T15:14:17.847Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€ç¯‡æ•´ç†äº†æ¦‚å¿µï¼Œé€™ä¸€ç¯‡ä¾†æ•´ç†å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œé›–ç„¶ä¹Ÿæœ‰ GUI æ“ä½œ docker çš„æœå‹™ï¼Œä½†é€éæŒ‡ä»¤é‚„æ˜¯æ¯”è¼ƒå¿«çš„</p><span id="more"></span><h1 id="Image-ç›¸é—œ"><a class="header-anchor" href="#Image-ç›¸é—œ"> </a>Image ç›¸é—œ</h1><ul><li><p>åˆ—å‡ºæœ¬æ©Ÿç«¯æ“æœ‰çš„ images</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><ul><li><code>-a</code>ï¼šåˆ—å‡ºå®Œæ•´çš„æ˜ åƒæª”å±¤æ¬¡è³‡è¨Šã€‚æ¯å€‹æ˜ åƒæª”æ˜¯ç”±ä¸åŒå±¤æ¬¡çµ„æˆçš„ï¼Œæˆ‘å€‘æœƒåœ¨ç¨å¾Œèªªæ˜ã€‚</li><li><code>-q</code>ï¼šåªåˆ—å‡ºæ˜ åƒæª”IDã€‚é€™åœ¨åšæ˜ åƒæª”æ‰¹æ¬¡è™•ç†æ™‚å¾ˆæ–¹ä¾¿ã€‚</li><li><code>-tree</code>ï¼šå®˜æ–¹æ–‡ä»¶å·²ç¶“æ²’æœ‰é€™å€‹åƒæ•¸ï¼Œä½†é‚„æ˜¯å¯ä»¥ç”¨ã€‚åˆ—å‡ºæ˜ åƒæª”ä¸åŒå±¤æ¬¡ä¹‹é–“çš„æ¨¹ç‹€é—œä¿‚ã€‚</li></ul></li><li><p>ä¸‹è¼‰ Image</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull &lt;image name&gt;</span><br></pre></td></tr></table></figure></li><li><p>åˆªé™¤ Image</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi &lt;image name&gt;</span><br></pre></td></tr></table></figure></li><li><p>å¹« Image ä¸Š Tag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]</span><br></pre></td></tr></table></figure></li><li><p>å»ºç½® Image æª”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build</span><br></pre></td></tr></table></figure></li><li><p>ä¸Šå‚³ Image æª”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push</span><br></pre></td></tr></table></figure></li></ul><h1 id="Container-ç›¸é—œ"><a class="header-anchor" href="#Container-ç›¸é—œ"> </a>Container ç›¸é—œ</h1><h2 id="åŸ·è¡Œæ™‚çš„æ“ä½œæŒ‡ä»¤"><a class="header-anchor" href="#åŸ·è¡Œæ™‚çš„æ“ä½œæŒ‡ä»¤"> </a>åŸ·è¡Œæ™‚çš„æ“ä½œæŒ‡ä»¤</h2><ul><li><p>å»ºç«‹ Container ä¸¦åŸ·è¡ŒæŒ‡ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker create [OPTIONS] IMAGE [COMMAND] [ARG...] &#x2F;&#x2F; å»ºç«‹ä½†ä¸æœƒå•Ÿå‹•åŸ·è¡Œ Container </span><br><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...] &#x2F;&#x2F; å»ºç«‹ä¸”å•Ÿå‹•åŸ·è¡Œ Container</span><br></pre></td></tr></table></figure><ul><li><code>-d</code> : èƒŒæ™¯åŸ·è¡Œ</li><li><code>-i</code>: è¼¸å…¥</li><li><code>-t</code>: è¼¸å‡º</li><li><code>--name</code>: çµ¦ Container åç¨±</li><li><code>-p [æœ¬æ©Ÿ Port]:[Container å…§éƒ¨ Port]</code>: Port mapping</li><li><code>-v</code>: æ›è¼‰  volumes</li><li><code>-rm</code>: åŸ·è¡ŒçµæŸå¾Œè‡ªå‹•ç§»é™¤</li><li>ç›¸é—œåƒæ•¸è«‹åƒé–± <a href="https://docs.docker.com/engine/reference/commandline/create/#options">Docker docs</a></li></ul></li><li><p>åˆªé™¤åŸ·è¡Œä¸­çš„ Containerï¼Œ<strong>ä½† Container é‚„æ˜¯å­˜åœ¨ï¼Œåªæ˜¯æ­»äº†ã€‚</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker kill CONTAINER</span><br></pre></td></tr></table></figure><ul><li><code>--signal, -s</code> : é€è¨Šè™Ÿåˆ° Container</li></ul></li><li><p>ç§»é™¤ Container(åœæ­¢æˆ–é‹è¡Œä¸­éƒ½è¡Œ)ï¼ŒContainerå°±å¾é€™ä¸–ä¸Šæ¶ˆå¤±äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm CONTAINER</span><br></pre></td></tr></table></figure><ul><li><code>--force, -f</code> : å¼·åˆ¶ç§»é™¤</li><li><code>--link, -l</code> ç§»é™¤ç‰¹å®šé€£çµ</li><li><code>--volumnes, -v</code> ç§»é™¤æ›è¼‰åœ¨ Container ä¸Šçš„åŒ¿å volumes</li></ul></li><li><p>æš«åœåŸ·è¡Œä¸­çš„ Containerï¼Œ<strong>ä»æš«æœ‰è¨˜æ†¶é«”åœï¼Œæœå‹™ä¸ä¸­æ–·</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pause CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure></li><li><p>æ¢å¾©æš«åœä¸­çš„ Container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker unpause CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure></li><li><p>åœæ­¢åŸ·è¡Œä¸­çš„ Containerï¼Œ<strong>ä½†ä¸æš«æœ‰è¨˜æ†¶é«”ï¼Œæœå‹™ä¸­æ–·</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><ul><li><code>--time, -t</code> å¹¾ç§’å¾Œåœæ­¢ Container</li></ul></li><li><p>å•Ÿå‹•åœæ­¢ä¸­çš„ Container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><ul><li><code>--attach, -a</code> : Attach STDOUT/STDERR and forward signals</li><li><code>--interactive, -i</code>: Attach containerâ€™s STDIN</li></ul></li><li><p>é‡æ–°å•Ÿå‹•Container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><ul><li><code>--time, -t</code>: å¹¾ç§’å¾Œé‡å•Ÿ Container</li></ul></li><li><p>è®“ Container æš«åœç›´åˆ° Container åœæ­¢ç‚ºæ­¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker wait CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure></li><li><p>æ›´å Container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rename CONTAINER NEW_NAME</span><br></pre></td></tr></table></figure></li></ul><h2 id="ç‹€æ…‹"><a class="header-anchor" href="#ç‹€æ…‹"> </a>ç‹€æ…‹</h2><ul><li>inspectï¼šæª¢æŸ¥ Container çš„ç‹€æ…‹</li><li>statsï¼šæŸ¥çœ‹ Container çš„ CPUã€è¨˜æ†¶é«”åŠç¶²è·¯ä½¿ç”¨</li><li>portï¼šæŸ¥çœ‹ Container çš„é€šè¨ŠåŸ ä½¿ç”¨</li><li>psï¼šæŸ¥çœ‹ Container ä½¿ç”¨ç‹€æ…‹<ul><li><code>-a</code> åˆ—å‡ºæ‰€æœ‰çš„ Container</li></ul></li><li>topï¼šæŸ¥çœ‹ Container åœ¨ä¸»ç³»çµ±ä¸­çš„è¨˜æ†¶é«”ä½¿ç”¨</li><li>dpidï¼šæŸ¥çœ‹ Container çš„ pid</li></ul><h2 id="åŸ·è¡Œæ™‚çš„æ“ä½œ"><a class="header-anchor" href="#åŸ·è¡Œæ™‚çš„æ“ä½œ"> </a>åŸ·è¡Œæ™‚çš„æ“ä½œ</h2><ul><li><p>attachï¼šé€£æ¥ Container çš„æ¨™æº–è¼¸å‡ºè¼¸å…¥ç«¯</p><ul><li>ä½¿ç”¨<code>-d</code>æˆ–<code>-id</code>åƒæ•¸ï¼šé›¢é–‹ Container æ™‚è©² Container åœæ­¢ã€‚</li><li>ä½¿ç”¨<code>-td</code>åƒæ•¸ï¼šé›¢é–‹ Container æ™‚è©² Container ç¹¼çºŒåœ¨èƒŒæ™¯ã€‚</li></ul></li><li><p>execï¼šåœ¨å¤–éƒ¨å‘ Container å…§åŸ·è¡ŒæŒ‡ä»¤</p></li><li><p>denterï¼šé€²å…¥ Container</p></li><li><p>logsï¼šå°‡ Container å…§çš„è¼¸å‡ºé¡¯ç¤ºåˆ°è¢å¹•ä¸Š</p></li><li><p>cp: è¤‡è£½æª”æ¡ˆåˆ° Container</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp &#x2F;path&#x2F;to&#x2F;file1 DOCKER_ID:&#x2F;path&#x2F;to&#x2F;file2</span><br></pre></td></tr></table></figure></li></ul><h1 id="Registry-ç›¸é—œ"><a class="header-anchor" href="#Registry-ç›¸é—œ"> </a>Registry ç›¸é—œ</h1><ul><li><p>ç™»å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker login &#x2F;&#x2F; é è¨­æŒ‡å‘ public docker hub</span><br><span class="line">docker loing &lt;ip&gt; &#x2F;&#x2F; ç™»å…¥ç§æœ‰ docker registry</span><br></pre></td></tr></table></figure></li><li><p>ç™»å‡º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logout</span><br></pre></td></tr></table></figure></li><li><p>æœå°‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker search &lt;search word&gt;</span><br><span class="line">&#x2F;&#x2F; æŸ¥è©¢æ˜Ÿæ˜Ÿæ•¸æ¢ä»¶</span><br><span class="line">docker search -s &lt;n start&gt; &lt;search word&gt;</span><br></pre></td></tr></table></figure><ul><li>n æ˜¯é™å®šé ˆæœ‰å¹¾é¡†æ˜Ÿä»¥ä¸Šçš„ image æ‰æœƒè¢«æœå°‹å‡ºä¾†</li></ul></li></ul><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://docs.docker.com/engine/reference/commandline/docker/">docker base command</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä¸Šä¸€ç¯‡æ•´ç†äº†æ¦‚å¿µï¼Œé€™ä¸€ç¯‡ä¾†æ•´ç†å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œé›–ç„¶ä¹Ÿæœ‰ GUI æ“ä½œ docker çš„æœå‹™ï¼Œä½†é€éæŒ‡ä»¤é‚„æ˜¯æ¯”è¼ƒå¿«çš„&lt;/p&gt;</summary>
    
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/categories/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/categories/Container/"/>
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/tags/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>[å®¹å™¨] å®¹å™¨æŠ€è¡“ä¹‹ Docker ç¯‡ - æ¦‚å¿µæ•´ç†</title>
    <link href="http://blog.kevinyang.net/2020/07/30/docker-101-note-1/"/>
    <id>http://blog.kevinyang.net/2020/07/30/docker-101-note-1/</id>
    <published>2020-07-30T05:42:30.000Z</published>
    <updated>2021-03-17T15:14:17.843Z</updated>
    
    <content type="html"><![CDATA[<p>é–ƒé¿å¤šå¹´çš„ä¸»é¡Œï¼Œå®¹å™¨æŠ€è¡“ï¼Œåˆ°æœ€å¾Œé‚„æ˜¯é–ƒä¸åˆ°ï¼Œåªå¥½ä¹–ä¹–çš„é¢å°å®ƒã€‚é¦–å…ˆå…ˆé‡å°æ¯”è¼ƒå¸¸è¦‹çš„å®¹å™¨æŠ€è¡“ Dockerï¼Œå°‡ä¸€äº›æ¯”è¼ƒæ¦‚å¿µæ€§çš„æ±è¥¿æ•´ç†åœ¨é€™é‚Šç­†è¨˜å…§ã€‚</p><span id="more"></span><h1 id="èˆ‡-Virtual-Machine-çš„å·®ç•°"><a class="header-anchor" href="#èˆ‡-Virtual-Machine-çš„å·®ç•°"> </a>èˆ‡ Virtual Machine çš„å·®ç•°</h1><p>Docker èˆ‡è™›æ“¬æ©Ÿå™¨(Virtual Machine)çš„å·®ç•°</p><ul><li>Docker å®¹å™¨èˆ‡å®¹å™¨é–“å…±ç”¨ç›¸åŒçš„ OS Kernelï¼Œè™›æ“¬æ©Ÿå™¨æ˜¯å„è‡ªæ“æœ‰è‡ªå·±çš„ OSï¼Œé€™è¡¨ç¤º Docker Server å¦‚æœæ˜¯è·‘ Linux ç‰ˆæœ¬(é€šå¸¸ä¹Ÿæ˜¯é€™å€‹)ï¼Œå°±ä¸èƒ½è·‘ Windows çš„å®¹å™¨ã€‚è™›æ“¬æ©Ÿå™¨åªæ˜¯å…±ç”¨ç¡¬é«”è³‡æºï¼Œæ‰€ä»¥åœ¨ VM Server ä¸Šå°±å¯ä»¥ä¸¦å­˜ Linux base å’Œ Windows Base</li><li>åœ¨åŒæ¨£çš„ç¡¬é«”è³‡æºä¸‹ï¼ŒDocker å¯ä»¥è·‘æ¯”è¼ƒå¤šå–®ä½</li><li>è¤‡è£½ç’°å¢ƒçš„é€Ÿåº¦ï¼ŒDocker æ¯”è¼ƒå¿«ï¼Œå› ç‚ºå®¹å™¨æ‰€éœ€è¦çš„ Image æ˜¯å¯ä»¥é€éæŒ‡ä»¤çš„æ–¹å¼å¾æŸä¸€å€‹åœ°æ–¹æŠ“ä¸‹ä¾†å°±å¯ä»¥åŸ·è¡Œï¼Œè€Œ VM ä¹Ÿæ˜¯å¯ä»¥åšåˆ°ï¼Œä½†å› ç‚º VM çš„æª”æ¡ˆæ¯”è¼ƒå¤§ï¼Œæ¬ç§»éœ€è¦æ¯”è¼ƒé•·çš„æ™‚é–“</li></ul><p><img src="1_gVNbunchCV5wXgnwlT-iGg.jpeg" alt="1_gVNbunchCV5wXgnwlT-iGg"></p><h1 id="æ¦‚å¿µ"><a class="header-anchor" href="#æ¦‚å¿µ"> </a>æ¦‚å¿µ</h1><h2 id="åè©"><a class="header-anchor" href="#åè©"> </a>åè©</h2><ul><li>Image: é€é <code>dockerfile</code> ç·¨è­¯å‡ºä¾†çš„ Imageï¼Œå”¯ç¨å±¬æ€§ï¼Œå°±æƒ³æˆä»–æ˜¯ä¸€ç‰‡ CD</li><li>Container: åŸ·è¡Œ Image çš„å®¹å™¨ï¼Œå°±åƒ CD-ROMï¼Œä¸€å€‹ Image å¯ä»¥å‰µé€ å‡ºå¾ˆå¤š Containerï¼ŒContainer å…·æœ‰è®€å¯«çš„èƒ½åŠ›ï¼Œä½†ç”±æ–¼ Image æ˜¯å”¯è®€ï¼Œæ‰€ä»¥è¦æ“ä½œä¿ç•™çš„è³‡æ–™æ‡‰è©²è¦æ”¾åœ¨å¦å¤–ä¸€å€‹åœ°æ–¹, <strong>Volume</strong></li><li>Volume: å¯ä»¥æƒ³æˆå®¹å™¨çš„å¤–æ›ç¡¬ç¢Ÿï¼Œç”¨ä¾†ä¿ç•™è³‡æ–™ä½¿ç”¨</li><li>Registry: æ”¾ Image çš„åœ°æ–¹ï¼Œæœ‰å…¬ç”¨çš„æœå‹™ï¼Œä¾‹å¦‚ Docker Hubï¼Œç•¶ç„¶ä¹Ÿå¯ä»¥è‡ªå·±æ¶</li></ul><h2 id="å®‰è£"><a class="header-anchor" href="#å®‰è£"> </a>å®‰è£</h2><p>Windows 10 çš„é›»è…¦å¯ä»¥å®‰è£ä¸‹è¼‰ <a href="https://www.docker.com/products/docker-desktop">Docker desktop for Windows</a> çš„ç©©å®šç‰ˆï¼Œä½†é ˆå…·æœ‰ Hyper-V çš„åŠŸèƒ½æ‰èƒ½å•Ÿå‹• Docker çš„æœå‹™ã€‚å¦‚æœèƒ½å®‰è£ <a href="https://docs.microsoft.com/zh-tw/windows/wsl/install-win10">WSL 2</a> åŠ <a href="https://www.microsoft.com/zh-tw/p/windows-terminal/9n0dx20hk701">Windows Terminal</a> çš„ï¼Œä¹‹å¾Œçš„æ“ä½œä¸Šæœƒæ›´åŠ å‹å–„</p><p>è‡³æ–¼å…¶ä»–ä½œæ¥­ç³»çµ±çš„å®‰è£æ–¹å¼ï¼Œå®˜ç¶²æˆ–æ˜¯ç¶²è·¯ä¸Šæœ‰å¾ˆå¤šæ–‡ä»¶ï¼Œé€™é‚Šå°±ä¸å¤šè´…è¿°</p><h2 id="ç¶²è·¯"><a class="header-anchor" href="#ç¶²è·¯"> </a>ç¶²è·¯</h2><p><strong>None</strong>: æ²’æœ‰ç¶²è·¯åŠŸèƒ½ï¼Œç°¡å–®èªªå°±æ˜¯ä¸€å€‹æ²’æœ‰ç¶²å¡çš„ Container</p><p><strong>Bridget (Default)</strong>ï¼ŒDocker å…§éƒ¨çš„è™›æ“¬ç¶²è·¯ï¼Œé™¤äº†å¯ä»¥å°å¤–é€£ç·šå¤–ï¼Œä¹Ÿæä¾›å…§éƒ¨å„ Container é–“çš„è¯ç¹«</p><p><img src="bridge_network.jpg" alt="bridge_network"></p><p><strong>Host Mode</strong>: å»ºç«‹èˆ‡ Docker Server Host ä¸€æ¨£ç­‰ç´šçš„ network interface</p><p><img src="none-mode.png" alt="none-mode"></p><p><strong>Container Mode</strong>: Container å…±ç”¨åŒä¸€å€‹ Network Interface</p><p><img src="container-mode.png" alt="container-mode"></p><p><strong>Overlay</strong>: Container å¯ä»¥èˆ‡è·‘åœ¨ä¸åŒ Docker Server ä¸Šçš„ Container åšæºé€šï¼Œé¡ä¼¼ VPN Site to Site çš„æ¦‚å¿µ?</p><h1 id="Overview-æµç¨‹åœ–"><a class="header-anchor" href="#Overview-æµç¨‹åœ–"> </a>Overview æµç¨‹åœ–</h1><p><img src="screen-shot-2020-03-19-at-9.01.25-am.png" alt="screen-shot-2020-03-19-at-9.01.25-am"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;é–ƒé¿å¤šå¹´çš„ä¸»é¡Œï¼Œå®¹å™¨æŠ€è¡“ï¼Œåˆ°æœ€å¾Œé‚„æ˜¯é–ƒä¸åˆ°ï¼Œåªå¥½ä¹–ä¹–çš„é¢å°å®ƒã€‚é¦–å…ˆå…ˆé‡å°æ¯”è¼ƒå¸¸è¦‹çš„å®¹å™¨æŠ€è¡“ Dockerï¼Œå°‡ä¸€äº›æ¯”è¼ƒæ¦‚å¿µæ€§çš„æ±è¥¿æ•´ç†åœ¨é€™é‚Šç­†è¨˜å…§ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/categories/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/categories/Container/"/>
    
    
    <category term="Docker" scheme="http://blog.kevinyang.net/tags/Docker/"/>
    
    <category term="Container" scheme="http://blog.kevinyang.net/tags/Container/"/>
    
  </entry>
  
  <entry>
    <title>[Office] å¦‚ä½•åœ¨ç°¡å ±ä¸Šåšå‡ºåœ“åœ–æ•ˆæœ</title>
    <link href="http://blog.kevinyang.net/2020/07/28/office-ppt-tips-crop-image/"/>
    <id>http://blog.kevinyang.net/2020/07/28/office-ppt-tips-crop-image/</id>
    <published>2020-07-28T06:43:39.000Z</published>
    <updated>2021-03-17T15:14:17.831Z</updated>
    
    <content type="html"><![CDATA[<p>é€™ä¸€å€‹æŠ€å·§æ‡‰è©²å¾ˆå¤šäººéƒ½çŸ¥é“äº†ï¼Œä½†æˆ‘æ˜¯æœ€è¿‘éœ€è¦ç”¨åˆ°æ‰å­¸æœƒçš„ï¼Œä½†ä¸ç®¡æ€æ¨£é‚„æ˜¯åˆ†äº«ä¸€ä¸‹ï¼Œå¦‚ä½•åœ¨ç°¡å ±ä¸Šåšå‡ºåœ“åœ–æ•ˆæœï¼Œè€Œé€™ä¸€å€‹æŠ€å·§é©ç”¨æ–¼ Office PowerPoint èˆ‡ Google ç°¡å ±ï¼Œä»¥ä¸‹æ˜¯æ“ä½œæ­¥é©Ÿã€‚</p><span id="more"></span><h1 id="Office-PowerPoint"><a class="header-anchor" href="#Office-PowerPoint"> </a>Office PowerPoint</h1><ol><li><p>åŠ å…¥ä¸€å¼µåœ–ç‰‡ï¼Œå¯ä»¥ç”¨è¤‡è£½ã€æ‹–æ‹‰ã€æˆ–æ˜¯æ‰‹å‹•åŠ å…¥éƒ½å¯ä»¥</p></li><li><p>é¸æ“‡åœ–ç‰‡ï¼Œé€™æ™‚å€™ä¸Šæ–¹çš„é¸å–®æœƒå¤šå‡ºè·Ÿåœ–ç‰‡ç·¨è¼¯ç›¸é—œçš„é¸é …</p><p><img src="image-20200728144934186.png" alt="image-20200728144934186"></p></li><li><p>é¸æ“‡ã€åœ–ç‰‡æ ¼å¼ã€‘</p><p><img src="image-20200728145014134.png" alt="image-20200728145014134"></p></li><li><p>è£å‰ªçš„åŠŸèƒ½æ˜¯æˆ‘å€‘è¦çš„ï¼Œä½†é€™ä¹‹å‰å…ˆä»‹ç´¹è£å‰ªåŸæœ¬çš„åŠŸèƒ½</p><ol><li><p>å¯ä»¥è£å‰ªæˆ‘å€‘æƒ³è¦çš„åœ–ç‰‡ç¯„åœï¼Œé»é¸ã€è£å‰ªã€‘å¾Œåœ–ç‰‡çš„é‚Šç•Œæœƒé¡¯ç¤ºå¦‚ä¸‹åœ–åœ“åœˆæ¨™ç¤ºèµ·ä¾†çš„æ¨£å¼</p><p><img src="image-20200728145333770.png" alt="image-20200728145333770"></p></li><li><p>é€éç§»å‹•é‚Šéš›ä¾†æ±ºå®šè£å‰ªå¾Œè¦é¡¯ç¤ºçš„ç¯„åœ</p><p><img src="image-20200728145420151.png" alt="image-20200728145420151"></p></li><li><p>ç¢ºå®šå¾Œåªæœƒç•™ä¸‹æ˜äº®çš„éƒ¨åˆ†</p></li></ol></li><li><p>é™¤äº†é è¨­åŠŸèƒ½å¤–ï¼Œã€è£å‰ªã€‘ä¸‹æ–¹çš„ç®­é ­æ‰“é–‹é‚„æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œæœ¬ç¯‡æ–‡ç« çš„åœ“åœ–é¡¯ç¤ºå°±æ˜¯è¦åˆ©ç”¨é€™é‚Šçš„åŠŸèƒ½</p><p><img src="image-20200728145539002.png" alt="image-20200728145539002"></p></li></ol><h2 id="é¡¯ç¤ºåœ“åœ–"><a class="header-anchor" href="#é¡¯ç¤ºåœ“åœ–"> </a>é¡¯ç¤ºåœ“åœ–</h2><ol><li><p>é¸æ“‡è£å‰ªæˆåœ–å½¢ï¼Œé¸æ“‡æ©¢åœ“å½¢ï¼Œ(æ²’æœ‰åœ“å½¢çš„é¸é …)</p><p><img src="image-20200728145657272.png" alt="image-20200728145657272"></p><p><img src="image-20200728145738420.png" alt="image-20200728145738420"></p></li><li><p>è¨­å®šé•·å¯¬æ¯”ä¾‹ç‚º <strong>1 : 1</strong></p><p><img src="image-20200728145813218.png" alt="image-20200728145813218"></p></li><li><p>å®Œæˆåœ“å½¢åœ–ç‰‡çš„é¡¯ç¤º</p><p><img src="image-20200728145845651.png" alt="image-20200728145845651"></p></li></ol><h1 id="Google-ç°¡å ±"><a class="header-anchor" href="#Google-ç°¡å ±"> </a>Google ç°¡å ±</h1><p>åœ¨ Google ç°¡å ±ä¸Šè¦é¡¯ç¤ºåœ“å½¢åœ–ç‰‡çš„æ–¹å¼è·Ÿ PowerPoint æ˜¯ä¸€æ¨£çš„</p><ol><li><p>æ’å…¥åœ–ç‰‡</p><p><img src="image-20200728150019552.png" alt="image-20200728150019552"></p></li><li><p>é¸æ“‡åœ–ç‰‡å¾Œï¼Œæœƒå‡ºç¾ã€è£å‰ªã€‘çš„åœ–ç¤º</p><p><img src="image-20200728150135004.png" alt="image-20200728150135004"></p></li><li><p>é€éæ—é‚Šçš„ç®­é ­é¸å–®ï¼Œé¸æ“‡è¦è£å‰ªçš„åœ–å½¢æ¨£å¼</p><p><img src="image-20200728150215963.png" alt="image-20200728150215963"></p></li><li><p>é€™è£¡è¦ç•™æ„çš„æ˜¯ï¼Œå¦‚æœåœ–ç‰‡çš„é•·å¯¬æ¯”ä¾‹ä¸æ˜¯ 1 : 1 çš„é—œä¿‚æ™‚ï¼Œå°±ä¸æœƒé¡¯ç¤ºæˆåœ“å½¢ï¼Œæ‰€ä»¥è¦è£å‰ªåœ–ç‰‡çš„å°ºå¯¸</p><p><img src="image-20200728150816591.png" alt="image-20200728150816591"></p><p><img src="image-20200728150910331.png" alt="image-20200728150910331"></p></li><li><p>æ‰“å®Œæ”¶å·¥</p></li></ol><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><p>æœ¬æ–‡ç« ä½¿ç”¨çš„åœ–ç‰‡ä¾†æºæ˜¯ Photo by <a href="https://unsplash.com/@vdapinto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Vitor Pinto</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;é€™ä¸€å€‹æŠ€å·§æ‡‰è©²å¾ˆå¤šäººéƒ½çŸ¥é“äº†ï¼Œä½†æˆ‘æ˜¯æœ€è¿‘éœ€è¦ç”¨åˆ°æ‰å­¸æœƒçš„ï¼Œä½†ä¸ç®¡æ€æ¨£é‚„æ˜¯åˆ†äº«ä¸€ä¸‹ï¼Œå¦‚ä½•åœ¨ç°¡å ±ä¸Šåšå‡ºåœ“åœ–æ•ˆæœï¼Œè€Œé€™ä¸€å€‹æŠ€å·§é©ç”¨æ–¼ Office PowerPoint èˆ‡ Google ç°¡å ±ï¼Œä»¥ä¸‹æ˜¯æ“ä½œæ­¥é©Ÿã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="Office" scheme="http://blog.kevinyang.net/categories/Office/"/>
    
    
    <category term="Office" scheme="http://blog.kevinyang.net/tags/Office/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] å¹« moment.js å¥—ä»¶ç˜¦èº«</title>
    <link href="http://blog.kevinyang.net/2020/07/25/angular-moment-localte-is-too-fat/"/>
    <id>http://blog.kevinyang.net/2020/07/25/angular-moment-localte-is-too-fat/</id>
    <published>2020-07-25T04:21:38.000Z</published>
    <updated>2021-03-17T15:14:17.831Z</updated>
    
    <content type="html"><![CDATA[<p>é•·ä¹…ä»¥ä¾†ï¼Œä½¿ç”¨ moment.js é€™ä¸€å€‹æ™‚é–“å¥—ä»¶è®“æˆ‘å¾ˆæ™æ‰ï¼Œç•¢ç«Ÿä»–å¾ˆå¥½ç”¨ä½†å¾ˆè‚¥ï¼Œä¸»è¦è‚¥èƒ–çš„åœ°æ–¹éƒ½æ˜¯ä¸€å †ç”¨ä¸åˆ°çš„ locale.</p><p>ä»Šå¤©çµ‚æ–¼ä¸‹å®šæ±ºå¿ƒè¦ä¾†è§£æ±ºé€™å€‹å•é¡Œï¼Œç¶“éå…©åˆ†é˜çš„æœå°‹å¾Œï¼Œä»¥ä¸‹æ˜¯è§£æ³•</p><span id="more"></span><ol><li>åœ¨ <code>src</code> è³‡æ–™å¤¾ä¸‹å»ºç«‹ä¸€å€‹ locale ç©ºçš„è³‡æ–™å¤¾</li><li>åœ¨ <code>angular.json</code> çš„ <code>fileReplacements</code> å…§å¤šæ–°å¢ä¸‹é¢è¨­å®š</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;replace&quot;</span>: <span class="string">&quot;node_modules/moment/locale/&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;with&quot;</span>: <span class="string">&quot;src/locale/&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç•¶é€™æ¨£å­è¨­å®šå®Œæˆå¾Œï¼Œng build --prod æ™‚æœƒå‡ºç¾ <code>\moment\locale\af.js&quot; does not exist.</code> æ‰¾ä¸åˆ°çš„éŒ¯èª¤è¨Šæ¯ï¼Œæ²’é—œä¿‚é€™å€‹ä¸æœƒå½±éŸ¿åˆ°æˆ‘å€‘çš„ç¨‹å¼åŸ·è¡Œã€‚</p><p>ç¶“éé€™æ¨£å­çš„èª¿æ•´å¾Œï¼Œæ•´å€‹ moment locale çš„éƒ¨åˆ†å°±æœƒè¢«æ‹”æ‰ï¼Œç¬é–“ç˜¦äº†å¿« 400kb çš„å¤§å°ï¼Œå¯ä»¥ç®—æ˜¯ç˜¦èº«æˆåŠŸ</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;é•·ä¹…ä»¥ä¾†ï¼Œä½¿ç”¨ moment.js é€™ä¸€å€‹æ™‚é–“å¥—ä»¶è®“æˆ‘å¾ˆæ™æ‰ï¼Œç•¢ç«Ÿä»–å¾ˆå¥½ç”¨ä½†å¾ˆè‚¥ï¼Œä¸»è¦è‚¥èƒ–çš„åœ°æ–¹éƒ½æ˜¯ä¸€å †ç”¨ä¸åˆ°çš„ locale.&lt;/p&gt;
&lt;p&gt;ä»Šå¤©çµ‚æ–¼ä¸‹å®šæ±ºå¿ƒè¦ä¾†è§£æ±ºé€™å€‹å•é¡Œï¼Œç¶“éå…©åˆ†é˜çš„æœå°‹å¾Œï¼Œä»¥ä¸‹æ˜¯è§£æ³•&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[.NET Core] ä½¿ç”¨ Azure Key Vault æœå‹™ä¾†ç®¡ç†ç°½ç« ç”¨çš„é‡‘é‘°</title>
    <link href="http://blog.kevinyang.net/2020/06/22/azure-keyVault-sign-with-rsa/"/>
    <id>http://blog.kevinyang.net/2020/06/22/azure-keyVault-sign-with-rsa/</id>
    <published>2020-06-22T13:16:41.000Z</published>
    <updated>2021-03-17T15:14:17.831Z</updated>
    
    <content type="html"><![CDATA[<p>è¦ä½¿ç”¨ RSA Private Key ä¾†åšè³‡æ–™ç°½ç« è¡¨ç¤ºæˆ‘å€‘éœ€è¦å°‡ Private Key å­˜æ”¾åœ¨æŸä¸€å€‹åœ°æ–¹ï¼Œä½†çµ•å°ä¸æœƒåœ¨ç¨‹å¼çš„åƒæ•¸è¨­å®šæª”å…§ï¼Œå…¶å¯¦åœ¨ <a href="http://ASP.NET">ASP.NET</a> Core å…§æä¾›å¾ˆå¤šæ–¹æ³•å¯ä»¥å­˜æ”¾è¨­å®šæª”ï¼Œä¾‹å¦‚ä½¿ç”¨ user secretï¼Œæ›´å¤šè³‡è¨Šå¯ä»¥åƒé–±<a href="https://docs.microsoft.com/zh-tw/aspnet/core/security/app-secrets?view=aspnetcore-3.1">æ­¤æ–‡ä»¶</a>ã€‚</p><p>Azure ä¸Šé¢ä¹Ÿæœ‰ä¸€å€‹ Azure Key Vault çš„æœå‹™ï¼Œå¯ä»¥é›†ä¸­ç®¡ç†ç›¸é—œçš„é‡‘é‘° (Keys)ã€ç§˜å¯† (Secret)ã€æ†‘è­‰ (Certificate) ç­‰è³‡è¨Šï¼Œè€Œç›¸é—œçš„æœå‹™å°±å¯ä»¥é€£ç·šåˆ°é€™ä¸€å€‹ Key Vault æœå‹™å–å¾—ç›¸é—œçš„è³‡è¨Šåšé€²ä¸€æ­¥çš„ä½¿ç”¨ï¼Œä¾‹å¦‚åŠ è§£å¯†ç­‰ä½œæ¥­</p><span id="more"></span><h1 id="ç§˜å¯†-Secret"><a class="header-anchor" href="#ç§˜å¯†-Secret"> </a>ç§˜å¯† (Secret)</h1><p>åœ¨ä¸€å€‹ç¶²ç«™æœƒæœ‰ä¸€äº›è¨­å®šæª”æœƒå› ç‚ºéƒ¨å±¬ç’°å¢ƒè€Œæ‰€ç•°å‹•ï¼Œé€™ä¸€é¡çš„è¨­å®šç•¶ç„¶ä¸å¯èƒ½å¯«æ­»åœ¨ç¨‹å¼è£¡ï¼Œæ‰€ä»¥æœƒå°‡é€™ä¸€é¡çš„è¨­å®šæª”æ”¾åœ¨æŸä¸€å€‹è¨­å®šæª”é¡ï¼Œä¾‹å¦‚ appsettings.json æˆ–æ˜¯ user secret ç­‰åœ°æ–¹ï¼Œè€Œåƒè³‡æ–™åº«é€£ç·šé€™ç¨®è³‡æ–™æ•æ„Ÿçš„è³‡æ–™ï¼Œå­˜æ”¾åœ¨ appsettings.json å…§å°±ååˆ†å±éšªï¼Œæœƒå»ºè­°æ”¾åœ¨ç‰ˆæ§ä»¥å¤–çš„åœ°æ–¹æˆ–æ˜¯ Hosting çš„ä¸»æ©Ÿä¸Šï¼Œä¾‹å¦‚ Azure App Service å°±æœ‰æä¾›è¨­å®šç’°å¢ƒåƒæ•¸çš„åœ°æ–¹ã€‚</p><p><img src="image-20200622213144659.png" alt="image-20200622213144659"></p><p>ä½†å¦‚æœåŒæ¨£çš„è³‡è¨Šå‡ºç¾åœ¨ä¸åŒçš„ç¨‹å¼è£¡ï¼Œåˆ†åˆ¥è¨­å®šå°±è®Šå¾—ååˆ†ä¸åˆé©äº†ï¼Œé€™æ™‚å€™ä½¿ç”¨ Azure Key Vault æœå‹™å°±æœƒæ˜¯å€‹ä¸éŒ¯çš„é¸æ“‡ï¼Œä½†é€™é‚Šå°±ä¸å¤šèªªæ˜å¦‚ä½•å»ºç«‹ Azure Key Vault çš„æ­¥é©Ÿäº†ï¼Œç›¸é—œè³‡è¨Šå¯ä»¥ä¸Šç¶²æ‰¾ä¸€ä¸‹ï¼Œæ‡‰è©²è »å¤šçš„</p><p>ç•¶ Azure Key Vault è¨­å®šå¥½æ™‚ï¼Œç‚ºäº†è¦è®“ç¶²ç«™ (<a href="http://ASP.NET">ASP.NET</a> Core MVC) å¯ä»¥å°‡ Key Vault ä¸Šæ‰€è¨­å®šçš„ Secret è³‡è¨Šè®€è¿‘ä¾†ï¼Œé‚„éœ€è¦ä»¥ä¸‹æœ‰å¹¾å€‹æ­¥é©Ÿ</p><ol><li><p>åœ¨ Azure Active Directory ä¸‹è¨»å†Šæ‡‰ç”¨ç¨‹å¼</p><p><img src="image-20200622213613127.png" alt="image-20200622213613127"></p></li><li><p>è¨»å†Šå®Œæˆå¾Œï¼Œåˆ°è©²æ‡‰ç”¨ç¨‹å¼ä¸‹çš„ã€æ†‘è­‰èˆ‡ç§˜å¯†ã€‘ï¼Œæ–°å¢ ã€ç”¨æˆ¶ç«¯å¯†ç¢¼ã€‘</p><ol><li>é€™é‚Šéœ€è¦è¨˜ä¸‹å…©å€‹è³‡è¨Šï¼Œåˆ†åˆ¥æ˜¯ ã€æ‡‰ç”¨ç¨‹å¼ (ç”¨æˆ¶ç«¯) è­˜åˆ¥ç¢¼ã€‘èˆ‡ ã€ç”¨æˆ¶ç«¯å¯†ç¢¼çš„å€¼ã€‘</li><li>é€™é‚Šå¦‚æœä¸æƒ³è¦ä½¿ç”¨ç”¨æˆ¶ç«¯å¯†ç¢¼çš„ï¼Œå¯ä»¥ä½¿ç”¨æ†‘è­‰çš„æ–¹å¼</li></ol></li><li><p>å›åˆ° Azure Key Vault çš„æœå‹™å…§ï¼Œæˆæ¬Šæ‡‰ç”¨ç¨‹å¼å¯ä»¥å­˜å– Key Vault</p><p><img src="SNAGHTML2126530-1592833176303.PNG" alt="img"></p><ol start="4"><li><p>æ–°å¢å­˜å–åŸå‰‡</p><p><img src="image-20200622214050780.png" alt="image-20200622214050780"></p><ul><li>è¨­å®šç›¸é—œçš„æ¬Šé™</li><li>é¸æ“‡å¥—ç”¨çš„ä¸»é«”ï¼Œé€™é‚Šæ˜¯æŒ‡å‰›å‰›æ‰€è¨»å†Šçš„æ‡‰ç”¨ç¨‹å¼</li></ul></li><li><p>å®Œæˆæ–°å¢å‹•ä½œ</p></li></ol><p>åˆ°é€™é‚Šï¼Œå°±å·²ç¶“å®Œæˆç›¸é—œæ¬Šé™è¨­å®šçš„éƒ¨åˆ†ï¼Œæ¥ä¸‹ä¾†å°±æ˜¯ç¨‹å¼ç«¯çš„è¨­å®š</p><h2 id="ç¨‹å¼"><a class="header-anchor" href="#ç¨‹å¼"> </a>ç¨‹å¼</h2><ol><li><p>éœ€è¦å®‰è£ä»¥ä¸‹å¥—ä»¶</p><ol><li><a href="https://www.nuget.org/packages/Microsoft.Azure.Services.AppAuthentication">Microsoft.Azure.Services.AppAuthentication</a></li><li><a href="https://www.nuget.org/packages/Microsoft.Azure.KeyVault">Microsoft.Azure.KeyVault</a></li><li><a href="https://www.nuget.org/packages/Microsoft.Extensions.Configuration.AzureKeyVault/">Microsoft.Extensions.Configuration.AzureKeyVault</a></li></ol></li><li><p>åœ¨ appsettings.json çš„åœ°æ–¹æ–°å¢æ­¤è³‡è¨Š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;KeyVault&quot;: &#123;</span><br><span class="line">  &quot;Vault&quot;: &quot;xxx&quot;,</span><br><span class="line">  &quot;ClientId&quot;: &quot;xxx&quot;,</span><br><span class="line">  &quot;ClientSecret&quot;: &quot;xxx&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>ç•¶ç„¶é€™é‚Šçš„ <code>ClientId</code> å’Œ <code>ClientSecret</code> æœƒæ”¾åœ¨ <code>User secret</code> ä¸‹ï¼Œè€Œä¸æœƒæ˜¯ <code>appsettings.json</code> å…§</p></li><li><p>åœ¨ <code>Program.cs</code> çš„åœ°æ–¹åšå‡ºä»¥ä¸‹èª¿æ•´</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IHostBuilder <span class="title">CreateHostBuilder</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span> =&gt;</span><br><span class="line">            Host.CreateDefaultBuilder(args)</span><br><span class="line">                .ConfigureAppConfiguration((ctx, builder) =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// æ–°å¢éƒ¨åˆ†</span></span><br><span class="line">                    <span class="keyword">var</span> builtConfig = builder.Build();</span><br><span class="line">                    <span class="keyword">var</span> keyVaultEndpoint = GetKeyVaultEndpoint(builtConfig[<span class="string">&quot;KeyVault:Vault&quot;</span>]);</span><br><span class="line">                    <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(keyVaultEndpoint))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> azureServiceTokenProvider = <span class="keyword">new</span> AzureServiceTokenProvider();</span><br><span class="line">                        <span class="keyword">var</span> keyVaultClient = <span class="keyword">new</span> KeyVaultClient(</span><br><span class="line">                            <span class="keyword">new</span> KeyVaultClient.AuthenticationCallback(</span><br><span class="line">                                azureServiceTokenProvider.KeyVaultTokenCallback));</span><br><span class="line">                        builder.AddAzureKeyVault(</span><br><span class="line">                            keyVaultEndpoint, keyVaultClient, <span class="keyword">new</span> DefaultKeyVaultSecretManager());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)                </span><br><span class="line">                .ConfigureWebHostDefaults(webBuilder =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    webBuilder.UseStartup&lt;Startup&gt;();</span><br><span class="line">                &#125;);</span><br><span class="line">   <span class="comment">// æ–°å¢éƒ¨åˆ†</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetKeyVaultEndpoint</span>(<span class="params"><span class="built_in">string</span> VAULT_NAME</span>)</span> =&gt; <span class="string">$&quot;https://<span class="subst">&#123;VAULT_NAME&#125;</span>.vault.azure.net/&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p>ç•¶å®Œæˆé€™ä¿®æ”¹å¾Œï¼Œ.NET Core MVC å°±æœƒå„ªå…ˆå¾ Azure Key Vault è£¡å–å¾— secret è³‡æ–™ï¼Œè®€å–çš„æ–¹å¼èˆ‡å…¶ä»–åƒæ•¸è¨­å®šå–æ³•æ˜¯ä¸€æ¨£çš„</p></li></ol></li></ol><h1 id="é‡‘é‘°-Keys"><a class="header-anchor" href="#é‡‘é‘°-Keys"> </a>é‡‘é‘° (Keys)</h1><p>è‡³æ–¼é‡‘é‘°çš„å–æ³•å°±æ¯”è¼ƒç‰¹æ®Šé»ï¼Œéœ€è¦é€é <code>KeyVaultClient</code> çš„æ–¹å¼ä¾†å–å¾—ï¼Œè€Œä¸”ä¹Ÿåªèƒ½å–å¾—å…¬é–‹é‡‘é‘°çš„éƒ¨åˆ†ï¼Œç§æœ‰é‡‘é‘°è¦åšçš„äº‹æƒ…ï¼Œå‰‡æœƒé€é <code>KeyVaultClient</code> ä¾†å®Œæˆã€‚</p><p>è¦å»ºç«‹ <code>KeyVaultClient</code> çš„æ–¹æ³•å¦‚ä¸‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> KeyVaultClient <span class="title">GetClient</span>(<span class="params"></span>)</span> =&gt; <span class="keyword">new</span> KeyVaultClient(<span class="keyword">new</span> KeyVaultClient.AuthenticationCallback(<span class="keyword">async</span> (<span class="built_in">string</span> authority, <span class="built_in">string</span> resource, <span class="built_in">string</span> scope) =&gt;</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">var</span> context = <span class="keyword">new</span> AuthenticationContext(authority, TokenCache.DefaultShared);</span><br><span class="line">           ClientCredential clientCred = <span class="keyword">new</span> ClientCredential(configuration[<span class="string">&quot;KeyVault:ClientId&quot;</span>], configuration[<span class="string">&quot;KeyVault:ClientSecret&quot;</span>]);</span><br><span class="line">           <span class="keyword">var</span> authResult = <span class="keyword">await</span> context.AcquireTokenAsync(resource, clientCred);</span><br><span class="line">           <span class="keyword">return</span> authResult.AccessToken;</span><br><span class="line">       &#125;));</span><br></pre></td></tr></table></figure><p>åŸ·è¡Œ <code>GetClient()</code> å°±å¯ä»¥å–å¾— KeyVaultClientï¼Œç•¶å–å¾— client å¾Œï¼Œå°±å¯ä»¥å–å¾—æˆ‘å€‘æƒ³è¦çš„é‡‘é‘°ï¼Œä½†é€™é‚Šæœ€ç°¡å–®çš„æ–¹å¼æ˜¯é€éé‡‘é‘°çš„è­˜åˆ¥ç¢¼</p><p><img src="image-20200622220559893.png" alt="image-20200622220559893"></p><p><img src="image-20200622225114968.png" alt="image-20200622225114968"></p><p><img src="image-20200622220802801.png" alt="image-20200622220802801"></p><p>é€™é‚Šçš„ã€é‡‘é‘°è­˜åˆ¥ç¢¼ã€‘å°±æ˜¯æˆ‘å€‘ç­‰ç­‰è¦ç”¨çš„è³‡è¨Šï¼Œå…ˆè¨˜èµ·ä¾†ï¼Œç›¸é—œçš„ç¨‹å¼ç¢¼æœƒé€™æ¨£å­å¯«ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> KeyId = <span class="string">&quot;xxx&quot;</span>; <span class="comment">// é‡‘é‘°è­˜åˆ¥ç¢¼</span></span><br><span class="line"><span class="keyword">var</span> client = GetClient();</span><br><span class="line"><span class="keyword">var</span> hostKey = <span class="keyword">await</span> client.GetKeyAsync(KeyId);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å–å¾— Public Key </span></span><br><span class="line"><span class="keyword">var</span> rsa = hostkye.Key.ToRSA();</span><br><span class="line"><span class="keyword">var</span> publicKey = rsa.ToXmlString(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°½ç« </span></span><br><span class="line"><span class="keyword">var</span> hasher = <span class="keyword">new</span> SHA256CryptoServiceProvider();</span><br><span class="line"><span class="keyword">var</span> digest = hasher.ComputeHash(data_buffer);</span><br><span class="line"><span class="keyword">var</span> result = <span class="keyword">await</span> client.SignAsync(KeyId, <span class="string">&quot;RS256&quot;</span>, digest);</span><br><span class="line"><span class="built_in">byte</span>[] sign_buffer = result.Result;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é©—è­‰ç°½ç« </span></span><br><span class="line"><span class="keyword">var</span> sign_buffer = sign_getFromSomeWhere();</span><br><span class="line"><span class="keyword">var</span> data_buffer = data_getFromSomeWhere();</span><br><span class="line"><span class="keyword">var</span> rsa = <span class="keyword">new</span> RSACryptoServiceProvider();</span><br><span class="line">rsa.FromXmlString(publicKey);</span><br><span class="line"><span class="keyword">var</span> hasher = <span class="keyword">new</span> SHA256CryptoServiceProvider();</span><br><span class="line"><span class="keyword">var</span> digest = hasher.ComputeHash(data_buffer);</span><br><span class="line"><span class="keyword">var</span> isVerfy = rsa.VerifyHash(digest, <span class="string">&quot;Sha256&quot;</span>, sign_buffer);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ°é€™è£¡åŸºæœ¬ä¸Šå°±æ˜¯ä¸€äº› KeyVaultClient çš„æ“ä½œï¼Œç•¶ç„¶é‚„æœ‰å…¶ä»–æ›´ç´°ç¯€çš„æ±è¥¿ï¼Œå¯èƒ½å°±è¦ç­‰æˆ‘ä¹‹å¾Œæœ‰ç©æ›´æ·±å…¥æ™‚ï¼Œæ‰èƒ½åˆ†äº«äº†</p><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://azure.microsoft.com/zh-tw/services/key-vault/">Azure Key Vault</a></li><li><a href="https://www.youtube.com/watch?v=PgujSug1ZbI">Azure Key Vault Tutorial | Secure secrets, keys and certificates easily</a></li><li><a href="https://docs.microsoft.com/zh-tw/aspnet/core/security/key-vault-configuration?view=aspnetcore-3.1">ASP.NET Core ä¸­çš„ Azure Key Vault è¨­å®šæä¾›è€…</a></li><li><a href="https://dotblogs.com.tw/tom5707/2018/05/07/004419">[ASP.NET Core] ä½¿ç”¨User Secretå®‰å…¨å­˜æ”¾é–‹ç™¼æ‡‰ç”¨ç¨‹å¼å¯†é‘°(VS 2017)</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;è¦ä½¿ç”¨ RSA Private Key ä¾†åšè³‡æ–™ç°½ç« è¡¨ç¤ºæˆ‘å€‘éœ€è¦å°‡ Private Key å­˜æ”¾åœ¨æŸä¸€å€‹åœ°æ–¹ï¼Œä½†çµ•å°ä¸æœƒåœ¨ç¨‹å¼çš„åƒæ•¸è¨­å®šæª”å…§ï¼Œå…¶å¯¦åœ¨ &lt;a href=&quot;http://ASP.NET&quot;&gt;ASP.NET&lt;/a&gt; Core å…§æä¾›å¾ˆå¤šæ–¹æ³•å¯ä»¥å­˜æ”¾è¨­å®šæª”ï¼Œä¾‹å¦‚ä½¿ç”¨ user secretï¼Œæ›´å¤šè³‡è¨Šå¯ä»¥åƒé–±&lt;a href=&quot;https://docs.microsoft.com/zh-tw/aspnet/core/security/app-secrets?view=aspnetcore-3.1&quot;&gt;æ­¤æ–‡ä»¶&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Azure ä¸Šé¢ä¹Ÿæœ‰ä¸€å€‹ Azure Key Vault çš„æœå‹™ï¼Œå¯ä»¥é›†ä¸­ç®¡ç†ç›¸é—œçš„é‡‘é‘° (Keys)ã€ç§˜å¯† (Secret)ã€æ†‘è­‰ (Certificate) ç­‰è³‡è¨Šï¼Œè€Œç›¸é—œçš„æœå‹™å°±å¯ä»¥é€£ç·šåˆ°é€™ä¸€å€‹ Key Vault æœå‹™å–å¾—ç›¸é—œçš„è³‡è¨Šåšé€²ä¸€æ­¥çš„ä½¿ç”¨ï¼Œä¾‹å¦‚åŠ è§£å¯†ç­‰ä½œæ¥­&lt;/p&gt;</summary>
    
    
    
    <category term="Azure" scheme="http://blog.kevinyang.net/categories/Azure/"/>
    
    <category term=".NET Core" scheme="http://blog.kevinyang.net/categories/NET-Core/"/>
    
    
    <category term="Azure" scheme="http://blog.kevinyang.net/tags/Azure/"/>
    
    <category term=".NET Core" scheme="http://blog.kevinyang.net/tags/NET-Core/"/>
    
  </entry>
  
  <entry>
    <title>[Azure] å°‡ Angular ç¶²ç«™æ”¾åœ¨ App Service Linux Version ä¸Š</title>
    <link href="http://blog.kevinyang.net/2020/06/15/azure-app-service-linux-angular/"/>
    <id>http://blog.kevinyang.net/2020/06/15/azure-app-service-linux-angular/</id>
    <published>2020-06-15T11:51:01.000Z</published>
    <updated>2021-03-17T15:14:17.831Z</updated>
    
    <content type="html"><![CDATA[<p>è¦å°‡ Angular æ”¾åœ¨ Azure ä¸Šé¢çš„æ–¹æ³•æœ‰å¾ˆå¤šç¨®ï¼Œè€Œä»Šå¤©è¦ä»‹ç´¹çš„æ˜¯å…¶ä¸­ä¸€ç¨®ï¼ŒApp Service(Linux Version)</p><span id="more"></span><p>åœ¨ Azure ä¸Šé¢ï¼Œä½¿ç”¨ Linux ç‰ˆæœ¬çš„åƒ¹éŒ¢å¯ä»¥æ¯” Windows ç‰ˆæœ¬ä¾¿å®œè¨±å¤šï¼Œä½†å¦‚æœæƒ³è¦æ”¾éœæ…‹ç¶²ç«™æ™‚åˆè©²æ€éº¼å‘¢? å…¶å¯¦å¯ä»¥ç°¡å–®é€é npm ä¸Šé¢çš„ä¸€å€‹å¥—ä»¶ <a href="https://www.npmjs.com/package/serve">serve</a> ä¾†å®Œæˆï¼Œé€™æ¨£å°±ä¸ç”¨è‡ªå·±å¯«ä¸€å€‹ Http Serverã€‚ä½†å¦‚æœæ˜¯è¦çµ¦ Production ç’°å¢ƒä½¿ç”¨ï¼Œé‚„æ˜¯å»ºè­°ä½¿ç”¨æ­£çµ±çš„ http server å¯«æ³•</p><p>åœ¨ App Service ä¸Šé¢å¯ä»¥é€™æ¨£å­è¨­å®š</p><p><img src="image-20200615211052044.png" alt="image-20200615211052044"></p><p>å¯ä»¥é€éå•Ÿå‹•æŒ‡ä»¤çš„æ–¹å¼ä¾†å•Ÿå‹•æˆ‘å€‘æƒ³è¦åŸ·è¡Œçš„ç¨‹å¼ï¼Œæ‰€ä»¥å¦‚æœæ˜¯ node epxress çš„æƒ…æ³ä¸‹ï¼Œå°±æœƒæ˜¯ <code>node ./index.js </code> ä¹‹é¡çš„</p><p>è€Œéƒ¨å±¬çš„å‹•ä½œå°±å°‡ Angular build å‡ºçš„å°ˆæ¡ˆè³‡æ–™å¤¾å…§çš„æª”æ¡ˆä¸Šå‚³åˆ° App Service å³å¯</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;è¦å°‡ Angular æ”¾åœ¨ Azure ä¸Šé¢çš„æ–¹æ³•æœ‰å¾ˆå¤šç¨®ï¼Œè€Œä»Šå¤©è¦ä»‹ç´¹çš„æ˜¯å…¶ä¸­ä¸€ç¨®ï¼ŒApp Service(Linux Version)&lt;/p&gt;</summary>
    
    
    
    <category term="Azure" scheme="http://blog.kevinyang.net/categories/Azure/"/>
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Azure" scheme="http://blog.kevinyang.net/tags/Azure/"/>
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] Angular FormGroup Value ä¹‹è¢«å¿½ç•¥çš„ç´°ç¯€</title>
    <link href="http://blog.kevinyang.net/2020/05/06/angular-formgroup-value/"/>
    <id>http://blog.kevinyang.net/2020/05/06/angular-formgroup-value/</id>
    <published>2020-05-06T07:57:13.000Z</published>
    <updated>2021-03-17T15:14:17.831Z</updated>
    
    <content type="html"><![CDATA[<p>ç•¶åœ¨æ“ä½œ Angular  è¡¨å–®æ™‚ï¼Œæ–¼æœ€å¾Œé€å‡ºè¡¨å–®è³‡æ–™åˆ° API æ™‚ï¼Œå¸¸è¦‹çš„ä½¿ç”¨æ–¹æ³•ç‚º <code>formGroup.value</code> æˆ–æ˜¯ <code>formGroup.getRawValue()</code> å…©ç¨®æ–¹æ³•ï¼Œé—œæ–¼ <code>getRawValue()</code> å¤§æ¦‚ä¹Ÿä¸ç”¨å¤šè´…è¿°äº†ã€‚ä½†ä½ çŸ¥é“ <code>FormGroup</code> çš„ value å–å¾—è³‡æ–™çš„è¦å‰‡å— ?</p><span id="more"></span><h1 id="FormGroup-value"><a class="header-anchor" href="#FormGroup-value"> </a>FormGroup.value</h1><p>ä¸€èˆ¬ä¾†èªªï¼Œ<code>FormGroup</code> çš„ value æœƒå°‡è©²ç¾¤çµ„ä¸‹çš„æ§åˆ¶é …è³‡æ–™å–å‡ºï¼Œå¦‚ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">formData1 = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(<span class="string">&quot;Kevin&quot;</span>),</span><br><span class="line">    lastName: <span class="keyword">new</span> FormControl(<span class="string">&quot;Yang&quot;</span>),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(formData1.value); <span class="comment">// &#123;firstName: &#x27;Kevin&#x27;, lastName: &#x27;Yang&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>è€Œç¬¬ä¸€å€‹æ–°æ‰‹å¸¸æœƒè¸©åˆ°çš„é›·ï¼Œæœƒé€™é‡åˆ° <code>FormControl</code> ç‹€æ…‹æ˜¯ <code>Disabed</code> æ™‚ï¼Œ<code>FormGroup</code> å–å‡ºçš„å€¼å°±ä¸æœƒæ˜¯å…¨éƒ¨äº†</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">formData1 = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(&#123;<span class="attr">value</span>:<span class="string">&quot;Kevin&quot;</span>, <span class="attr">disabled</span>: <span class="literal">true</span>&#125;),</span><br><span class="line">    lastName: <span class="keyword">new</span> FormControl(<span class="string">&quot;Yang&quot;</span>),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(formData1.value); <span class="comment">// &#123;lastName: &#x27;Yang&#x27;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(formData1.getRawValue()); <span class="comment">// &#123;firstName: &#x27;Kevin&#x27;, lastName: &#x27;Yang&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>å®˜æ–¹æ–‡ä»¶èªªæ˜</p><blockquote><p>For an enabled <code>FormGroup</code>, the values of enabled controls as an object with a key-value pair for each member of the group.</p></blockquote><p>åˆ°é€™é‚Šéƒ½é‚„ç®—æ­£å¸¸ï¼Œä½†ä½ çŸ¥é“ç•¶ <code>FormGroup</code> ç‹€æ…‹ç‚º <code>Disabled</code> æ™‚ï¼Œå°±æœƒå–å‡ºæ‰€æœ‰æ§åˆ¶é …çš„å€¼å—?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">formData1 = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(&#123;<span class="attr">value</span>:<span class="string">&quot;Kevin&quot;</span>, <span class="attr">disabled</span>: <span class="literal">true</span>&#125;),</span><br><span class="line">    lastName: <span class="keyword">new</span> FormControl(<span class="string">&quot;Yang&quot;</span>),</span><br><span class="line">&#125;);</span><br><span class="line">formData1.disable();</span><br><span class="line"><span class="built_in">console</span>.log(formData1.value); <span class="comment">// &#123;firstName: &#x27;Kevin&#x27;, lastName: &#x27;Yang&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ“šå®˜ç¶²çš„èªªæ˜</p><blockquote><p>For a disabled <code>FormGroup</code>, the values of all controls as an object with a key-value pair for each member of the group.</p></blockquote><p>ä½†å¦‚æœæ˜¯é€™æ¨£å­çš„çµæ§‹ï¼Œæœƒå–å¾—æ€æ¨£çš„å€¼å‘¢?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">formData1 = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(&#123;<span class="attr">value</span>:<span class="string">&quot;Kevin&quot;</span>, <span class="attr">disabled</span>: <span class="literal">true</span>&#125;),    </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(formData1.value); <span class="comment">// ??</span></span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬äº”è¡Œæœƒé¡¯ç¤º <code>&#123;firstName: 'Kevin'&#125;</code>ï¼Œé€™æ˜¯ä¸€ä»¶æˆ‘å‰›é–‹å§‹ä¹Ÿè¦ºå¾—å¾ˆå›°æƒ‘çš„ç¾è±¡ï¼Œç‚ºä»€éº¼æ˜æ˜ <code>FormControl</code> æ˜¯ <code>disabled</code>  çš„ç‹€æ…‹ï¼Œä½†ç‚ºä»€éº¼é‚„èƒ½å–å¾—å‘¢?</p><h2 id="åŸå§‹ç¢¼è§£æ"><a class="header-anchor" href="#åŸå§‹ç¢¼è§£æ"> </a>åŸå§‹ç¢¼è§£æ</h2><p>åœ¨ <code>FormGroup</code>  class å…§æœ‰ä¸€å€‹æ–¹æ³•æ˜¯åœ¨åˆ¤æ–·ç›®å‰ <code>FormGroup</code> ä¸‹çš„æ§åˆ¶é …æ˜¯å¦å…¨éƒ¨ç‚º <code>Disabled</code> ï¼Œå¦‚æœæ˜¯è‡ªå·±æœ¬èº«çš„ç‹€æ…‹ä¹Ÿæœƒè¢«è¨­å®šç‚º <code>Disabled</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> _allControlsDisabled(): <span class="built_in">boolean</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> controlName <span class="keyword">of</span> <span class="built_in">Object</span>.keys(<span class="built_in">this</span>.controls)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.controls[controlName].enabled) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.keys(<span class="built_in">this</span>.controls).length &gt; <span class="number">0</span> || <span class="built_in">this</span>.disabled;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://github.com/angular/angular/blob/master/packages/forms/src/model.ts#L1631-L1638">source code</a></li></ul><p>å› ç‚ºé€™ä¸€å€‹é—œä¿‚ï¼Œä¸Šé¢é‚£ä¸€å€‹å•é¡Œå°±æœƒä½¿ç”¨ <code>FormGroup</code> ç‚º Disabled æ™‚çš„è¦å‰‡é‹è¡Œ</p><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://angular.io/api/forms/AbstractControl#properties">Angular API</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;ç•¶åœ¨æ“ä½œ Angular  è¡¨å–®æ™‚ï¼Œæ–¼æœ€å¾Œé€å‡ºè¡¨å–®è³‡æ–™åˆ° API æ™‚ï¼Œå¸¸è¦‹çš„ä½¿ç”¨æ–¹æ³•ç‚º &lt;code&gt;formGroup.value&lt;/code&gt; æˆ–æ˜¯ &lt;code&gt;formGroup.getRawValue()&lt;/code&gt; å…©ç¨®æ–¹æ³•ï¼Œé—œæ–¼ &lt;code&gt;getRawValue()&lt;/code&gt; å¤§æ¦‚ä¹Ÿä¸ç”¨å¤šè´…è¿°äº†ã€‚ä½†ä½ çŸ¥é“ &lt;code&gt;FormGroup&lt;/code&gt; çš„ value å–å¾—è³‡æ–™çš„è¦å‰‡å— ?&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[Angular] Angular Form å€¼è®ŠåŒ– - ä¸è¸©é›·å°±ä¸æœƒé€²æ­¥</title>
    <link href="http://blog.kevinyang.net/2020/04/20/angular-form-valuechanges/"/>
    <id>http://blog.kevinyang.net/2020/04/20/angular-form-valuechanges/</id>
    <published>2020-04-20T01:49:44.000Z</published>
    <updated>2021-03-17T15:14:17.827Z</updated>
    
    <content type="html"><![CDATA[<p>Angular Reacitve Form å…§æœ‰ä¸€å¥—å€¼çš„æ›´æ–°æµç¨‹ï¼Œå¾ FormGroup åˆ° FormControl é–“åˆ°åº•æ˜¯å¦‚ä½•é€²è¡Œè³‡æ–™çš„æ›´æ–°ï¼Œæœ‰ä»€éº¼è¦ç•™æ„çš„åœ°æ–¹ï¼Œåœ¨é€™ç¯‡ç­†è¨˜å…§æˆ‘ç›¡é‡æ•´ç† (æœƒæŒçºŒæ½¤ç¨¿)</p><span id="more"></span><p>é¦–å…ˆå…ˆå°‡é‡é»æ”¾åœ¨ <code>FormGroup</code> å’Œ <code>FormControl</code> é€™å…©å€‹ä¸»é«”ä¸Šå°±å¥½ï¼Œæˆ‘å€‘éƒ½çŸ¥é“ <code>FormGroup</code> å’Œ <code>FormControl</code> éƒ½æ˜¯ç¹¼æ‰¿ <code>AbstractControl</code>ï¼Œä¸åŒçš„éƒ¨åˆ†å°±åœ¨å„ class ä¸Šé‡æ–°æ’°å¯« ï¼Œå¥½åŠ åœ¨çš„æ˜¯é€™ç¯‡æ–‡ç« è¦çœ‹çš„ç¨‹æ˜¯ç¢¼éƒ½åœ¨åŒä¸€å€‹<a href="https://github.com/angular/angular/blob/d7e9d8746a47c689fd8014f3913c47c4d6692709/packages/forms/src/model.ts">æª”æ¡ˆ</a>ä¸Š</p><p>è€Œæ­¤ç¯‡è¦æ¢è¨çš„æ˜¯ <code>setValue</code>ã€<code>patchValue</code> å’Œ <code>valuechanges</code> é€™ä¸‰ä»¶äº‹æƒ…ï¼Œåˆ°åº•æ›´æ–°çš„æµç¨‹æ˜¯ä»€éº¼ï¼Œç‚ºä»€éº¼é€™ä»¶äº‹æƒ…å¾ˆé‡è¦ï¼Œç•¶åœ¨å¯«é€£å‹•è¡¨å–®æˆ–æ˜¯ç‰©ä»¶æ™‚ï¼Œæµç¨‹ä¸€ä½†æéŒ¯å°±æœƒè®“ä½ é™¤éŒ¯é™¤åˆ°æ­»</p><h1 id="åŸå§‹ç¢¼è§£æ"><a class="header-anchor" href="#åŸå§‹ç¢¼è§£æ"> </a>åŸå§‹ç¢¼è§£æ</h1><h2 id="FormControl"><a class="header-anchor" href="#FormControl"> </a>FormControl</h2><p>å…ˆå¾æœ€åº•å±¤çš„å…ƒä»¶ä¾†çœ‹ï¼Œå°æ–¼ <code>FormControl</code> ä¾†èªªï¼Œ<code>patchValue</code> èˆ‡ <code>setValue</code> æ˜¯æ²’æœ‰å·®ç•°çš„ï¼Œå³ä½¿å‘¼å« <code>patchValue</code>ï¼Œé‚„æ˜¯æœƒå»åŸ·è¡Œ <code>setValue</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> patchValue(value: <span class="built_in">any</span>, <span class="attr">options</span>: &#123;</span><br><span class="line">    onlySelf?: <span class="built_in">boolean</span>,</span><br><span class="line">    emitEvent?: <span class="built_in">boolean</span>,</span><br><span class="line">    emitModelToViewChange?: <span class="built_in">boolean</span>,</span><br><span class="line">    emitViewToModelChange?: <span class="built_in">boolean</span></span><br><span class="line">  &#125; = &#123;&#125;): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.setValue(value, options);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œ <code>setValue</code> æœƒåŸ·è¡Œçš„ç¨‹æ˜¯ç¢¼å…¶å¯¦ä¹Ÿä¸å¤šï¼Œæ‰€æœ‰çš„å·¥ä½œéƒ½è½åœ¨ <code>updateValueAndValidity</code> ä¸Š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">setValue(value: <span class="built_in">any</span>, <span class="attr">options</span>: &#123;</span><br><span class="line">   onlySelf?: <span class="built_in">boolean</span>,</span><br><span class="line">   emitEvent?: <span class="built_in">boolean</span>,</span><br><span class="line">   emitModelToViewChange?: <span class="built_in">boolean</span>,</span><br><span class="line">   emitViewToModelChange?: <span class="built_in">boolean</span></span><br><span class="line"> &#125; = &#123;&#125;): <span class="built_in">void</span> &#123;</span><br><span class="line">   (<span class="built_in">this</span> <span class="keyword">as</span> &#123;<span class="attr">value</span>: <span class="built_in">any</span>&#125;).value = <span class="built_in">this</span>._pendingValue = value;</span><br><span class="line">   <span class="keyword">if</span> (<span class="built_in">this</span>._onChange.length &amp;&amp; options.emitModelToViewChange !== <span class="literal">false</span>) &#123;</span><br><span class="line">     <span class="built_in">this</span>._onChange.forEach(</span><br><span class="line">         (changeFn) =&gt; changeFn(<span class="built_in">this</span>.value, options.emitViewToModelChange !== <span class="literal">false</span>));</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">this</span>.updateValueAndValidity(options); <span class="comment">// é‡é» function</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="updateValueAndValidity"><a class="header-anchor" href="#updateValueAndValidity"> </a>updateValueAndValidity</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">updateValueAndValidity(opts: &#123;onlySelf?: <span class="built_in">boolean</span>, emitEvent?: <span class="built_in">boolean</span>&#125; = &#123;&#125;): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>._setInitialStatus();</span><br><span class="line">    <span class="built_in">this</span>._updateValue();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.enabled) &#123;</span><br><span class="line">      <span class="built_in">this</span>._cancelExistingSubscription();</span><br><span class="line">      (<span class="built_in">this</span> <span class="keyword">as</span> &#123;<span class="attr">errors</span>: ValidationErrors | <span class="literal">null</span>&#125;).errors = <span class="built_in">this</span>._runValidator();</span><br><span class="line">      (<span class="built_in">this</span> <span class="keyword">as</span> &#123;<span class="attr">status</span>: <span class="built_in">string</span>&#125;).status = <span class="built_in">this</span>._calculateStatus();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">this</span>.status === VALID || <span class="built_in">this</span>.status === PENDING) &#123;</span><br><span class="line">        <span class="built_in">this</span>._runAsyncValidator(opts.emitEvent);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (opts.emitEvent !== <span class="literal">false</span>) &#123;</span><br><span class="line">      (<span class="built_in">this</span>.valueChanges <span class="keyword">as</span> EventEmitter&lt;<span class="built_in">any</span>&gt;).emit(<span class="built_in">this</span>.value);</span><br><span class="line">      (<span class="built_in">this</span>.statusChanges <span class="keyword">as</span> EventEmitter&lt;<span class="built_in">string</span>&gt;).emit(<span class="built_in">this</span>.status);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>._parent &amp;&amp; !opts.onlySelf) &#123;</span><br><span class="line">      <span class="built_in">this</span>._parent.updateValueAndValidity(opts);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦ç¨‹å¼ç¢¼æ˜¯å¯«åœ¨ <code>AbstractControl</code> è£¡</p><ul><li><p>line 2: å–å¾—ç›®å‰ç‰©ä»¶çš„ç‹€æ…‹ï¼Œå¦‚æœæ˜¯ <code>disabled</code> çš„è©±ï¼Œå‰‡ <code>status</code> å°‡æœƒæ˜¯ <code>DISABLED</code> ä¸ç„¶å°±æ˜¯ <code>VALID</code></p></li><li><p>line 3: åªæœ‰åœ¨ <code>FormGroup</code> å’Œ <code>FormArray</code> æœ‰å¯¦åšï¼Œæ ¹æ“šç›®å‰ <code>Group</code> / <code>Array</code> å…§å­ç‰©ä»¶çš„å€¼æ›´æ–°æœ¬èº«çš„å€¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** <span class="doctag">@internal </span>*/</span></span><br><span class="line">_updateValue(): <span class="built_in">void</span> &#123;</span><br><span class="line">  (<span class="built_in">this</span> <span class="keyword">as</span> &#123;<span class="attr">value</span>: <span class="built_in">any</span>&#125;).value = <span class="built_in">this</span>._reduceValue();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** <span class="doctag">@internal </span>*/</span></span><br><span class="line"><span class="function"><span class="title">_reduceValue</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>._reduceChildren(</span><br><span class="line">      &#123;&#125;, <span class="function">(<span class="params">acc: &#123;[k: <span class="built_in">string</span>]: AbstractControl&#125;, control: AbstractControl, name: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (control.enabled || <span class="built_in">this</span>.disabled) &#123;</span><br><span class="line">          acc[name] = control.value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>line 5 ~ 13: å¦‚æœç‰©ä»¶ç‹€æ…‹æ˜¯ <code>enabled</code> æ‰æœƒé€²è¡Œé©—è­‰å‹•ä½œï¼Œé©—è­‰çš„é †åºç‚º</p><ol><li>åŒæ­¥é©—è­‰å…ˆåŸ·è¡Œï¼Œä¸¦æ›´æ–°ç‹€æ…‹</li><li>å¦‚æœç‹€æ…‹æ˜¯ <code>VALID</code> æˆ–æ˜¯ <code>PENDING</code> æ‰æœƒé€²è¡ŒéåŒæ­¥é©—è­‰</li></ol></li><li><p>æ ¹æ“šå‚³å…¥åƒæ•¸ <code>emitEvent</code> ä¾†æ±ºå®šæ˜¯å¦è§¸ç™¼ <code>valueChanges</code> å’Œ <code>statusChanges</code></p></li><li><p>æ ¹æ“š <code>onlySelf</code> ä¾†æ±ºå®šæ˜¯å¦è¦è§¸ç™¼çˆ¶å±¤çš„ <code>updateValueAndValidity</code></p></li></ul><p>é€™è£¡æœ‰ä¸€å€‹å°æŠ€å·§ï¼Œæ‰€å‚³å…¥çš„åƒæ•¸å€¼ä¸¦æ²’æœ‰è¨­å®šé è¨­å€¼ï¼Œè€Œæ˜¯å¾ˆæ˜ç¢ºæŒ‡å®šåˆ¤æ–·å€¼ï¼Œé€™æ‹›å¯ä»¥å­¸ä¸€ä¸‹</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (opts.emitEvent !== <span class="literal">false</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="FormGroup"><a class="header-anchor" href="#FormGroup"> </a>FormGroup</h2><h3 id="patchValue"><a class="header-anchor" href="#patchValue"> </a>patchValue</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">patchValue(value: &#123;[key: <span class="built_in">string</span>]: <span class="built_in">any</span>&#125;, <span class="attr">options</span>: &#123;onlySelf?: <span class="built_in">boolean</span>, emitEvent?: <span class="built_in">boolean</span>&#125; = &#123;&#125;):</span><br><span class="line">     <span class="built_in">void</span> &#123;</span><br><span class="line">   <span class="built_in">Object</span>.keys(value).forEach(<span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="built_in">this</span>.controls[name]) &#123;</span><br><span class="line">       <span class="built_in">this</span>.controls[name].patchValue(value[name], &#123;<span class="attr">onlySelf</span>: <span class="literal">true</span>, <span class="attr">emitEvent</span>: options.emitEvent&#125;);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="built_in">this</span>.updateValueAndValidity(options);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ul><li>æœƒå…ˆæ›´æ–°å­ç‰©ä»¶ï¼Œä¸¦è¨­å®šåªæœƒæ›´æ–°å­ç‰©ä»¶æœ¬èº«</li><li>åœ¨è·‘è‡ªå·±çš„ <code>updateValueAndValidity</code></li></ul><h1 id="ç´°ç¯€"><a class="header-anchor" href="#ç´°ç¯€"> </a>ç´°ç¯€</h1><p>ä¸€èˆ¬ä½¿ç”¨åŸºæœ¬ä¸Šä¸æœƒé‡åˆ°ä»€éº¼å•é¡Œï¼Œä½†å¦‚æœé‡åˆ°é€£å‹•çš„æƒ…æ³ï¼Œå°±è¦ç‰¹åˆ¥å°å¿ƒ</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">formData = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">   firstName: <span class="keyword">new</span> FormControl(),</span><br><span class="line">   lastName: <span class="keyword">new</span> FormControl()</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><h2 id="æƒ…å¢ƒ-1"><a class="header-anchor" href="#æƒ…å¢ƒ-1"> </a>æƒ…å¢ƒ 1</h2><p>è«‹å„ä½æƒ³æƒ³æ ¹æ“šç¬¬ä¸€æ®µçš„åŸå§‹ç¢¼è§£æï¼Œé€™é‚Šè·‘å‡ºä¾†çµæœæœƒæ˜¯ä»€éº¼å‘¢?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.formData.valueChanges.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;formGroup&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.firstName.valueChanges.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;firstName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span> ,<span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.lastName.valueChanges.subscribe(&#123;</span><br><span class="line">     next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;lastName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span> ,<span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>çµæœå¦‚ä¸‹</p><p><img src="image-20200420113943341.png" alt="image-20200420113943341"></p><p>ç‚ºä»€éº¼å‘¢? ä¾†æ¨¡æ“¬ä¸€ä¸‹åŸ·è¡Œçš„æ­¥é©Ÿ</p><ol><li><code>formGroup.patchValue</code> : æœƒæ ¹æ“šå‚³é€²å»çš„è³‡æ–™ä¾åºæ›´æ–° <code>firstname</code> èˆ‡ <code>lastName</code> formControl</li><li><code>firstName FormControl</code> æ›´æ–°è‡ªèº«çš„å€¼ï¼Œä½†å› ç‚º <code>FormGroup</code> å‚³å…¥ <code>onlySelf</code> ç‚º <code>true</code>ï¼Œæ‰€ä»¥ä¸æœƒæ›´æ–° parent çš„å€¼</li><li><code>lastName FormControl</code> æ›´æ–°è‡ªèº«çš„å€¼ï¼Œä½†å› ç‚º <code>FormGroup</code> å‚³å…¥ <code>onlySelf</code> ç‚º <code>true</code>ï¼Œæ‰€ä»¥ä¸æœƒæ›´æ–° parent çš„å€¼</li><li><code>FormGroup</code> åŸ·è¡Œ <code>updateValueAndValidity</code></li><li>æ ¹æ“š <code>children</code> æ›´æ–°è‡ªèº«çš„å€¼</li><li>é€å‡º <code>valueChanges event</code></li><li>çµæŸ</li></ol><h2 id="æƒ…å¢ƒ-2"><a class="header-anchor" href="#æƒ…å¢ƒ-2"> </a>æƒ…å¢ƒ 2</h2><p>é€™é‚Šè·‘å‡ºä¾†çµæœæœƒæ˜¯ä»€éº¼å‘¢?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.formData.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;formGroup&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.firstName.valueChanges</span><br><span class="line">    .pipe(tap(<span class="function">() =&gt;</span> <span class="built_in">this</span>.formData.controls.lastName.setValue(<span class="string">&quot;3&quot;</span>)))</span><br><span class="line">    .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">        <span class="string">&quot;firstName:&quot;</span>,</span><br><span class="line">        value,</span><br><span class="line">        <span class="string">&quot;formGroup value:&quot;</span>,</span><br><span class="line">        <span class="built_in">this</span>.formData.value</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.lastName.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;lastName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>çµæœå¦‚ä¸‹</p><p><img src="image-20200420114620734.png" alt="image-20200420114620734"></p><p>ä½ æƒ³å°äº†å—? æˆ‘å€‘ä¾†æ¨¡æ“¬ä¸€ä¸‹åŸ·è¡Œçš„æ­¥é©Ÿ</p><ol><li><code>formGroup.patchValue</code> : æœƒæ ¹æ“šå‚³é€²å»çš„è³‡æ–™ä¾åºæ›´æ–° <code>firstname</code> èˆ‡ <code>lastName</code> formControl</li><li><code>firstName FormControl</code> æ›´æ–°è‡ªèº«çš„å€¼ï¼Œä½†å› ç‚º <code>FormGroup</code> å‚³å…¥ <code>onlySelf</code> ç‚º <code>true</code> ï¼Œæ‰€ä»¥ä¸æœƒæ›´æ–° parent çš„å€¼</li><li>éç¨‹ä¸­å»åŸ·è¡Œæ›´æ–° <code>lastName FormControl</code> çš„å€¼ ï¼Œåƒæ•¸æ¥ç‚ºé è¨­å€¼ï¼Œæ‰€ä»¥ <code>emitEvent: true,onlySelf:false</code></li><li>è§¸ç™¼ <code>lastName FormControl</code> çš„ <code>valueChanges</code></li><li>è§¸ç™¼çˆ¶å±¤çš„ <code>updateValueAndValidity</code></li><li><code>firstName FormControl</code> è‡ªèº« <code>valueChanges</code> æµç¨‹è·‘ç©</li><li><code>lastName FormControl</code> æ›´æ–°è‡ªèº«çš„å€¼ï¼Œä½†å› ç‚º <code>FormGroup</code> å‚³å…¥ <code>onlySelf</code> ç‚º <code>true</code>ï¼Œæ‰€ä»¥ä¸æœƒæ›´æ–°çˆ¶å±¤çš„å€¼</li><li><code>FormGroup</code> åŸ·è¡Œ <code>updateValueAndValidity</code></li><li>æ ¹æ“š <code>children</code> æ›´æ–°è‡ªèº«çš„å€¼</li><li>é€å‡º <code>valueChanges event</code></li><li>çµæŸ</li></ol><h2 id="æƒ…å¢ƒ-3"><a class="header-anchor" href="#æƒ…å¢ƒ-3"> </a>æƒ…å¢ƒ 3</h2><p>é€™é‚Šè·‘å‡ºä¾†çµæœæœƒæ˜¯ä»€éº¼å‘¢?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.formData.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;formGroup&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.firstName.valueChanges</span><br><span class="line">    .pipe(tap(<span class="function">() =&gt;</span> <span class="built_in">this</span>.formData.controls.lastName.setValue(<span class="string">&quot;3&quot;</span>, &#123;<span class="attr">emitEvent</span>: <span class="literal">false</span>&#125;)))</span><br><span class="line">    .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">        <span class="string">&quot;firstName:&quot;</span>,</span><br><span class="line">        value,</span><br><span class="line">        <span class="string">&quot;formGroup value:&quot;</span>,</span><br><span class="line">        <span class="built_in">this</span>.formData.value</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.lastName.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;lastName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>çµæœå¦‚ä¸‹ï¼Œä½ æƒ³å°äº†å—?</p><p><img src="image-20200420115342646.png" alt="image-20200420115342646"></p><h2 id="æƒ…å¢ƒ-4"><a class="header-anchor" href="#æƒ…å¢ƒ-4"> </a>æƒ…å¢ƒ 4</h2><p>é€™é‚Šè·‘å‡ºä¾†çµæœæœƒæ˜¯ä»€éº¼å‘¢?</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.formData.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;formGroup&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.firstName.valueChanges</span><br><span class="line">    .pipe(tap(<span class="function">() =&gt;</span> <span class="built_in">this</span>.formData.controls.lastName.setValue(<span class="string">&quot;3&quot;</span>, &#123;<span class="attr">emitEvent</span>: <span class="literal">false</span>, <span class="attr">onlySelf</span>: <span class="literal">true</span>&#125;)))</span><br><span class="line">    .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">        <span class="string">&quot;firstName:&quot;</span>,</span><br><span class="line">        value,</span><br><span class="line">        <span class="string">&quot;formGroup value:&quot;</span>,</span><br><span class="line">        <span class="built_in">this</span>.formData.value</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.lastName.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;lastName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>çµæœå¦‚ä¸‹ï¼Œä½ æƒ³å°äº†å—?</p><p><img src="image-20200420115502508.png" alt="image-20200420115502508"></p><h2 id="æƒ…å¢ƒ-5"><a class="header-anchor" href="#æƒ…å¢ƒ-5"> </a>æƒ…å¢ƒ 5</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.formData.valueChanges.subscribe(&#123;</span><br><span class="line">      next: <span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;formGroup&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.firstName.valueChanges</span><br><span class="line">    .pipe(</span><br><span class="line">    mergeMap(<span class="function">() =&gt;</span></span><br><span class="line">             timer(<span class="number">1000</span>, <span class="number">0</span>).pipe(</span><br><span class="line">        take(<span class="number">1</span>),</span><br><span class="line">        tap(<span class="function">() =&gt;</span></span><br><span class="line">            <span class="built_in">this</span>.formData.controls.lastName.setValue(<span class="string">&quot;3&quot;</span>, &#123;</span><br><span class="line">            emitEvent: <span class="literal">false</span>,</span><br><span class="line">            onlySelf: <span class="literal">true</span></span><br><span class="line">        &#125;)))</span><br><span class="line">      )</span><br><span class="line">)</span><br><span class="line">    .subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">        <span class="string">&quot;firstName:&quot;</span>,</span><br><span class="line">        value,</span><br><span class="line">        <span class="string">&quot;formGroup value:&quot;</span>,</span><br><span class="line">        <span class="built_in">this</span>.formData.value</span><br><span class="line">    )</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.controls.lastName.valueChanges.subscribe(&#123;</span><br><span class="line">    next: <span class="function"><span class="params">value</span> =&gt;</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;lastName:&quot;</span>, value, <span class="string">&quot;formGroup value:&quot;</span>, <span class="built_in">this</span>.formData.value)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.formData.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    lastName: <span class="string">&quot;2&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>çµæœå¦‚ä¸‹ï¼Œä½ æƒ³å°äº†å—?</p><p><img src="image-20200420115625936.png" alt="image-20200420115625936"></p><h1 id="å¿ƒå¾—"><a class="header-anchor" href="#å¿ƒå¾—"> </a>å¿ƒå¾—</h1><p>Reactive Form å°‡ <code>valueChanges</code> åŒ…æˆ <code>Observable</code> æ˜¯å¾ˆæ–¹ä¾¿ï¼Œè¦åšä¸€äº›é€£å‹•çš„å‹•ä½œå¯ä»¥å¦‚æµæ°´èˆ¬çš„æ“ä½œï¼Œä½†å•é¡Œæ˜¯ï¼Œå¦‚æœè³‡æ–™æµçš„ç·šè·¯æ²’æå°ï¼Œå°±æœƒç™¼ç”Ÿç‚ºä»€éº¼é€™è£¡å–çš„è³‡æ–™æ˜¯éŒ¯çš„å•é¡Œç™¼ç”Ÿã€‚é€™äº›ç´°ç¯€çš„éƒ¨åˆ†éƒ½æ˜¯æ–‡ä»¶ä¸­æ²’æœ‰æåˆ°çš„</p><p>æ‰€ä»¥ï¼Œåœ¨ FormControl çš„ valuechanges æµä¸­æ“ä½œå…¶å®ƒ FormControl çš„å€¼è¦ç‰¹åˆ¥å°å¿ƒï¼Œå‹™å¿…ç¢ºèªåŒæ­¥èˆ‡éåŒæ­¥çš„ç™¼ç”Ÿé †åº</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Angular Reacitve Form å…§æœ‰ä¸€å¥—å€¼çš„æ›´æ–°æµç¨‹ï¼Œå¾ FormGroup åˆ° FormControl é–“åˆ°åº•æ˜¯å¦‚ä½•é€²è¡Œè³‡æ–™çš„æ›´æ–°ï¼Œæœ‰ä»€éº¼è¦ç•™æ„çš„åœ°æ–¹ï¼Œåœ¨é€™ç¯‡ç­†è¨˜å…§æˆ‘ç›¡é‡æ•´ç† (æœƒæŒçºŒæ½¤ç¨¿)&lt;/p&gt;</summary>
    
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/categories/Angular/"/>
    
    
    <category term="Angular" scheme="http://blog.kevinyang.net/tags/Angular/"/>
    
  </entry>
  
  <entry>
    <title>[AMP] First AMP Page</title>
    <link href="http://blog.kevinyang.net/2020/04/16/amp-101/"/>
    <id>http://blog.kevinyang.net/2020/04/16/amp-101/</id>
    <published>2020-04-16T01:07:55.000Z</published>
    <updated>2021-03-17T15:14:17.827Z</updated>
    
    <content type="html"><![CDATA[<p>AMP = Accelerated Mobile Pagesï¼ŒGoogleå¸¶é ˜é–‹ç™¼çš„é–‹æºå°ˆæ¡ˆï¼Œç›®çš„æ˜¯ç‚ºæå‡è¡Œå‹•è£ç½®å°ç¶²ç«™çš„å­˜å–é€Ÿåº¦ã€‚æ²’å¯«éï¼Œæ‰€ä»¥è¦ä¾†å­¸ï¼Œé€™ä¸€ç¯‡å°±æ˜¯å­¸ç¿’éç¨‹ä¸­çš„ç­†è¨˜</p><span id="more"></span><h1 id="AMP-åŸºæœ¬çµ„æˆ"><a class="header-anchor" href="#AMP-åŸºæœ¬çµ„æˆ"> </a>AMP åŸºæœ¬çµ„æˆ</h1><p>ä¸€å€‹åˆæ ¼çš„ AMP ä¸€å®šè¦æœ‰ä»¥ä¸‹çš„å…ƒç´ </p><ol><li><p>ç¬¬ä¸€è¡Œä¸€å®šæ˜¯ <code>&lt;!doctype html&gt;</code></p></li><li><p>ä¸€å®šæœ‰ <code>&lt;head&gt;&lt;/head&gt;</code> å’Œ <code>&lt;body&gt;&lt;/body&gt;</code> å…©å€‹å€å¡Š</p></li><li><p><code>&lt;html&gt;</code> æ¨™ç±¤å…§è¦æ¨™ç¤ºé–ƒé›»ç¬¦è™Ÿ (<code>&lt;html âš¡&gt;</code>ï¼Œæˆ–æ˜¯ <code>amp</code> æ–‡å­— (<code>&lt;html amp&gt;</code>)</p></li><li><p><code>&lt;head&gt;</code> çš„ç¬¬ä¸€å€‹å…ƒç´ ä¸€å®šæ˜¯ <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code></p></li><li><p><code>&lt;head&gt;</code> å…§æœƒæœ‰ <code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1,initial-scale=1&quot;&gt;</code></p></li><li><p><code>&lt;head&gt;</code> å…§è¦æœ‰ <code>&lt;script async src=&quot;https://cdn.ampproject.org/v0.js&quot;&gt;&lt;/script&gt;</code>ï¼Œé€™ä¸€è¡Œè¶Šæ—©å¯«è¶Šå¥½</p></li><li><p><code>&lt;head&gt;</code> å…§è¦æœ‰ <code>&lt;link rel=&quot;canonical&quot; href=&quot;$SOME_URL&quot;&gt;</code>ï¼Œ<code>$SOME_URL</code> è¦æ›¿æ›æˆç›®å‰é é¢çš„ç¶²å€ï¼Œç›®çš„æ˜¯è¦é€£çµç›®å‰çš„ AMP é é¢åˆ°é AMP é é¢æˆ–æ˜¯ç¶²ç«™</p></li><li><p>åŒ…å« AMP-Style: é€™æ®µç¨‹å¼ç¢¼æœƒåœ¨ AMP Script è¼‰å…¥å‰å°‡ç•«é¢éš±è—</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">amp-boilerplate</span>&gt;</span><span class="css"><span class="selector-tag">body</span>&#123;-webkit-<span class="attribute">animation</span>:-amp-start <span class="number">8s</span> <span class="built_in">steps</span>(<span class="number">1</span>,end) <span class="number">0s</span> <span class="number">1</span> normal both;-moz-<span class="attribute">animation</span>:-amp-start <span class="number">8s</span> <span class="built_in">steps</span>(<span class="number">1</span>,end) <span class="number">0s</span> <span class="number">1</span> normal both;-ms-<span class="attribute">animation</span>:-amp-start <span class="number">8s</span> <span class="built_in">steps</span>(<span class="number">1</span>,end) <span class="number">0s</span> <span class="number">1</span> normal both;<span class="attribute">animation</span>:-amp-start <span class="number">8s</span> <span class="built_in">steps</span>(<span class="number">1</span>,end) <span class="number">0s</span> <span class="number">1</span> normal both&#125;<span class="keyword">@-webkit-keyframes</span> -amp-start&#123;<span class="selector-tag">from</span>&#123;<span class="attribute">visibility</span>:hidden&#125;<span class="selector-tag">to</span>&#123;<span class="attribute">visibility</span>:visible&#125;&#125;<span class="keyword">@-moz-keyframes</span> -amp-start&#123;<span class="selector-tag">from</span>&#123;<span class="attribute">visibility</span>:hidden&#125;<span class="selector-tag">to</span>&#123;<span class="attribute">visibility</span>:visible&#125;&#125;<span class="keyword">@-ms-keyframes</span> -amp-start&#123;<span class="selector-tag">from</span>&#123;<span class="attribute">visibility</span>:hidden&#125;<span class="selector-tag">to</span>&#123;<span class="attribute">visibility</span>:visible&#125;&#125;<span class="keyword">@-o-keyframes</span> -amp-start&#123;<span class="selector-tag">from</span>&#123;<span class="attribute">visibility</span>:hidden&#125;<span class="selector-tag">to</span>&#123;<span class="attribute">visibility</span>:visible&#125;&#125;<span class="keyword">@keyframes</span> -amp-start&#123;<span class="selector-tag">from</span>&#123;<span class="attribute">visibility</span>:hidden&#125;<span class="selector-tag">to</span>&#123;<span class="attribute">visibility</span>:visible&#125;&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">noscript</span>&gt;</span><span class="tag">&lt;<span class="name">style</span> <span class="attr">amp-boilerplate</span>&gt;</span><span class="css"><span class="selector-tag">body</span>&#123;-webkit-<span class="attribute">animation</span>:none;-moz-<span class="attribute">animation</span>:none;-ms-<span class="attribute">animation</span>:none;<span class="attribute">animation</span>:none&#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="AMP-é™åˆ¶"><a class="header-anchor" href="#AMP-é™åˆ¶"> </a>AMP é™åˆ¶</h1><h2 id="CSS"><a class="header-anchor" href="#CSS"> </a>CSS</h2><p>åœ¨ AMP ä¸Šé¢è¦ä½¿ç”¨è‡ªè¨‚ CSS æœ‰ä»¥ä¸‹çš„è¨­å®š</p><ol><li>è‡ªè¨‚ CSS å¿…é ˆå®šç¾©åœ¨ <code>&lt;style amp-custom&gt;&lt;/style&gt;</code> å…§ä¸”åªèƒ½æœ‰ä¸€å€‹æˆ–æ˜¯ <code>inline-style</code>ï¼Œç‚ºäº†ç¯€çœç¶²è·¯å‚³è¼¸ï¼Œä¸èƒ½æœ‰å¤–éƒ¨ style é€£çµ</li><li>CSS å…§å®¹çš„éƒ¨åˆ†å¤§å°ä¸èƒ½å¤§æ–¼ 75 K</li><li>ä¸èƒ½ä½¿ç”¨ <code>!important</code></li><li>ä¸èƒ½å¯« <code>i-amphtml-</code> class å’Œ tag åç¨±ï¼Œç°¡å–®èªªä¸èƒ½ä½¿ç”¨ AMP Component è¦ç”¨çš„åç¨±</li><li>å…¶å®ƒèƒ½ç”¨ä¸èƒ½ç”¨çš„ CSS Style è«‹åƒé–± <a href="https://amp.dev/documentation/guides-and-tutorials/develop/style_and_layout/style_pages/?format=websites">Suppored CSS</a></li></ol><h2 id="HTML"><a class="header-anchor" href="#HTML"> </a>HTML</h2><p>é™¤äº† CSS æœ‰é™åˆ¶å¤–ï¼ŒHTML ä¹Ÿæœ‰å…è¨±è·Ÿä¸å…è¨±ä½¿ç”¨çš„åˆ—è¡¨ ï¼Œ<a href="https://github.com/ampproject/amphtml/blob/master/spec/amp-tag-addendum.md#html5-tag-whitelist">HTML5 Tag ç™½åå–®</a></p><p>æ›´å¤šè©³ç´°è³‡è¨Šå¯ä»¥é–±è®€æ­¤æ–‡ï¼Œ<a href="https://amp.dev/documentation/guides-and-tutorials/learn/spec/amphtml/?format=websites">AMP HTML Specification</a></p><h1 id="é–‹ç™¼æ€ç¶­"><a class="header-anchor" href="#é–‹ç™¼æ€ç¶­"> </a>é–‹ç™¼æ€ç¶­</h1><p>AMP çš„é–‹ç™¼æ–¹å¼ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä½¿ç”¨å®˜æ–¹æä¾›çš„ Component å»çµ„å‡ºç•«é¢ï¼Œæ‰€ä»¥åœ¨å…§å®¹å‘ˆç¾ä¸Šå°±æ˜¯è¦æ‰¾åˆ°å°çš„ Component ç„¶å¾Œå°‡å…§å®¹å¥—é€²å»ï¼Œä¾‹å¦‚ <code>&lt;img&gt;</code>ï¼Œå°±æœƒç”¨ <code>&lt;amp-img&gt;</code> æ›¿ä»£</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">amp-img</span> <span class="attr">src</span>=<span class="string">&quot;IMG-URL&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;responsive&quot;</span> <span class="attr">width</span>=<span class="string">&quot;640&quot;</span> <span class="attr">height</span>=<span class="string">&quot;480&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">amp-img</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€æœ‰çš„å‹•ä½œå°±äº¤çµ¦ component ä¾†è™•ç†ï¼Œåƒæ˜¯ RWD çš„æ•ˆæœï¼Œé™¤äº† <code>responsive</code> çš„æ•ˆæœå¤–ï¼Œç•¶ç„¶é‚„æœ‰å…¶ä»–çš„è¨­å®šï¼Œè¨­å®šæ–¹å¼è«‹åƒé–±å®˜æ–¹æ–‡ä»¶ <a href="https://amp.dev/documentation/guides-and-tutorials/learn/amp-html-layout/?format=websites">AMPHTML Layout System</a> ç« ç¯€</p><h2 id="ä½¿ç”¨-AMP-Components"><a class="header-anchor" href="#ä½¿ç”¨-AMP-Components"> </a>ä½¿ç”¨ AMP Components</h2><p>æ¯ä¸€å€‹ AMP Component åœ¨è‡ªå·±çš„ API æ–‡ä»¶ä¸­ï¼Œå¤§éƒ¨åˆ†éƒ½æœ‰ <code>Required Scripts</code> çš„è³‡è¨Šï¼Œè€Œé€™ä¸€å€‹è³‡è¨Šå°±æ˜¯è¦åŠ åˆ°é é¢ä¸­ï¼Œä¾‹å¦‚ <code>amp-youtube</code> å…ƒä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">custom-element</span>=<span class="string">&quot;amp-youtube&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.ampproject.org/v0/amp-youtube-0.1.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åŸºæ–¼é€™ç¨®æ¶æ§‹ï¼Œå¯« AMP  çš„ç¬¬ä¸€å€‹é–€æª»æ˜¯è¦ä½¿ç”¨å“ªä¸€å€‹ componentã€‚(æ€éº¼è·Ÿ Flutter å¥½åƒ)ï¼Œæ›´å¤šé—œæ–¼ Component çš„å¯ä»¥åƒé–± <a href="https://amp.dev/documentation/components/">Components æ–‡ä»¶</a></p><h1 id="é©—è­‰å·¥å…·"><a class="header-anchor" href="#é©—è­‰å·¥å…·"> </a>é©—è­‰å·¥å…·</h1><p>Chrome æœ‰å‡º AMP é©—è­‰å·¥å…·ï¼Œå®‰è£å¾Œå³å¯ä½¿ç”¨ï¼Œ<a href="https://chrome.google.com/webstore/detail/amp-validator/nmoffdblmcmgeicmolmhobpoocbbmknc/related?hl=en">å®‰è£ä½ç½®</a></p><h1 id="åƒè€ƒè³‡æ–™"><a class="header-anchor" href="#åƒè€ƒè³‡æ–™"> </a>åƒè€ƒè³‡æ–™</h1><ul><li><a href="https://amp.dev/documentation/courses/beginning-course">AMP Beginning Free Course</a></li><li><a href="https://support.google.com/webmasters/answer/139066?hl=zh-Hant">æ•´åˆé‡è¤‡çš„ç¶²å€ canonical</a></li><li><a href="https://amp.dev/documentation/guides-and-tutorials/learn/amp-html-layout/?format=websites">AMPHTML Layout System</a></li><li><a href="https://amp.dev/documentation/components/">Components æ–‡ä»¶</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;p&gt;AMP = Accelerated Mobile Pagesï¼ŒGoogleå¸¶é ˜é–‹ç™¼çš„é–‹æºå°ˆæ¡ˆï¼Œç›®çš„æ˜¯ç‚ºæå‡è¡Œå‹•è£ç½®å°ç¶²ç«™çš„å­˜å–é€Ÿåº¦ã€‚æ²’å¯«éï¼Œæ‰€ä»¥è¦ä¾†å­¸ï¼Œé€™ä¸€ç¯‡å°±æ˜¯å­¸ç¿’éç¨‹ä¸­çš„ç­†è¨˜&lt;/p&gt;</summary>
    
    
    
    <category term="AMP" scheme="http://blog.kevinyang.net/categories/AMP/"/>
    
    
    <category term="AMP" scheme="http://blog.kevinyang.net/tags/AMP/"/>
    
  </entry>
  
</feed>
