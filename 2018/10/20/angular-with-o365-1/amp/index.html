<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
    <link rel="canonical" href="http://blog.kevinyang.net/2018/10/20/angular-with-o365-1/" >
    <title>[Angular] 與 O365 跳舞系列 - 登入 - CK&#39;s Notepad</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
    <meta property="og:title" content="[Angular] 與 O365 跳舞系列 - 登入">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://blog.kevinyang.net/2018/10/20/angular-with-o365-1/">
	
		<meta property="og:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	<meta property="og:site_name" content="CK&#39;s Notepad">
	
		<meta property="og:description" content="&lt;p&gt;身為微軟 MVP，沒將 Angular 與 O365 做整合，好像說不過去。Microsoft O365 系列，其生態系其實算是很完整了，也提供了相當不錯的 API 供開發者做延伸應用。基於這個理由，我也決定要來玩看看 O365 了。但在開始之前，要先搞定登入 MS 帳號並取得通行 Token。所以這篇筆記就是記錄如何登入並取得 Token.&lt;/p&gt;">
	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="CK&#39;s Notepad">
	<meta name="twitter:url" content="http://blog.kevinyang.net/2018/10/20/angular-with-o365-1/">
	<meta name="twitter:title" content="[Angular] 與 O365 跳舞系列 - 登入 - CK&#39;s Notepad">
	
		<meta name="twitter:description" content="&lt;p&gt;身為微軟 MVP，沒將 Angular 與 O365 做整合，好像說不過去。Microsoft O365 系列，其生態系其實算是很完整了，也提供了相當不錯的 API 供開發者做延伸應用。基於這個理由，我也決定要來玩看看 O365 了。但在開始之前，要先搞定登入 MS 帳號並取得通行 Token。所以這篇筆記就是記錄如何登入並取得 Token.&lt;/p&gt;">
	
    
    	<meta name="twitter:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	
	
    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    <!--
  	<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>
    -->
    
    
    
    
    
    
    
    
    
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "BlogPosting",
			"headline": "[Angular] 與 O365 跳舞系列 - 登入",
			
			"description": "&lt;p&gt;身為微軟 MVP，沒將 Angular 與 O365 做整合，好像說不過去。Microsoft O365 系列，其生態系其實算是很完整了，也提供了相當不錯的 API 供開發者做延伸應用。基於這個理由，我也決定要來玩看看 O365 了。但在開始之前，要先搞定登入 MS 帳號並取得通行 Token。所以這篇筆記就是記錄如何登入並取得 Token.&lt;/p&gt;",
			
			"mainEntityOfPage":{
			    "@type":"WebPage",
			    "@id":"http://blog.kevinyang.net/2018/10/20/angular-with-o365-1/"
			},
			"datePublished": "2018-10-20T02:31:45.000Z",
			"dateModified": "2021-02-18T02:25:04.859Z",
			
			"image": {
				"@type": "ImageObject",
				"url": "/amp-dist/sample/sample-substituteTitleImage.png",
				"width" : "1024",
				"height" : "800"
			},
			
			"author": {
			    "@type": "Person",
			    "name": "KevinYang"
			},
			"publisher": {
			    "@type": "Organization",
			    "name": "CK&#39;s Notepad"
			    
			    ,
			    "logo": {
			      "@type": "ImageObject",
			      "url": "http://blog.kevinyang.net/amp-dist/sample/sample-logo.png",
			      "width": 600,
			      "height": 60
			    }
			    
			}
		}
	</script>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	
	<style amp-custom>
		
abbr,
acronym,
address,
applet,
big,
blockquote,
body,
caption,
cite,
code,
dd,
del,
dfn,
div,
dl,
dt,
em,
fieldset,
form,
h1,
h2,
h3,
h4,
h5,
h6,
html,
iframe,
img,
ins,
kbd,
label,
legend,
li,
object,
ol,
p,
pre,
q,
s,
samp,
small,
span,
strike,
strong,
sub,
sup,
table,
tbody,
td,
tfoot,
th,
thead,
tr,
tt,
ul,
var {
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
abbr {
  cursor: help;
  border-bottom: 1px dotted;
  font-variant: normal;
}
acronym {
  border-bottom: 1px dotted;
  font-variant: normal;
}
body {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  -webkit-text-size-adjust: 100%;
  background: #fff;
  color: #2d3d40;
  font-family: sans-serif;
  font-size: 1rem;
  font-weight: 500;
  line-height: 2rem;
  text-rendering: optimizelegibility;
}
button::-moz-focus-inner,
input::-moz-focus-inner,
figure.highlight td,
.post .entry-content figure.highlight th {
  border: 0;
  padding: 0;
}
caption,
table,
td,
th {
  vertical-align: middle;
}
caption,
td,
th,
.table-align-left {
  text-align: left;
}
del {
  text-decoration: line-through;
}
html {
  font-size: 14px;
}
:root sub,
:root sup {
  vertical-align: baseline;
}
table {
  border-collapse: separate;
  border-spacing: 0;
}
a {
  color: #e91e63;
  text-decoration: none;
  -webkit-transition: 0.7s;
  -ms-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -webkit-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -ms-transition: 0.7s;
  transition: 0.7s;
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
a img {
  border: none;
}
a:hover {
  -webkit-transition: 0.2s;
  -ms-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -webkit-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -ms-transition: 0.2s;
  transition: 0.2s;
  color: #930e3b;
}
@media (min-width: 481px) {
  html {
    font-size: 16px;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  html {
    font-size: 14px;
  }
}
.clearfix:after {
  clear: both;
  visibility: hidden;
  content: ".";
  display: block;
  height: 0;
}
.left {
  float: left;
}
.right {
  float: right;
}
.circle {
  -webkit-border-radius: 50%;
  border-radius: 50%;
}
.thumbImg-w {
  width: 100px;
  height: 100px;
  display: inline-block;
  position: relative;
  overflow: hidden;
}
.thumbImg {
  top: 50%;
  left: 50%;
  position: absolute;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  -webkit-transform: translate(-50%, -50%);
  -moz-transform: translate(-50%, -50%);
  -o-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xmlutf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#4A4A4A\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.nav ul:after {
  clear: both;
  visibility: hidden;
}
.nav,
.nav-icon {
  position: relative;
}
.nav ul {
  display: block;
}
.nav ul li {
  display: block;
}
.nav ul li a {
  display: block;
}
.tab {
  position: relative;
  color: #424242;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 200px;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li a {
  display: block;
  padding: 10px 20px;
}
header {
  height: 60px;
  background-color: #222f31;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
}
header .header-title a {
  padding: 0 0 0 20px;
  height: 60px;
  line-height: 60px;
  font-size: 20px;
  color: #fff;
  letter-spacing: 0.2em;
}
header .nav-container {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-box-pack: justify;
  -moz-box-pack: justify;
  -o-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-justify-content: space-between;
  justify-content: space-between;
}
header .left-nav {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: center;
  -ms-flex-align: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  font-size: 20px;
  margin-left: 0;
  font-weight: 300;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -webkit-box-flex: 1;
  -ms-flex: 1 1 auto;
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -o-box-flex: 1;
  box-flex: 1;
  -webkit-flex: 1 1 auto;
  -ms-flex: 1 1 auto;
  flex: 1 1 auto;
  text-align: left;
  width: auto;
  font-size: 15px;
}
header .right {
  font-size: 15px;
}
header .alt {
  padding: 0;
  text-align: right;
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  -o-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.blog-title a {
  position: relative;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#FFF\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.tab {
  position: relative;
  color: #2d3d40;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 250px;
  background-color: #182022;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li {
  border-top: 1px solid #2f4043;
}
amp-sidebar li:last-child {
  border-bottom: 1px solid #2f4043;
}
amp-sidebar li a {
  color: #fff;
  font-weight: bold;
  display: block;
  padding: 10px 20px;
}
amp-sidebar li a:hover {
  color: #ccc;
  background-color: #030404;
}
.categories-header {
  background-color: #2d3d40;
  padding: 0rem 0.8rem;
}
.categories-header a {
  color: #fff;
}
.categories-header a:hover {
  color: #fff;
}
.categories-header .breadcrumb ol li {
  list-style: none;
  display: inline-block;
  margin: 0;
}
.categories-header .breadcrumb ol li span {
  font-size: 0.8rem;
  font-weight: bold;
}
.categories-header .breadcrumb ol li:after {
  content: "/";
  color: #fff;
  display: inline-block;
  margin: 0 0.4rem;
}
.categories-header .breadcrumb ol li:last-child:after {
  content: "";
  margin: 0;
}
.entry-header {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.entry-header .flx:first-child {
  margin: 0 1rem 0 0;
}
.header-cap {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.title-cover {
  background-color: #fff;
  color: #2d3d40;
  padding: 1.5rem 0.8rem 0 0.8rem;
}
.title-cover a {
  font-size: 1.2rem;
  color: #2d3d40;
  text-align: left;
  font-weight: bold;
}
.entry-title {
  margin: 0;
}
.entry-meta-header {
  font-size: 0.85rem;
  text-align: center;
}
.entry-meta-header .date {
  font-family: sans-serif;
}
h1 a,
h2 a,
h3 a,
h4 a,
h5 a,
h6 a {
  color: #2d3d40;
  text-decoration: none;
}
h1 a:hover,
h2 a:hover,
h3 a:hover,
h4 a:hover,
h5 a:hover,
h6 a:hover {
  color: #e91e63;
}
#container {
  margin-left: auto;
  margin-right: auto;
}
#main {
  margin-bottom: 3em;
  padding-left: 0;
}
.post {
  margin-bottom: 3rem;
  position: relative;
}
.entry-content {
  margin: 0 0.6rem;
  font-size: 1rem;
}
.entry-content h1 {
  font-size: 1.7rem;
  line-height: 1.5;
  margin: 1em 0 0.8em;
}
.entry-content h2,
.entry-content h3,
.entry-content h4,
.entry-content h5,
.entry-content h6,
.entry-content h2 span,
.entry-content h3 span,
.entry-content h4 span,
.entry-content h5 span,
.entry-content h6 span {
  color: #98b8be;
  font-weight: bold;
}
.entry-content h2,
.entry-content h2 span {
  font-size: 1.8rem;
  line-height: 2.6rem;
  text-align: center;
}
.entry-content h2 {
  border-bottom: 2px solid #cce4e8;
  margin: 4.5rem 0 0.5em;
  padding: 0.8em 0;
}
.entry-content h3,
.entry-content h3 span {
  font-size: 1.6rem;
  line-height: 2.2rem;
  text-align: center;
}
.entry-content h3 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h4,
.entry-content h4 span {
  font-size: 1.4rem;
  line-height: 2rem;
  text-align: center;
}
.entry-content h4 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h5,
.entry-content h5 span {
  font-size: 1.2rem;
  line-height: 1.8rem;
  text-align: center;
}
.entry-content h5 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h6,
.entry-content h6 span {
  font-size: 1.1rem;
  line-height: 1.6rem;
  text-align: center;
}
.entry-content h6 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content p {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2.2rem;
  margin: 3rem 0.8rem;
}
.entry-content p a {
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: inline;
  border-bottom: 1px dashed #f1729d;
  padding-bottom: 0.3rem;
}
.entry-content p a:hover {
  border-bottom: 1px dashed #9c0f3f;
  padding-bottom: 0.4rem;
}
.entry-content em {
  background-color: #f9f5d1;
  color: #886d00;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
}
.entry-content strong {
  color: #871c1c;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
  background-color: #fadcdc;
}
.entry-content hr {
  border: 0;
  border-top: 3px solid #cce4e8;
  margin: 3rem auto;
  width: 20%;
}
.entry-content img,
.entry-content video {
  display: block;
  height: auto;
  margin: auto;
  max-width: 100%;
}
.entry-content iframe {
  width: 100% ;
}
.entry-content blockquote {
  margin: 3rem 0.8rem;
  padding: 1rem 1.8rem;
  position: relative;
  background-color: none;
  border-left: 3px solid #98b8be;
  font-style: italic;
}
.entry-content blockquote p {
  margin: 0.5rem 0;
}
.entry-content blockquote blockquote {
  border-left: none;
}
.entry-content .table-wrapper {
  margin: 3rem 0.8rem;
}
.entry-content table {
  border-collapse: collapse;
  border-spacing: 0;
  overflow: auto;
  display: block;
  font-size: 0.85rem;
  margin: 0 auto;
  width: auto;
}
.entry-content td,
.entry-content th {
  line-height: 1.8em;
  padding: 0.8rem 0.8rem;
  font-size: 0.85rem;
}
.entry-content td em,
.entry-content th em,
.entry-content td strong,
.entry-content th strong,
.entry-content td a,
.entry-content th a {
  font-size: 0.85rem;
}
.entry-content td {
  border: 1px solid #c4c4c4;
}
.entry-content th {
  background-color: #ecf5f7;
  border: 1px solid #c4c4c4;
}
.entry-content .table-align-center {
  text-align: center;
}
.entry-content .table-align-right {
  text-align: right;
}
.entry-content ul,
.entry-content ol,
.entry-content dl {
  margin: 3rem 0 3rem 1.6rem;
  padding: 0;
  list-style: none;
  font-size: 1rem;
}
.entry-content ul li,
.entry-content ol li,
.entry-content dl li {
  line-height: 2rem;
  position: relative;
  padding: 0;
}
.entry-content ul li p,
.entry-content ol li p,
.entry-content dl li p {
  line-height: 2rem;
  margin: 0;
}
.entry-content ul li p:not(:first-child),
.entry-content ol li p:not(:first-child),
.entry-content dl li p:not(:first-child) {
  color: #57767c;
  margin: 0.5rem;
}
.entry-content ul li ul,
.entry-content ol li ul,
.entry-content dl li ul,
.entry-content ul li ol,
.entry-content ol li ol,
.entry-content dl li ol,
.entry-content ul li dl,
.entry-content ol li dl,
.entry-content dl li dl {
  margin: 1rem;
}
.entry-content ul li {
  margin: 0.4rem 0 0.4rem 0.8rem;
}
.entry-content ul li::after {
  position: absolute;
  display: block;
  content: '';
  top: 0.75rem;
  left: -1rem;
  width: 0.5rem;
  height: 0.5rem;
  background-color: #cce4e8;
  border-radius: 100%;
}
.entry-content ol {
  counter-reset: number;
}
.entry-content ol li {
  margin: 0.4rem 0 0.4rem 2rem;
}
.entry-content ol li p:first-child {
  display: inline-block;
  line-height: 1.6rem;
  height: 1.6rem;
}
.entry-content ol li:before {
  position: absolute;
  display: inline-block;
  float: left;
  margin: 0 0.2rem 0 0;
  padding: 0;
  counter-increment: number;
  content: counter(number);
  left: -2.2rem;
  top: 0.2rem;
  background-color: #98b8be;
  width: 1.6rem;
  height: 1.6rem;
  border-radius: 50%;
  color: #fff;
  text-align: center;
  font-weight: bold;
  font-size: 0.8rem;
  line-height: 1.6rem;
}
kbd {
  font-family: sans-serif;
  text-align: center;
  display: inline-block;
  color: #425a5e;
  -moz-osx-font-smoothing: grayscale;
  -webkit-border-radius: 3px;
  -webkit-box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-box-shadow: 0 0 10px #e2e2e2 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-font-smoothing: subpixel-antialiased;
  background: #fff;
  border-left: 1px solid #fff;
  border-radius: 3px;
  border-right: 1px solid #e6e6e6;
  border-top: 1px solid #fff;
  font-size: 0.85rem;
  line-height: 1rem;
  margin: 5px;
  padding: 6px 8px 3px;
  text-shadow: 0 1px 0 #fff;
  vertical-align: baseline;
  
}
img.responsive-img {
  height: auto;
  max-width: 100%;
}
video.responsive-video {
  height: auto;
  max-width: 100%;
}
amp-instagram,
amp-vimeo,
amp-video,
amp-youtube,
amp-twitter,
.soundcloud-wrapper,
.amp-img-wrapper,
.googleAdPost,
.ad-footer {
  margin: 3rem 0.8rem;
}
code,
figure.highlight .code,
pre {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: subpixel-antialiased;
}
code,
pre,
samp {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
}
p code {
  font-size: 1rem;
}
code,
pre {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  background-color: #ecf5f7;
  color: #007e96;
}
code {
  margin: 0 3px;
  padding: 0.4em;
}
samp {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
sub,
sup {
  font-size: 0.75rem;
  line-height: 0;
  position: relative;
}
sub {
  bottom: -0.2em;
}
sup {
  top: -0.5em;
}
pre {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  margin: 0 3px;
  padding: 15px;
  -webkit-background-clip: padding;
  -moz-background-clip: padding;
  background-clip: padding-box;
  border: 0;
  line-height: 1.3rem;
  overflow-x: auto;
}
pre .addition,
pre .css .tag,
pre .keyword,
pre .method,
pre .nginx .title,
pre .request,
pre .status,
pre .winutils {
  color: #66d9ef;
}
pre .attr_selector,
pre .cdata,
pre .clojure .title,
pre .diff .change,
pre .important {
  color: #9882eb;
}
pre .preprocessor {
  color: #9882eb;
}
pre .preprocessor .keyword {
  color: #9882eb;
}
pre .shebang,
pre .special,
pre .subst {
  color: #9882eb;
}
pre .symbol {
  color: #9882eb;
}
pre .symbol .string {
  color: #9882eb;
}
pre .attribute,
pre .class .title,
pre .constant,
pre .haskell .type,
pre .lisp .body,
pre .parent,
pre .smalltalk .number,
pre .variable {
  color: #a6e22e;
}
pre .built_in,
pre .chunk,
pre .decorator,
pre .id,
pre .identifier,
pre .literal,
pre .localvars,
pre .title,
pre .vhdl,
pre .deletion {
  color: #f92672;
}
pre .command,
pre .hexcolor,
pre .number,
pre .phpdoc,
pre .regexp,
pre .string,
pre .tag .value,
pre .tex .formula {
  color: #e6db74;
}
pre .comment,
pre .diff .header,
pre .doctype,
pre .javadoc,
pre .lisp .string,
pre .pi,
pre .template_comment {
  color: #75715e;
  font-weight: normal;
}
.line {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  color: #f8f8f2;
}
.line span {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
.gist {
  background: #fff;
  border: 1px solid color-gutter;
  color: #f8f8f2;
  line-height: 1.6rem;
  margin-top: 15px;
  overflow: auto;
  padding: 7px 15px;
}
.gist .gist-file {
  border: none;
  font-family: inherit;
  font-size: 1rem;
  letter-spacing: 0;
  margin: 0;
}
.gist .gist-file .gist-data {
  background: 0 0;
  border-bottom: none;
}
.gist .gist-file .gist-data pre {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
  padding: 0 ;
}
.gist .gist-file .gist-meta {
  background: 0 0;
  color: #f8f8f2;
  font-size: 1rem;
  margin-top: 5px;
  padding: 0;
}
.gist .gist-file .gist-meta a {
  color: #f8f8f2;
}
.gist .gist-file .gist-meta a:visited {
  color: #f8f8f2;
}
figure.highlight {
  font-size: 0.95rem;
  margin: 3rem 0.8rem;
  background: #263338;
  border: 1px solid color-gutter;
  line-height: 2rem;
  overflow: auto;
  position: relative;
}
figure.highlight .code {
  padding: 0 1em 1em 1em;
  color: #f8f8f2;
}
figure.highlight .gutter {
  display: none;
}
figure.highlight figcaption {
  font-size: 1rem;
  font-weight: bold;
  color: #e9e9d6;
  background-color: #1e282c;
  padding: 0.6em 1em;
}
figure.highlight figcaption a {
  position: absolute;
  right: 1rem;
}
figure.highlight figcaption:before {
  content: "\f121";
  font-family: "fontawesome";
  text-align: center;
  display: inline-block;
  margin-right: 0.6em;
}
figure.highlight pre {
  background: 0 0;
  border: none;
  margin: 0;
  padding: 0.5rem;
}
figure.highlight table {
  border-spacing: 0;
  margin: 0;
}
figure.highlight th {
  border: 0;
  font-weight: 400;
  padding: 0;
}
figure.highlight td {
  border: 0;
  font-size: 1.1rem;
  padding: 0;
}
.entry-content .toc {
  background: #fff;
  padding: 0.5rem;
  margin: 3rem 0;
  border: 1px solid #cce4e8;
  border-radius: 2px;
}
.entry-content .toc ul {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
  border-radius: 2px;
}
.entry-content .toc ul:first-child {
  border-top: none;
}
.entry-content .toc ul ul,
.entry-content .toc ul ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li {
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
}
.entry-content .toc ul li:first-child {
  border-top: none;
}
.entry-content .toc ul li::after,
.entry-content .toc ul li::before {
  content: normal;
}
.entry-content .toc ul li a {
  font-size: 1.2rem;
  font-weight: bold;
  display: block;
  padding: 1rem;
  background-color: #3d5b61;
  color: #fff;
  -webkit-transition: 0.3s;
  -ms-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -webkit-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -ms-transition: 0.3s;
  transition: 0.3s;
}
.entry-content .toc ul li a:hover {
  color: #fff;
  background-color: #2c4145;
}
.entry-content .toc ul li a:before {
  content: "\f02d";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.8rem;
}
.entry-content .toc ul li ul,
.entry-content .toc ul li ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li ul li a,
.entry-content .toc ul li ol li a {
  padding: 0.5rem 0.75rem 0.5rem 2rem;
  font-size: 0.9rem;
  background-color: #416167;
}
.entry-content .toc ul li ul li a:before,
.entry-content .toc ul li ol li a:before {
  content: "\f0da";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.6rem;
}
.entry-content .toc ul li ul li ul li a,
.entry-content .toc ul li ol li ul li a {
  padding: 0.5rem 0.75rem 0.5rem 4rem;
}
.entry-content .toc ul li ul li ul li a:before,
.entry-content .toc ul li ol li ul li a:before {
  content: none;
}
.meta-content {
  background-color: #fff;
  margin: 1.5rem 0.8rem;
  padding: 0;
  border-top: 1px dotted #cce4e8;
  letter-spacing: 0.05rem;
}
.meta-wrapper {
  margin: 3rem 0.8rem;
  padding: 0;
  background-color: #fff;
}
h6.tag,
h6.categories {
  color: #2d3d40;
  font-size: 0.9rem;
  font-weight: bold;
}
.article-tag-list {
  padding: 0;
}
.article-tag,
.article-tag-list,
.article-categories,
.article-categories-list {
  padding: 0;
  margin: 0;
}
.article-categories {
  margin-bottom: 1.6em;
}
.article-tag-list li,
.article-categories-list li {
  list-style: none;
  display: inline-block;
  padding: 0;
  margin: 0.2rem 0.1rem;
}
.article-tag-list li a,
.article-categories-list li a {
  font-size: 0.8rem;
  font-weight: bold;
  padding: 0.4rem 0.8rem;
  margin: 0;
  background-color: #ecf5f7;
  color: #2d3d40;
  border-radius: 2px;
  display: block;
}
.article-tag-list li a:before,
.article-categories-list li a:before {
  content: "#";
}
.article-tag-list li a:hover,
.article-categories-list li a:hover {
  color: #fff;
  background-color: #2d3d40;
}
.widget {
  margin: 1.5rem 0.8rem;
  padding: 0;
}
.widget-h {
  text-align: center;
  margin: 1.6rem 0;
}
.widget-h h6 {
  color: #fff;
  background-color: #2d3d40;
  display: inline-block;
  padding: 0.4rem 1rem;
  font-size: 0.9rem;
  font-weight: bold;
}
.posts-list li {
  list-style: none;
  margin: 0.8rem 0;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.posts-list li .posts-list-link {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.posts-list li .posts-list-link a {
  color: #2d3d40;
  font-size: 1.1rem;
  font-weight: bold;
}
.posts-list li .posts-list-link a:hover {
  color: #e91e63;
}
.posts-list li .posts-list-meta {
  font-size: 0.7rem;
}
.posts-list li .flx:first-child {
  margin: 0 1rem 0 0;
}
.posts-list li amp-img {
  border-radius: 2px;
}
#footer {
  background-color: #2d3d40;
  color: #fff;
  display: block;
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  margin: 3rem 0 0 0;
  padding: 0;
}
.site-author-info {
  margin: 0;
  padding: 3rem 1.6rem;
}
.site-author-info h6 {
  font-size: 1rem;
  color: #fff;
  font-weight: bold;
  display: inline-block;
  background-color: #222f31;
  padding: 0.4rem 0.8rem;
}
.site-author-info-wrapper {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.site-author-info-wrapper .flx:first-child {
  margin: 0 1rem 0 0;
}
.authorCap-wrapper {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.authorCap {
  font-size: 1.4rem;
  font-weight: bold;
}
.authorReading {
  font-size: 0.7rem;
}
.site-author-desc {
  font-size: 0.8rem;
  line-height: 1.6rem;
  margin: 1.4rem 0;
}
.copyright-tool {
  margin: 0;
  padding: 1.5rem 1.6rem;
  border-top: 1px solid #384b4f;
}
.copyright-notice p {
  font-size: 0.6rem;
  letter-spacing: 0.05rem;
  line-height: 1.2rem;
  color: #8ba8ae;
}
.copyright-title {
  font-size: 1rem;
  text-align: center;
  margin: 0.8rem 0 0.4rem 0;
}
.copyright-license {
  margin: 0.4rem 0 0.8rem 0;
  font-size: 0.7rem;
  text-align: center;
}
.copyright-license a {
  color: #e6e6e6;
  font-size: 0.7rem;
}
.copyright-license a:hover {
  color: #b3b3b3;
}
.sns-link {
  margin: 0;
  text-align: center;
}
.sns-link a {
  display: inline-block;
  font-size: 1.6rem;
  text-align: center;
  width: 2rem;
  height: 2rem;
  line-height: 2rem;
  padding: 0.6rem;
  margin: 0 0.1rem;
  background-color: #222f31;
  color: #fff;
  border-radius: 4px;
}
.sns-link a:hover {
  color: #ccc;
  background-color: #030404;
}
.footer-menu {
  padding: 1.5rem 0.8rem;
  border-top: 1px solid #384b4f;
}
.footer-menu ul li {
  list-style: none;
  margin: 0;
  padding: 0;
}
.footer-menu ul li a {
  display: block;
  padding: 0.6rem;
  margin: 0.2rem 1.6rem;
  font-size: 1rem;
  color: #fff;
  background-color: #222f31;
  border-radius: 4px;
  text-align: center;
  font-weight: bold;
}
.footer-menu ul li a:hover {
  color: #ccc;
  background-color: #030404;
}
.social-share {
  margin: 1.5rem 0.8rem;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.social-share amp-social-share,
.social-share .sbtn {
  margin: 5px;
}
.sbtn {
  padding: 0;
  width: 4rem;
  height: 3rem;
  line-height: 3rem;
  color: #fff;
  font-size: 1.2rem;
  text-align: center;
  border-radius: 4px;
}
.sbtn:hover {
  color: #fff;
}
.tw {
  background-color: #1cafe8;
}
.tw:hover {
  background-color: #0f6b8f;
}
.fb {
  background-color: #4f677f;
}
.fb:hover {
  background-color: #283440;
}
.ht {
  background-color: #35acda;
}
.ht:hover {
  background-color: #1a6e8f;
}
.gp {
  background-color: #d56153;
}
.gp:hover {
  background-color: #9c3326;
}
.tb {
  background-color: #465f79;
}
.tb:hover {
  background-color: #212c38;
}
.icon-hatena:before {
  content: "B";
  font-weight: bold;
  font-size: 1.2rem;
}
#totop {
  position: fixed;
  bottom: 2rem;
  right: 1.6rem;
  font-size: 1.2rem;
  z-index: 995;
}
#totop a {
  background: rgba(152,184,190,0.6);
  text-decoration: none;
  color: #fff;
  padding: 0.8rem;
  border-radius: 50%;
}
#totop a:before {
  content: "\f062";
  font-family: "fontawesome";
  font-size: 1.2rem;
}
#totop a:hover {
  text-decoration: none;
  background: #5d8b93;
  color: #fff;
  line-height: 2.3em;
}
@media (min-width: 800px) {
  .title-cover,
  .entry-content,
  .categories,
  .meta-content,
  .site-author-info {
    width: 780px;
    margin: 0 auto;
  }
  .nav-container {
    width: 800px;
    margin: 0 auto;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  .site-author-info-wrapper {
    display: block;
  }
  .gravatar-area {
    text-align: center;
  }
  .gravatar-area amp-img {
    display: inline-block;
  }
  .entry-content td,
  .entry-content th {
    line-height: 1.8em;
    padding: 0.6rem 0.6rem;
    font-size: 0.5rem;
  }
  .entry-content td em,
  .entry-content th em,
  .entry-content td strong,
  .entry-content th strong,
  .entry-content td a,
  .entry-content th a {
    font-size: 0.5rem;
  }
}

	</style>
	
  </head>
  <body>
  	
  	
  	<!-- google analytics -->
  	
  	
  	
  	<!-- menu -->
  	<header>
  		<div class="nav-container">
	  		<div class="left-nav">
	  			<div class="header-title">
	  				<a href="/">CK&#39;s Notepad</a>
	  			</div>
	  		</div>
	  		
	  	</div>
    </header>
  	
  	
  	<!-- sidebar -->
  	
  	
  	<!-- container -->
  	<div id="container">
	  	<div id="main">
		    <article id="post-angular-with-o365-1" class="post">
		    
		   		<!-- categories and bread crumb -->
		    	
				<div class="categories-header">
					<div class="categories">
						<div class="breadcrumb inline-icon">
							<ol itemscope itemtype="http://schema.org/BreadcrumbList">
							  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
							    <a itemprop="item" href="/">
							    	<span class="sns-icon home-icon"></span>
							        <span itemprop="name"><span class="fa fa-fw fa-home"></span></span>
							    </a>
							    <meta itemprop="position" content="1" />
							  </li>

								
						    		<li itemprop="itemListElement" itemscope
									      itemtype="http://schema.org/ListItem">
									    <a itemprop="item" href="/categories/Angular/">
									      
									      	<span class="sns-icon folder-icon"></span>
									      
									      <span itemprop="name">Angular</span>
									    </a>
									    <meta itemprop="position" content="2" />
									</li>
								
						    		<li itemprop="itemListElement" itemscope
									      itemtype="http://schema.org/ListItem">
									    <a itemprop="item" href="/categories/O365/">
									      
									      <span itemprop="name">O365</span>
									    </a>
									    <meta itemprop="position" content="3" />
									</li>
								
							</ol>
						</div>
					</div>
				</div>
				
		    
		    	<!-- entry title -->
				<div class="title-cover">
					<div class="entry-header">
						
						
						
			          	<div class="header-thumb flx">
			          		<div class="thumbImg-w circle">
			          			<amp-img class="thumbImg" layout="fixed" width="128" height="100" src="/amp-dist/sample/sample-substituteTitleImage.png">
			          			</amp-img>
			          		</div>
			          	</div>
			            
			            
			            <div class="header-cap flx">
							
							  <h1 class="article-title entry-title" itemprop="name">
							    <a href="http://blog.kevinyang.net/2018/10/20/angular-with-o365-1/" target="_blank" itemprop="url">[Angular] 與 O365 跳舞系列 - 登入</a>
							  </h1>
							
						</div>
					</div>
					
					<!-- datePublished -->
					<div class="entry-meta-header">
						<span class="meta-elements date">
							<span class="fa fa-fw fa-clock-o"></span>
							<time datetime="2018-10-20" itemprop="datePublished">2018.10.20</time>
						</span>
					</div>
				</div>
				
				
				
				<!-- entry content -->
			    <div class="entry-content ecp">
			    	<!-- social share button -->
			    	
			    	
			    	
                    <!-- google Adsense Matched content -->
                    
                    
			    	<!-- content -->
			  		<p>&#x8EAB;&#x70BA;&#x5FAE;&#x8EDF; MVP&#xFF0C;&#x6C92;&#x5C07; Angular &#x8207; O365 &#x505A;&#x6574;&#x5408;&#xFF0C;&#x597D;&#x50CF;&#x8AAA;&#x4E0D;&#x904E;&#x53BB;&#x3002;Microsoft O365 &#x7CFB;&#x5217;&#xFF0C;&#x5176;&#x751F;&#x614B;&#x7CFB;&#x5176;&#x5BE6;&#x7B97;&#x662F;&#x5F88;&#x5B8C;&#x6574;&#x4E86;&#xFF0C;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x76F8;&#x7576;&#x4E0D;&#x932F;&#x7684; API &#x4F9B;&#x958B;&#x767C;&#x8005;&#x505A;&#x5EF6;&#x4F38;&#x61C9;&#x7528;&#x3002;&#x57FA;&#x65BC;&#x9019;&#x500B;&#x7406;&#x7531;&#xFF0C;&#x6211;&#x4E5F;&#x6C7A;&#x5B9A;&#x8981;&#x4F86;&#x73A9;&#x770B;&#x770B; O365 &#x4E86;&#x3002;&#x4F46;&#x5728;&#x958B;&#x59CB;&#x4E4B;&#x524D;&#xFF0C;&#x8981;&#x5148;&#x641E;&#x5B9A;&#x767B;&#x5165; MS &#x5E33;&#x865F;&#x4E26;&#x53D6;&#x5F97;&#x901A;&#x884C; Token&#x3002;&#x6240;&#x4EE5;&#x9019;&#x7BC7;&#x7B46;&#x8A18;&#x5C31;&#x662F;&#x8A18;&#x9304;&#x5982;&#x4F55;&#x767B;&#x5165;&#x4E26;&#x53D6;&#x5F97; Token.</p>
<a id="more"></a>
<h1 id="&#x74B0;&#x5883;&#x6E96;&#x5099;"><a class="header-anchor" href="#&#x74B0;&#x5883;&#x6E96;&#x5099;"> </a>&#x74B0;&#x5883;&#x6E96;&#x5099;</h1>
<p>&#x5728;&#x958B;&#x767C;&#x4E4B;&#x524D;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x5230;&#x5FAE;&#x8EDF;&#x7684; <a href="https://apps.dev.microsoft.com/" target="_blank" rel="noopener">Application Registration Portal</a> &#x65B0;&#x589E;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x4E26;&#x53D6;&#x5F97;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8B58;&#x5225;&#x78BC;&#x3002;&#x64CD;&#x4F5C;&#x6B65;&#x9A5F;&#x5982;&#x4E0B;</p>
<p>(2019/7/26) &#x76EE;&#x524D;&#x8A3B;&#x518A;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;</p>
<ol>
<li>
<p>&#x767B;&#x5165; Azure portal</p>
</li>
<li>
<p>&#x524D;&#x5F80; Azure Active Directory</p>
<div class="amp-img-wrapper"><amp-img src="/2018/10/20/angular-with-o365-1/SNAGHTML4f488482.PNG" width="248" height="740" layout="responsive"></amp-img></div>
<ol start="3">
<li>
<p>&#x9EDE;&#x9078;&#x3010;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8A3B;&#x518A;&#x3011;</p>
<div class="amp-img-wrapper"><amp-img src="/2018/10/20/angular-with-o365-1/1564108231023.png" width="254" height="469" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x4F9D;&#x81EA;&#x5DF1;&#x7684;&#x9700;&#x6C42;&#x9078;&#x64C7;&#x8A3B;&#x518A;&#x4F4D;&#x7F6E;</p>
<div class="amp-img-wrapper"><amp-img src="/2018/10/20/angular-with-o365-1/1564108300903.png" width="572" height="205" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x8A3B;&#x518A;&#x8981;&#x65B0;&#x589E;&#x7684;&#x5167;&#x5BB9;&#x8207;&#x820A;&#x6709;&#x7684;&#x8A3B;&#x518A;&#x6D41;&#x7A0B;&#x985E;&#x4F3C;&#xFF0C;&#x53EF;&#x4EE5;&#x53C3;&#x95B1;&#x4E0B;&#x9762;&#x7684;&#x586B;&#x5BEB;&#x5167;&#x5BB9;</p>
</li>
</ol>
</li>
</ol>
<p>(&#x4EE5;&#x4E0B;&#x6B65;&#x9A5F;&#x5931;&#x6548;)</p>
<ol>
<li>
<p>&#x767B;&#x5165; MS &#x5E33;&#x865F;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/sw5KaeL.png" width="539" height="446" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x6309; &#x3010;&#x65B0;&#x589E;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x3011;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/U9SE5dj.png" width="1473" height="151" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x8F38;&#x5165;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x540D;&#x7A31;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/wC6LQvY.png" width="667" height="441" layout="responsive"></amp-img></div>
<ol start="4">
<li>
<p>&#x65B0;&#x589E;&#x3010;&#x5E73;&#x53F0;&#x3011;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/YnaO3DX.png" width="533" height="445" layout="responsive"></amp-img></div>
<ol start="5">
<li>
<p>&#x9078;&#x64C7; <strong>Web</strong></p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/JtsayFx.png" width="804" height="397" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x8A2D;&#x5B9A;&#x3010;&#x91CD;&#x65B0;&#x5C0E;&#x5411; URL&#x3011;&#xFF0C;&#x9019;&#x88E1;&#x5FC5;&#x9808;&#x8A2D;&#x5B9A;&#x6B63;&#x78BA;&#xFF0C;&#x4E0D;&#x7136;&#x6703;&#x51FA;&#x73FE;&#x7121;&#x6CD5;&#x64CD;&#x4F5C;&#x7684;&#x932F;&#x8AA4;&#x756B;&#x9762;&#x3002;&#x56E0;&#x70BA;&#x6211;&#x5011;&#x6703;&#x4F7F;&#x7528; Angular &#x505A;&#x958B;&#x767C;&#xFF0C;&#x9810;&#x8A2D;&#x7684;&#x7DB2;&#x5740;&#x662F; <code>http://localhost:4200</code> &#x3002;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/K7dKP1E.png" width="1228" height="423" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x5C07;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8B58;&#x5225;&#x78BC;&#x5148;&#x8A18;&#x9304;&#x8D77;&#x4F86;&#xFF0C;&#x5F85;&#x6703;&#x6703;&#x7528;&#x5230;</p>
<div class="amp-img-wrapper"><amp-img src="https://i.imgur.com/tTs1Gp1.png" width="427" height="238" layout="responsive"></amp-img></div>
</li>
<li>
<p>&#x6700;&#x5F8C;&#xFF0C;&#x6309;&#x4E0B;&#x3010;&#x5132;&#x5B58;&#x3011;&#x5373;&#x5B8C;&#x6210;&#x7B2C;&#x4E00;&#x6B65;&#x7684;&#x8A2D;&#x5B9A;</p>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="angular-&#x90E8;&#x5206;"><a class="header-anchor" href="#angular-&#x90E8;&#x5206;"> </a>Angular &#x90E8;&#x5206;</h1>
<p>&#x5B8C;&#x6210;&#x4E86;&#x65B0;&#x589E;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x4E26;&#x53D6;&#x5F97;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8B58;&#x5225;&#x78BC;&#x5F8C;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x958B;&#x59CB;&#x4F86;&#x5BEB; Angular &#x7684;&#x90E8;&#x5206;&#x4E86;&#x3002;&#x9019;&#x6B21;&#x6703;&#x4F7F;&#x7528;&#x5230; <code>msal</code> &#x9019;&#x500B;&#x5957;&#x4EF6; (<a href="https://www.npmjs.com/package/msal" target="_blank" rel="noopener">npm&#x5957;&#x4EF6;&#x4F4D;&#x7F6E;</a>)</p>
<blockquote>
<p>The MSAL library preview for JavaScript is the core library which enables JavaScript web applications to authenticate enterprise users using Microsoft Azure Active Directory (AAD), Microsoft account users (MSA), users using social identity providers like Facebook, Google, LinkedIn etc. and get access to <a href="https://cloud.microsoft.com/" target="_blank" rel="noopener">Microsoft Cloud</a> OR <a href="https://graph.microsoft.io/" target="_blank" rel="noopener">Microsoft Graph</a>.</p>
</blockquote>
<h2 id="&#x57FA;&#x672C;&#x74B0;&#x5883;&#x8A2D;&#x5B9A;"><a class="header-anchor" href="#&#x57FA;&#x672C;&#x74B0;&#x5883;&#x8A2D;&#x5B9A;"> </a>&#x57FA;&#x672C;&#x74B0;&#x5883;&#x8A2D;&#x5B9A;</h2>
<ol>
<li>
<p>&#x5EFA;&#x7ACB; Angular &#x5C08;&#x6848;</p>
<p><code>ng new &lt;project name&gt;</code></p>
</li>
<li>
<p>&#x5B89;&#x88DD; <code>msal</code> &#x5957;&#x4EF6;</p>
<p><code>npm install msal</code></p>
</li>
<li>
<p>&#x65B0;&#x589E;&#x4E00;&#x500B; <code>service</code> &#xFF0C;&#x7B49;&#x4E00;&#x4E0B;&#x6703;&#x5C07;&#x767B;&#x5165;&#x7684;&#x76F8;&#x95DC;&#x908F;&#x8F2F;&#x5BEB;&#x5728;&#x9019;&#x500B; service &#x5167;&#xFF0C;&#x540D;&#x7A31;&#x81EA;&#x53D6;</p>
</li>
<li>
<p>&#x5728; <code>environment.ts</code> &#x5167;&#x65B0;&#x589E;&#x4E00;&#x500B; <code>APPLICATION_CONFIG</code> &#xFF0C;&#x5167;&#x653E;&#x8981;&#x7D66; msal &#x4F7F;&#x7528;&#x7684;&#x8A2D;&#x5B9A;&#x6A94;</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">APPLICATION_CONFIG: {</span><br><span class="line">   clientID: <span class="string">&apos;&#x653E;&#x525B;&#x525B;&#x8A18;&#x4E0B;&#x4F86;&#x7684;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8B58;&#x5225;&#x78BC;&apos;</span>,</span><br><span class="line">   redirectUri: <span class="string">&apos;http://localhost:4200/&apos;</span>,</span><br><span class="line">   interactionMode: <span class="string">&apos;popUp&apos;</span>,</span><br><span class="line">   graphEndpoint: <span class="string">&apos;https://graph.microsoft.com/v1.0/me&apos;</span>,</span><br><span class="line">   graphScopes: [<span class="string">&apos;user.read&apos;</span>]</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>clientID: &#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x8B58;&#x5225;&#x78BC;</li>
<li>graphScopes: &#x8A2D;&#x5B9A;&#x6B64;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x9700;&#x8981;&#x8207;&#x4F7F;&#x7528;&#x8005;&#x8ACB;&#x6C42;&#x7684;&#x6388;&#x6B0A;&#x7BC4;&#x570D;</li>
</ul>
</li>
</ol>
<h2 id="&#x4F7F;&#x7528;&#x8005;&#x767B;&#x5165;"><a class="header-anchor" href="#&#x4F7F;&#x7528;&#x8005;&#x767B;&#x5165;"> </a>&#x4F7F;&#x7528;&#x8005;&#x767B;&#x5165;</h2>
<h3 id="service"><a class="header-anchor" href="#service"> </a>service</h3>
<ol>
<li>
<p>&#x5EFA;&#x7ACB; <code>Msal.UserAgentApplication</code></p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { environment } <span class="keyword">from</span> <span class="string">&apos;../environments/environment&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Msal <span class="keyword">from</span> <span class="string">&apos;msal&apos;</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> GraphHelperService {</span><br><span class="line">  readonly APPLICATION_CONFIG = environment.APPLICATION_CONFIG;</span><br><span class="line">  <span class="keyword">private</span> clientApplication: Msal.UserAgentApplication;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> http: HttpClient</span>) {</span><br><span class="line">    <span class="keyword">this</span>.clientApplication = <span class="keyword">this</span>.createApplication();</span><br><span class="line">    <span class="keyword">this</span>.clientApplication.handleRedirectCallback(<span class="function">(<span class="params">error, response</span>) =&gt;</span> {</span><br><span class="line">      <span class="comment">// handle redirect response or error</span></span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> createApplication() {</span><br><span class="line">    <span class="keyword">const</span> msalConfig = {</span><br><span class="line">      auth: {</span><br><span class="line">        clientId: <span class="keyword">this</span>.APPLICATION_CONFIG.clientID</span><br><span class="line">      }</span><br><span class="line">    };</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Msal.UserAgentApplication(msalConfig);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li>
<p>&#x5EFA;&#x7ACB; <code>login()</code> &#x65B9;&#x6CD5;</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">login() {</span><br><span class="line">    <span class="keyword">const</span> acquireTokenSilent = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(</span><br><span class="line">        <span class="keyword">this</span>.clientApplication.acquireTokenSilent({</span><br><span class="line">            scopes: <span class="keyword">this</span>.APPLICATION_CONFIG.graphScopes</span><br><span class="line">        })</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> acquireTokenPopup = <span class="function"><span class="params">()</span> =&gt;</span></span><br><span class="line">      <span class="keyword">from</span>(</span><br><span class="line">        <span class="keyword">this</span>.clientApplication.acquireTokenPopup({</span><br><span class="line">            scopes: <span class="keyword">this</span>.APPLICATION_CONFIG.graphScopes</span><br><span class="line">        })</span><br><span class="line">      ).pipe(</span><br><span class="line">        catchError(<span class="function"><span class="params">error</span> =&gt;</span> {</span><br><span class="line">          <span class="built_in">window</span>.alert(<span class="string">&apos;Error acquiring the popup:\n&apos;</span> + error);</span><br><span class="line">          <span class="keyword">return</span> EMPTY;</span><br><span class="line">        })</span><br><span class="line">      );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span>(<span class="keyword">this</span>.clientApplication.loginPopup({scopes:<span class="keyword">this</span>.APPLICATION_CONFIG.graphScopes}))</span><br><span class="line">      .pipe(</span><br><span class="line">        mergeMap(<span class="function"><span class="params">token</span> =&gt;</span> {</span><br><span class="line">          <span class="keyword">return</span> acquireTokenSilent().pipe(</span><br><span class="line">            catchError(<span class="function"><span class="params">err</span> =&gt;</span> acquireTokenPopup())</span><br><span class="line">          );</span><br><span class="line">        })</span><br><span class="line">      )</span><br><span class="line">      .subscribe(</span><br><span class="line">        accessToken =&gt; {</span><br><span class="line">          localStorage.token = accessToken;</span><br><span class="line">          <span class="built_in">window</span>.location.reload();</span><br><span class="line">        },</span><br><span class="line">        error =&gt; {</span><br><span class="line">          <span class="built_in">window</span>.alert(<span class="string">&apos;Error during login:\n&apos;</span> + error);</span><br><span class="line">        }</span><br><span class="line">      );</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>loginPopup</code> &#x6703;&#x958B;&#x555F;&#x4E00;&#x500B;&#x9080;&#x60C5;&#x767B;&#x5165;&#x5FAE;&#x8EDF;&#x5E33;&#x865F;&#x7684;&#x756B;&#x9762;&#xFF0C;&#x8F38;&#x5165;&#x5B8C;&#x5E33;&#x865F;&#x5BC6;&#x78BC;&#x6642;&#xFF0C;&#x6703;&#x9032;&#x5165;&#x4E0B;&#x4E00;&#x500B;&#x6B65;&#x9A5F;</li>
<li><code>acquireTokenSilent</code> : &#x53D6;&#x5F97; <code>accessToken</code></li>
<li>&#x518D;&#x5C07;&#x53D6;&#x5230;&#x7684; <code>accessToken</code> &#x5B58;&#x5165;&#x5230; <code>localStorage</code> &#x5167;</li>
<li>&#x5C07;&#x6574;&#x500B;&#x756B;&#x9762;&#x91CD;&#x6574; (<strong>&#x9019;&#x500B;&#x52D5;&#x4F5C;&#x53EF;&#x4EE5;&#x66FF;&#x63DB;&#x6210;&#x66F4;&#x5408;&#x9069;&#x7684;&#x884C;&#x70BA;</strong>)</li>
</ul>
</li>
<li>
<p>&#x5EFA;&#x7ACB; <code>logout()</code> &#x65B9;&#x6CD5;&#xFF0C;&#x9019;&#x500B;&#x6BD4;&#x8F03;&#x7C21;&#x55AE;</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">logout() {</span><br><span class="line">  <span class="keyword">this</span>.clientApplication.logout();</span><br><span class="line">  <span class="keyword">delete</span> localStorage.token;</span><br><span class="line">  <span class="keyword">delete</span> localStorage.user;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>&#x76F4;&#x63A5;&#x547C;&#x53EB; logout() &#x65B9;&#x6CD5;</li>
<li>&#x522A;&#x9664;&#x5132;&#x5B58;&#x5728; <code>localStorage</code> &#x5167;&#x7684;&#x76F8;&#x95DC;&#x8CC7;&#x8A0A;</li>
</ul>
</li>
</ol>
<h3 id="component"><a class="header-anchor" href="#component"> </a>component</h3>
<p>&#x7576; Service &#x5EFA;&#x7ACB;&#x5B8C;&#x6210;&#x5F8C;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x5728; Component &#x7684;&#x5730;&#x65B9;&#x4F7F;&#x7528;&#x8A72; service &#x505A;&#x4F7F;&#x7528;&#x8005;&#x767B;&#x5165;&#x7684;&#x52D5;&#x4F5C;&#x4E86;</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent <span class="keyword">implements</span> OnInit {</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> graphHelper: GraphHelperService</span>) {}</span><br><span class="line">    </span><br><span class="line">  login() {</span><br><span class="line">    <span class="keyword">this</span>.graphHelper.login();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  logout() {</span><br><span class="line">    <span class="keyword">this</span>.graphHelper.logout();</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x53D6;&#x5F97;&#x4F7F;&#x7528;&#x8005;&#x8CC7;&#x8A0A;"><a class="header-anchor" href="#&#x53D6;&#x5F97;&#x4F7F;&#x7528;&#x8005;&#x8CC7;&#x8A0A;"> </a>&#x53D6;&#x5F97;&#x4F7F;&#x7528;&#x8005;&#x8CC7;&#x8A0A;</h2>
<p>&#x7576;&#x6210;&#x529F;&#x767B;&#x5165;&#x5F8C;&#xFF0C;&#x6211;&#x5011;&#x5C31;&#x53EF;&#x4EE5;&#x5229;&#x7528;&#x53D6;&#x5F97;&#x7684; <code>accessToken</code> &#x4F86;&#x4F7F;&#x7528; MS Graph&#xFF0C;&#x4EC0;&#x9EBC;&#x662F; MS Graph &#xFF1F;MS Graph &#x662F;&#x4E00;&#x500B;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Microsoft 365 &#x670D;&#x52D9;&#x7684; API&#xFF0C;&#x900F;&#x904E;&#x9019;&#x500B; API &#x53EF;&#x4EE5;&#x5B58;&#x53D6;&#x4F7F;&#x7528; O365 &#x7684;&#x670D;&#x52D9;&#x5167;&#x5BB9;&#xFF0C;&#x4F8B;&#x5982;&#x4FE1;&#x4EF6;&#x3001;&#x884C;&#x4E8B;&#x66C6;&#x3001;OneDrive &#x7B49;&#x3002;</p>
<p>&#x9019;&#x7BC7;&#x7B46;&#x8A18;&#xFF0C;&#x5148;&#x4F86;&#x505A;&#x500B;&#x57FA;&#x672C;&#x8CC7;&#x6599;&#x7684;&#x53D6;&#x5F97;&#xFF0C;&#x5982;&#x5E33;&#x865F;&#x7684;&#x986F;&#x793A;&#x540D;&#x7A31;&#x8DDF; Email</p>
<h3 id="service-v2"><a class="header-anchor" href="#service-v2"> </a>service</h3>
<p>&#x53EF;&#x4EE5;&#x900F;&#x904E;&#x547C;&#x53EB; <code>https://graph.microsoft.com/v1.0/me</code> &#x4F86;&#x53D6;&#x5F97;&#x767B;&#x5165;&#x5E33;&#x865F;&#x7684;&#x57FA;&#x672C;&#x8CC7;&#x8A0A;</p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">me() {</span><br><span class="line">    <span class="keyword">const</span> header = <span class="keyword">new</span> HttpHeaders().append(</span><br><span class="line">      <span class="string">&apos;Authorization&apos;</span>,</span><br><span class="line">      <span class="string">`Bearer <span class="subst"><!--figure5-->#123;localStorage.token}</span>`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.http.get(<span class="string">&apos;https://graph.microsoft.com/v1.0/me&apos;</span>, {</span><br><span class="line">      headers: header</span><br><span class="line">   });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="component-v2"><a class="header-anchor" href="#component-v2"> </a>component</h3>
<p>&#x547C;&#x53EB; service &#x7684; <code>me()</code></p>
<figure class="highlight typescript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.graphHelper.me().subscribe(<span class="function"><span class="params">user</span> =&gt;</span> {</span><br><span class="line">    localStorage.setItem(<span class="string">&apos;user&apos;</span>, <span class="built_in">JSON</span>.stringify(user));</span><br><span class="line">    <span class="keyword">this</span>.displayName = user.displayName;</span><br><span class="line">    <span class="keyword">this</span>.emailAddress = user.mail || user.userPrincipalName;</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5982;&#x679C;&#x60F3;&#x8981;&#x9032;&#x4E00;&#x6B65;&#x77E5;&#x9053;&#x53D6;&#x56DE;&#x4F86;&#x4F7F;&#x7528;&#x8005;&#x8CC7;&#x6599;&#x6709;&#x54EA;&#x4E9B;&#x9805;&#x76EE;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <code>console.log</code> &#x7684;&#x65B9;&#x6CD5;&#x89C0;&#x770B;</p>
<h1 id="recap"><a class="header-anchor" href="#recap"> </a>Recap</h1>
<p>&#x7576;&#x6B63;&#x5E38;&#x767B;&#x5165;&#x5F8C;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; Graph REST API &#x4E86;&#x3002;O365 &#x7684;&#x670D;&#x52D9;&#x7A2E;&#x985E;&#x5F88;&#x591A;&#xFF0C;&#x53EF;&#x4EE5;&#x900F;&#x904E;&#x5EF6;&#x4F38;&#x670D;&#x52D9;&#x5275;&#x9020;&#x51FA;&#x53E6;&#x5916;&#x4E00;&#x7A2E;&#x7684;&#x61C9;&#x7528;&#x7A0B;&#x5F0F;&#x3002;&#x4F46;&#x76F8;&#x95DC;&#x7684;&#x958B;&#x767C;&#x6587;&#x4EF6;&#x53C8;&#x4E0D;&#x591A;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x591A;&#x6B21;&#x649E;&#x7246;&#x5F8C;&#xFF0C;&#x9084;&#x662F;&#x89BA;&#x5F97;&#x5C07;&#x904E;&#x7A0B;&#x8A18;&#x9304;&#x8D77;&#x4F86;&#xFF0C;&#x65B9;&#x4FBF;&#x5176;&#x4ED6;&#x6709;&#x8208;&#x8DA3;&#x7684;&#x4EBA;&#x53EF;&#x4EE5;&#x5C11;&#x8D70;&#x4E00;&#x4E9B;&#x8DEF;&#x3002;</p>
<h1 id="&#x53C3;&#x8003;&#x8CC7;&#x6599;"><a class="header-anchor" href="#&#x53C3;&#x8003;&#x8CC7;&#x6599;"> </a>&#x53C3;&#x8003;&#x8CC7;&#x6599;</h1>
<ul>
<li><a href="https://www.npmjs.com/package/msal" target="_blank" rel="noopener">npm-msal</a></li>
<li><a href="https://developer.microsoft.com/en-us/graph/docs/concepts/v1-overview" target="_blank" rel="noopener">Graph REST API v1.0 reference</a></li>
<li><a href="https://developer.microsoft.com/en-us/graph/docs/api-reference/v1.0/resources/users" target="_blank" rel="noopener">Users API</a></li>
</ul>

			  		
			  		<!-- google Adsense -->
			  		
					
					
					
					
			    	
					
					<!-- google Adsense Matched content -->
			  		
			  	</div>
				
		  	</article>
		  	
		  	
		  	<!-- TAGS -->
		  	
		  	<div class="meta-content">
				
				<div class="widget">
				  	<h6 class="tag"><span class="fa fa-fw fa-tag"></span>TAGS</h6>
				  	<div class="article-tag">
						<ul class="article-tag-list">
							
					    		<li class="article-tag-list-item">
					    			<a class="article-tag-list-link" href="/tags/Angular/" class="link-gaTrack" data-linkType="link-tag">
					    				Angular
					    			</a>
					    		</li>
							
					    		<li class="article-tag-list-item">
					    			<a class="article-tag-list-link" href="/tags/O365/" class="link-gaTrack" data-linkType="link-tag">
					    				O365
					    			</a>
					    		</li>
							
						</ul>
					</div>
				</div>
				
			</div>
		  	
		  	
		  	<!-- Categories posts -->
		  	
		  	
		  	
		  	<!-- Detailed categories  posts -->
		  	
		  	
		  	
		  	<!-- Latests -->
		  	
			
		</div>
		
		
		<footer id="footer">
		
			
			
			
			
			<div class="copyright-tool">
				
				
				
				<div class="copyright-title">
					<span>
					&copy; 2021&nbsp;CK&#39;s Notepad
					</span>
				</div>
				
				<div class="copyright-license">
					<aside>
						Powered by <a href="https://hexo.io/">Hexo</a>. <a href="https://github.com/tea3/hexo-generator-amp">AMP-Theme</a> designed by <a href="https://photo-tea.com/">tea</a>.
					</aside>
				</div>
			</div>
			
		</footer>
		
		
	</div>
	
	
  	<div id="totop"><a href="#"></a></div>
  	
  	
  </body>
</html>